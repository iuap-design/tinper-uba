function implement(e){var t,n;for(t in e)n=e[t],Class.Mutators.hasOwnProperty(t)?Class.Mutators[t].call(this,n):this.prototype[t]=n}function classify(e){return e.extend=Class.extend,e.implement=implement,e}function Ctor(){}function mix(e,t,n){for(var i in t)if(t.hasOwnProperty(i)){if(n&&-1===indexOf(n,i))continue;"prototype"!==i&&(e[i]=t[i])}}function _findRegisteredClass(e,t){for(var n=0;n<CompMgr.registeredControls.length;n++)if(CompMgr.registeredControls[n].className===e)return"undefined"!=typeof t&&(CompMgr.registeredControls[n]=t),CompMgr.registeredControls[n];return!1}function _getUpgradedListOfElement(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function _isElementUpgraded(e,t){var n=_getUpgradedListOfElement(e);return-1!=n.indexOf(t)}function _upgradeElement(e,t){if(!("object"==typeof e&&e instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var n=_getUpgradedListOfElement(e),i=[];if(t)_isElementUpgraded(e,t)||i.push(_findRegisteredClass(t));else for(var r=e.className,a=0;a<CompMgr.registeredControls.length;a++){var s=CompMgr.registeredControls[a];r.indexOf(s.cssClass)>-1&&-1===i.indexOf(s)&&!_isElementUpgraded(e,s.className)&&i.push(s)}for(var o,a=0,u=i.length;u>a;a++){if(o=i[a],!o)throw new Error("Unable to find a registered component for the given class.");if(!e[o.className]){n.push(o.className),e.setAttribute("data-upgraded",n.join(","));var l=new o.classConstructor(e);CompMgr.createdControls.push(l);for(var d=0,c=o.callbacks.length;c>d;d++)o.callbacks[d](e);e[o.className]=l}}}function _upgradeDomInternal(e,t,n){if("undefined"==typeof e&&"undefined"==typeof t)for(var i=0;i<CompMgr.registeredControls.length;i++)_upgradeDomInternal(CompMgr.registeredControls[i].className,registeredControls[i].cssClass,n);else{var r=e;if(!t){var a=_findRegisteredClass(r);a&&(t=a.cssClass)}for(var s=n?n:document,o=s.querySelectorAll("."+t),u=0;u<o.length;u++)_upgradeElement(o[u],r)}}function BarrettMu_modulo(e){var t=RSAUtils,n=t.biDivideByRadixPower(e,this.k-1),i=t.biMultiply(n,this.mu),r=t.biDivideByRadixPower(i,this.k+1),a=t.biModuloByRadixPower(e,this.k+1),s=t.biMultiply(r,this.modulus),o=t.biModuloByRadixPower(s,this.k+1),u=t.biSubtract(a,o);u.isNeg&&(u=t.biAdd(u,this.bkplus1));for(var l=t.biCompare(u,this.modulus)>=0;l;)u=t.biSubtract(u,this.modulus),l=t.biCompare(u,this.modulus)>=0;return u}function BarrettMu_multiplyMod(e,t){var n=RSAUtils.biMultiply(e,t);return this.modulo(n)}function BarrettMu_powMod(e,t){var n=new BigInt;n.digits[0]=1;for(var i=e,r=t;;){if(0!=(1&r.digits[0])&&(n=this.multiplyMod(n,i)),r=RSAUtils.biShiftRight(r,1),0==r.digits[0]&&0==RSAUtils.biHighIndex(r))break;i=this.multiplyMod(i,i)}return n}function AbstractMasker(){}function AbstractSplitMasker(){}function AddressMasker(e){this.update(e)}function NumberMasker(e){this.update(e)}function CurrencyMasker(e){this.update(e)}function DateTimeMasker(e){this.update(e)}function DateMasker(e){this.update(e)}function TimeMasker(e){this.update(e)}function PercentMasker(){}function toColorfulString(e){var t;return e?null==e.color?e.value:(t=e.color,'<font color="'+t+'">'+e.value+"</font>"):""}function StringElement(e){this.value=e}function FormatResult(e,t){this.value=e,this.color=t}function NumberFormater(e){this.precision=e}function DateFormater(e){this.pattern=e}function _updateDom(e,t){for(var n in t){var i=t[n];for(var e in i){var r=i[e];if("trigger"==e)u.trigger(e,r[0]);else if(u.isArray(r))u.each(r,function(t,n){e[t](n)});else try{e[n](i)}catch(a){e[n](i[n])}}}}var U_LANGUAGES="i_languages",U_THEME="u_theme",U_LOCALE="u_locale",U_USERCODE="u_usercode",enumerables=!0,enumerablesTest={toString:1},toString=Object.prototype.toString;for(var i in enumerablesTest)enumerables=null;enumerables&&(enumerables=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),window.u=window.u||{};var u=window.u;if(u.enumerables=enumerables,u.extend=function(e,t){var n,i=arguments;if(i.length>1)for(var r=1;r<i.length;r++)if(n=i[r],e&&n&&"object"==typeof n){var a,s,o;for(a in n)e[a]=n[a];if(enumerables)for(s=enumerables.length;s--;)o=enumerables[s],n.hasOwnProperty(o)&&(e[o]=n[o])}return e},u.extend(u,{setCookie:function(e,t,n,i,r,a){var s=e+"="+encodeURIComponent(t);n&&(s+="; expires="+n.toGMTString()),i&&(s+="; path="+i),r&&(s+="; domain="+r),a&&(s+="; secure="+a),document.cookie=s},getCookie:function(e){var t="(?:; )?"+e+"=([^;]*);?",n=new RegExp(t);return n.test(document.cookie)?decodeURIComponent(RegExp.$1):null},createShellObject:function(e){var t=function(){};return t.prototype=e,new t},execIgnoreError:function(e,t,n){try{e.call(t,n)}catch(i){}},on:function(e,t,n,i){if(arguments.length<4)i=n,n=void 0;else var r=function(t){if(t){var r=e.querySelectorAll(n);r.forEach(function(e){e==t.target&&i.call(t.target,t)})}};e.uEvent||(e.uEvent={}),e.uEvent[t]?e.uEvent[t].push(n?r:i):(e.uEvent[t]=[n?r:i],e.uEvent[t+"fn"]=function(){var n=event?event:window.event;e.uEvent[t].forEach(function(t){t.call(e,n)})},e.addEventListener?e.addEventListener(t,e.uEvent[t+"fn"]):e.attachEvent?e.attachEvent("on"+t,e.uEvent[t+"fn"]):e["on"+t]=e.uEvent[t+"fn"])},off:function(e,t,n){var i=e.uEvent[t+"fn"];e.removeEventListener?e.removeEventListener(t,i):e.removeEvent?e.removeEvent("on"+t,i):delete e["on"+t],e.uEvent[t]=void 0,e.uEvent[t+"fn"]=void 0},trigger:function(e,t){e.uEvent&&e.uEvent[t]&&e.uEvent[t+"fn"]()},addClass:function(e,t){return"undefined"==typeof e.classList?u._addClass(e,t):e.classList.add(t),u},removeClass:function(e,t){return"undefined"==typeof e.classList?u._removeClass(e,t):e.classList.remove(t),u},hasClass:function(e,t){return"#text"===e.nodeName?!1:"undefined"==typeof e.classList?u._hasClass(e,t):e.classList.contains(t)},toggleClass:function(e,t){return"undefined"==typeof e.classList?u._toggleClass(e,t):e.classList.toggle(t)},css:function(e,t,n){if(t instanceof Object)for(var i in t){var r=t[i];["width","height","top","bottom","left","right"].indexOf(i)>-1&&u.isNumber(r)&&(r+="px"),e.style[i]=r}else arguments.length>2?e.style[t]=n:u.getStyle(e,t)},wrap:function(e,t){var n=u.makeDOM(t);e.parentNode.insertBefore(n,e),n.appendChild(e)},getStyle:function(e,t){var n;return n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,void 0!==n[t]?n[t]:""},getZIndex:function(){return u.globalZIndex||(u.globalZIndex=1e3),u.globalZIndex++},makeDOM:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.children[0];return n},stopEvent:function(e){"undefined"!=typeof e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},getFunction:function(e,t){if(!t||"function"==typeof t)return t;if("function"==typeof e[t])return e[t];if("function"==typeof window[t])return window[t];if(-1!=t.indexOf(".")){var n=u.getJSObject(e,t);if("function"==typeof n)return n;if(n=u.getJSObject(window,t),"function"==typeof n)return n}return t},getJSObject:function(e,t){if(t){if("object"==typeof t)return t;for(var n=t.split("."),i=e,r=0;r<n.length;r++)if(i=i[n[r]],!i)return null;return i}},isDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date},isNumber:function(e){return e===+e},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},inArray:function(e,t){if(!t instanceof Array)throw"arguments is not Array";for(var n=0,i=t.length;i>n;n++)if(e==t[n])return!0;return!1},each:function(e,t){if(e.forEach)e.forEach(function(e,n){t(n,e)});else{if(!(e instanceof Object))return;for(var n in e)t(n,e[n])}}}),function(){var e={},t={},n={},i={},r={"float":{precision:2},datetime:{format:"YYYY-MM-DD hh:mm:ss",metaType:"DateTimeFormatMeta",speratorSymbol:"-"},time:{format:"hh:mm:ss"},date:{format:"YYYY-MM-DD"},currency:{precision:2,curSymbol:"￥"},percent:{}};i.getEnvironment=function(){return u.createShellObject(e)},i.getClientAttributes=function(){return u.createShellObject(t)},i.setContextPath=function(t){return e[IWEB_CONTEXT_PATH]=t},i.getContextPath=function(t){return e[IWEB_CONTEXT_PATH]},i.setClientAttribute=function(e,n){t[e]=n},i.getSessionAttributes=function(){return u.createShellObject(n)},i.setSessionAttribute=function(e,t){n[e]=t,setCookie("ISES_"+e,t)},i.removeClientAttribute=function(e){t[e]=null,execIgnoreError(function(){delete t[e]})},i.getLanguages=function(){return this.getEnvironment().languages},i.collectEnvironment=function(){var e=this.getEnvironment(),n=this.getSessionAttributes();for(var i in t)n[i]=t[i];return e.clientAttributes=n,e},i.setMaskerMeta=function(e,t){if("function"==typeof e)getMetaFunc=e;else if(r[e])if("object"!=typeof t)r[e]=t;else for(var n in t)r[e][n]=t[n];else r[e]=t},i.getMaskerMeta=function(e){if("function"==typeof getMetaFunc){var t=getMetaFunc.call(this);return t[e]}return u.extend({},r[e])},e.languages=u.getCookie(U_LANGUAGES)?u.getCookie(U_LANGUAGES).split(","):navigator.language,e.theme=u.getCookie(U_THEME),e.locale=u.getCookie(U_LOCALE),e.usercode=u.getCookie(U_USERCODE),document.cookie.replace(/ISES_(\w*)=([^;]*);?/gi,function(e,t,i){n[t]=i});var a=function(){};a.prototype=i,u.core=new a}(),u.extend(u,{isIE:!1,isFF:!1,isOpera:!1,isChrome:!1,isSafari:!1,isWebkit:!1,isIE8_BEFORE:!1,isIE8:!1,isIE8_CORE:!1,isIE9:!1,isIE9_CORE:!1,isIE10:!1,isIE10_ABOVE:!1,isIE11:!1,isIOS:!1,isIphone:!1,isIPAD:!1,isStandard:!1,version:0}),function(){var e,t,n=navigator.userAgent,i=/(msie\s|trident.*rv:)([\w.]+)/,r=/(firefox)\/([\w.]+)/,a=/(opera).+version\/([\w.]+)/,s=/(chrome)\/([\w.]+)/,o=/version\/([\w.]+).*(safari)/,l=n.toLowerCase(),d=null,c=i.exec(l);if(null!=c&&(d={browser:"IE",version:c[2]||"0"}),c=r.exec(l),null!=c&&(d={browser:c[1]||"",version:c[2]||"0"}),c=a.exec(l),null!=c&&(d={browser:c[1]||"",version:c[2]||"0"}),c=s.exec(l),null!=c&&(d={browser:c[1]||"",version:c[2]||"0"}),c=o.exec(l),null!=c&&(d={browser:c[2]||"",version:c[1]||"0"}),null!=c&&(d={browser:"",version:"0"}),(t=l.match(/opera.([\d.]+)/))?u.isOpera=!0:"IE"==d.browser&&11==d.version?(u.isIE11=!0,u.isIE=!0):(t=l.match(/chrome\/([\d.]+)/))?(u.isChrome=!0,u.isStandard=!0):(t=l.match(/version\/([\d.]+).*safari/))?(u.isSafari=!0,u.isStandard=!0):(t=l.match(/gecko/))?(u.isFF=!0,u.isStandard=!0):(t=l.match(/msie ([\d.]+)/))?u.isIE=!0:(t=l.match(/firefox\/([\d.]+)/))&&(u.isFF=!0,u.isStandard=!0),l.match(/webkit\/([\d.]+)/)&&(u.isWebkit=!0),l.match(/ipad/i)&&(u.isIOS=!0,u.isIPAD=!0,u.isStandard=!0),l.match(/iphone/i)&&(u.isIOS=!0,u.isIphone=!0),u.version=e&&d.version?d.version:0,u.isIE){var f=parseInt(u.version),p=document.documentMode;null==p?(6==f||7==f)&&(u.isIE8_BEFORE=!0):(7==p?u.isIE8_BEFORE=!0:8==p?u.isIE8=!0:9==p?(u.isIE9=!0,u.isSTANDARD=!0):10==p?(u.isIE10=!0,u.isSTANDARD=!0,u.isIE10_ABOVE=!0):u.isSTANDARD=!0,8==f?u.isIE8_CORE=!0:9==f?u.isIE9_CORE=!0:11==d.version&&(u.isIE11=!0))}}(),u.isIE8_BEFORE)throw alert("uui 不支持IE8以前的浏览器版本，请更新IE浏览器或使用其它浏览器！"),new Error("uui 不支持IE8以前的浏览器版本，请更新IE浏览器或使用其它浏览器！");if(u.isIE8&&u.polyfill!==!0)throw alert("IE8浏览器中使用uui 必须在u.js之前引入u-polyfill.js!"),new Error("IE8浏览器中使用uui 必须在uui之前引入u-polyfill.js!");window.iweb={},window.iweb.Core=u.core,window.iweb.browser={isIE:u.isIE,isFF:u.isFF,isOpera:u.isOpera,isChrome:u.isChrome,isSafari:u.isSafari,isWebkit:u.isWebkit,isIE8_BEFORE:u.isIE8_BEFORE,isIE8:u.isIE8,isIE8_CORE:u.isIE8_CORE,isIE9:u.isIE9,isIE9_CORE:u.isIE9_CORE,isIE10:u.isIE10,isIE10_ABOVE:u.isIE10_ABOVE,isIE11:u.isIE11,isIOS:u.isIOS,isIphone:u.isIphone,isIPAD:u.isIPAD,isStandard:u.isStandard,version:0},NodeList.prototype.forEach=Array.prototype.forEach,String.prototype.lengthb=function(){var e=this.replace(/[^\x00-\xff]/g,"**");return e.length},String.prototype.replaceAll=function(e,t){var n=new RegExp(e,"g");return this.replace(n,t)};var XmlHttp={get:"get",post:"post",reqCount:4,createXhr:function(){var e=null;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},ajax:function(e){var t=e.url,n=e.success,i=void 0==e.async?!0:e.async,r=e.error,a=e.data,s=(void 0==e.type?XmlHttp.post:e.type).toLowerCase();t=XmlHttp.serializeUrl(t),a=XmlHttp.serializeParams(a),s==XmlHttp.get&&null!=a&&(t+="&"+a,a=null);var o=XmlHttp.createXhr();o.open(s,t,i),s==XmlHttp.post&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");var u=0;i?(o.onreadystatechange=function(){u++,u==XmlHttp.reqCount&&XmlHttp.execBack(o,n,r)},o.send(a)):(o.send(a),XmlHttp.execBack(o,n,r))},execBack:function(e,t,n){if(4!=e.readyState||200!=e.status&&304!=e.status)if(n)n(e.responseText,e.status,e);else{var i="no error callback function!";e.responseText&&(i=e.responseText),alert(i)}else t(e.responseText,e.status,e)},serializeUrl:function(e){var t="cache="+Math.random();return e+=e.indexOf("?")>0?"&"+t:"?"+t},serializeParams:function(e){var t=void 0;if(t==e||null==e||""==e)return null;if(e.constructor==Object){var n="";for(var i in e)n+=i+"="+e[i]+"&";return n.substring(0,n.length-1)}return e}};u.ajax=XmlHttp.ajax;var Class=function(e){return this instanceof Class||!isFunction(e)?void 0:classify(e)};Class.create=function(e,t){function n(){e.apply(this,arguments),this.constructor===n&&this.initialize&&this.initialize.apply(this,arguments)}return isFunction(e)||(t=e,e=null),t||(t={}),e||(e=t.Extends||Class),t.Extends=e,e!==Class&&mix(n,e,e.StaticsWhiteList),implement.call(n,t),classify(n)},Class.extend=function(e){return e||(e={}),e.Extends=this,Class.create(e)},Class.Mutators={Extends:function(e){var t=this.prototype,n=createProto(e.prototype);mix(n,t),n.constructor=this,this.prototype=n,this.superclass=e.prototype},Implements:function(e){isArray(e)||(e=[e]);for(var t,n=this.prototype;t=e.shift();)mix(n,t.prototype||t)},Statics:function(e){mix(this,e)}};var createProto=Object.__proto__?function(e){return{__proto__:e}}:function(e){return Ctor.prototype=e,new Ctor},toString=Object.prototype.toString,isArray=Array.isArray||function(e){return"[object Array]"===toString.call(e)},isFunction=function(e){return"[object Function]"===toString.call(e)},indexOf=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1};u.Class=Class;var CompMgr={plugs:{},dataAdapters:{},registeredControls:[],createdControls:[],apply:function(e){if(e)var t=e.el||document.body,n=e.model;"string"==typeof t&&(t=document.body.querySelector(t)),(null==t||"object"!=typeof t)&&(t=document.body);var i=t.querySelectorAll("[u-meta]");i.forEach(function(e){if(!e.comp){var t=JSON.parse(e.getAttribute("u-meta"));if(t&&t.type){var i=CompMgr.createDataAdapter({el:e,options:t,model:n});i&&(e.adpt=i)}}})},addPlug:function(e){var t=e.plug,n=e.name;if(this.plugs||(this.plugs={}),this.plugs[n])throw new Error("plug has exist:"+n);t.compType=n,this.plugs[n]=t},addDataAdapter:function(e){var t=e.adapter,n=e.name;if(this.dataAdapters||(dataAdapters={}),this.dataAdapters[n])throw new Error("dataAdapter has exist:"+n);this.dataAdapters[n]=t},getDataAdapter:function(e){return e?(this.dataAdapters||(dataAdapters={}),this.dataAdapters[e]):void 0},createDataAdapter:function(e){var t=e.options,n=t.type,i=this.dataAdapters[n];if(!i)return null;var r=new i(e);return r.type=n,r},_createComp:function(e){var t=e.options,n=t.type,i=this.plugs[n];if(!i)return null;var r=new i(e);return r.type=n,r},regComp:function(e){for(var t={classConstructor:e.comp,className:e.compAsString||e.compAsString,cssClass:e.css||e.css,callbacks:[]},n=0;n<this.registeredControls.length;n++){var i=this.registeredControls[n];if(i.cssClass===t.cssClass)throw new Error("The provided cssClass has already been registered: "+i.cssClass);if(i.className===t.className)throw new Error("The provided className has already been registered")}this.registeredControls.push(t)},updateComp:function(e){for(var t=0;t<this.registeredControls.length;t++)_upgradeDomInternal(this.registeredControls[t].className,null,e)}};if(u.compMgr=CompMgr,u.on(window,"load",function(){"use strict";u.compMgr.updateComp()}),window.i18n){var scriptPath=getCurrentJsPath(),_temp=scriptPath.substr(0,scriptPath.lastIndexOf("/")),__FOLDER__=_temp.substr(0,_temp.lastIndexOf("/"));u.uuii18n=u.extend({},window.i18n),u.uuii18n.init({postAsync:!1,getAsync:!1,fallbackLng:!1,ns:{namespaces:["uui-trans"]},resGetPath:__FOLDER__+"/locales/__lng__/__ns__.json"})}window.trans=u.trans=function(e,t){return u.uuii18n?u.uuii18n.t("uui-trans:"+e):t},"undefined"==typeof u.RSAUtils&&(u.RSAUtils={});var RSAUtils=u.RSAUtils,biRadixBase=2,biRadixBits=16,bitsPerDigit=biRadixBits,biRadix=65536,biHalfRadix=biRadix>>>1,biRadixSquared=biRadix*biRadix,maxDigitVal=biRadix-1,maxInteger=9999999999999998,maxDigits,ZERO_ARRAY,bigZero,bigOne,BigInt=u.BigInt=function(e){"boolean"==typeof e&&1==e?this.digits=null:this.digits=ZERO_ARRAY.slice(0),this.isNeg=!1};RSAUtils.setMaxDigits=function(e){maxDigits=e,ZERO_ARRAY=new Array(maxDigits);for(var t=0;t<ZERO_ARRAY.length;t++)ZERO_ARRAY[t]=0;bigZero=new BigInt,bigOne=new BigInt,bigOne.digits[0]=1},RSAUtils.setMaxDigits(20);var dpl10=15;RSAUtils.biFromNumber=function(e){var t=new BigInt;t.isNeg=0>e,e=Math.abs(e);for(var n=0;e>0;)t.digits[n++]=e&maxDigitVal,e=Math.floor(e/biRadix);return t};var lr10=RSAUtils.biFromNumber(1e15);RSAUtils.biFromDecimal=function(e){for(var t,n="-"==e.charAt(0),i=n?1:0;i<e.length&&"0"==e.charAt(i);)++i;if(i==e.length)t=new BigInt;else{var r=e.length-i,a=r%dpl10;for(0==a&&(a=dpl10),t=RSAUtils.biFromNumber(Number(e.substr(i,a))),i+=a;i<e.length;)t=RSAUtils.biAdd(RSAUtils.biMultiply(t,lr10),RSAUtils.biFromNumber(Number(e.substr(i,dpl10)))),i+=dpl10;t.isNeg=n}return t},RSAUtils.biCopy=function(e){var t=new BigInt(!0);return t.digits=e.digits.slice(0),t.isNeg=e.isNeg,t},RSAUtils.reverseStr=function(e){for(var t="",n=e.length-1;n>-1;--n)t+=e.charAt(n);return t};var hexatrigesimalToChar=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];RSAUtils.biToString=function(e,t){var n=new BigInt;n.digits[0]=t;for(var i=RSAUtils.biDivideModulo(e,n),r=hexatrigesimalToChar[i[1].digits[0]];1==RSAUtils.biCompare(i[0],bigZero);)i=RSAUtils.biDivideModulo(i[0],n),digit=i[1].digits[0],r+=hexatrigesimalToChar[i[1].digits[0]];return(e.isNeg?"-":"")+RSAUtils.reverseStr(r)},RSAUtils.biToDecimal=function(e){var t=new BigInt;t.digits[0]=10;for(var n=RSAUtils.biDivideModulo(e,t),i=String(n[1].digits[0]);1==RSAUtils.biCompare(n[0],bigZero);)n=RSAUtils.biDivideModulo(n[0],t),i+=String(n[1].digits[0]);return(e.isNeg?"-":"")+RSAUtils.reverseStr(i)};var hexToChar=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];RSAUtils.digitToHex=function(e){for(var t=15,n="",i=0;4>i;++i)n+=hexToChar[e&t],e>>>=4;return RSAUtils.reverseStr(n)},RSAUtils.biToHex=function(e){for(var t="",n=(RSAUtils.biHighIndex(e),RSAUtils.biHighIndex(e));n>-1;--n)t+=RSAUtils.digitToHex(e.digits[n]);return t},RSAUtils.charToHex=function(e){var t,n=48,i=n+9,r=97,a=r+25,s=65,o=90;return t=e>=n&&i>=e?e-n:e>=s&&o>=e?10+e-s:e>=r&&a>=e?10+e-r:0},RSAUtils.hexToDigit=function(e){for(var t=0,n=Math.min(e.length,4),i=0;n>i;++i)t<<=4,t|=RSAUtils.charToHex(e.charCodeAt(i));return t},RSAUtils.biFromHex=function(e){for(var t=new BigInt,n=e.length,i=n,r=0;i>0;i-=4,++r)t.digits[r]=RSAUtils.hexToDigit(e.substr(Math.max(i-4,0),Math.min(i,4)));return t},RSAUtils.biFromString=function(e,t){var n="-"==e.charAt(0),i=n?1:0,r=new BigInt,a=new BigInt;a.digits[0]=1;for(var s=e.length-1;s>=i;s--){var o=e.charCodeAt(s),u=RSAUtils.charToHex(o),l=RSAUtils.biMultiplyDigit(a,u);r=RSAUtils.biAdd(r,l),a=RSAUtils.biMultiplyDigit(a,t)}return r.isNeg=n,r},RSAUtils.biDump=function(e){return(e.isNeg?"-":"")+e.digits.join(" ")},RSAUtils.biAdd=function(e,t){var n;if(e.isNeg!=t.isNeg)t.isNeg=!t.isNeg,n=RSAUtils.biSubtract(e,t),t.isNeg=!t.isNeg;else{n=new BigInt;for(var i,r=0,a=0;a<e.digits.length;++a)i=e.digits[a]+t.digits[a]+r,n.digits[a]=i%biRadix,r=Number(i>=biRadix);n.isNeg=e.isNeg}return n},RSAUtils.biSubtract=function(e,t){var n;if(e.isNeg!=t.isNeg)t.isNeg=!t.isNeg,n=RSAUtils.biAdd(e,t),t.isNeg=!t.isNeg;else{n=new BigInt;var i,r;r=0;for(var a=0;a<e.digits.length;++a)i=e.digits[a]-t.digits[a]+r,n.digits[a]=i%biRadix,n.digits[a]<0&&(n.digits[a]+=biRadix),r=0-Number(0>i);if(-1==r){r=0;for(var a=0;a<e.digits.length;++a)i=0-n.digits[a]+r,n.digits[a]=i%biRadix,n.digits[a]<0&&(n.digits[a]+=biRadix),r=0-Number(0>i);n.isNeg=!e.isNeg}else n.isNeg=e.isNeg}return n},RSAUtils.biHighIndex=function(e){for(var t=e.digits.length-1;t>0&&0==e.digits[t];)--t;return t},RSAUtils.biNumBits=function(e){var t,n=RSAUtils.biHighIndex(e),i=e.digits[n],r=(n+1)*bitsPerDigit;for(t=r;t>r-bitsPerDigit&&0==(32768&i);--t)i<<=1;return t},RSAUtils.biMultiply=function(e,t){for(var n,i,r,a=new BigInt,s=RSAUtils.biHighIndex(e),o=RSAUtils.biHighIndex(t),u=0;o>=u;++u){n=0,r=u;for(var l=0;s>=l;++l,++r)i=a.digits[r]+e.digits[l]*t.digits[u]+n,a.digits[r]=i&maxDigitVal,n=i>>>biRadixBits;a.digits[u+s+1]=n}return a.isNeg=e.isNeg!=t.isNeg,a},RSAUtils.biMultiplyDigit=function(e,t){var n,i,r,a=new BigInt;n=RSAUtils.biHighIndex(e),i=0;for(var s=0;n>=s;++s)r=a.digits[s]+e.digits[s]*t+i,a.digits[s]=r&maxDigitVal,i=r>>>biRadixBits;return a.digits[1+n]=i,a},RSAUtils.arrayCopy=function(e,t,n,i,r){for(var a=Math.min(t+r,e.length),s=t,o=i;a>s;++s,++o)n[o]=e[s]};var highBitMasks=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];RSAUtils.biShiftLeft=function(e,t){var n=Math.floor(t/bitsPerDigit),i=new BigInt;RSAUtils.arrayCopy(e.digits,0,i.digits,n,i.digits.length-n);for(var r=t%bitsPerDigit,a=bitsPerDigit-r,s=i.digits.length-1,o=s-1;s>0;--s,--o)i.digits[s]=i.digits[s]<<r&maxDigitVal|(i.digits[o]&highBitMasks[r])>>>a;return i.digits[0]=i.digits[s]<<r&maxDigitVal,i.isNeg=e.isNeg,i};var lowBitMasks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];RSAUtils.biShiftRight=function(e,t){var n=Math.floor(t/bitsPerDigit),i=new BigInt;RSAUtils.arrayCopy(e.digits,n,i.digits,0,e.digits.length-n);for(var r=t%bitsPerDigit,a=bitsPerDigit-r,s=0,o=s+1;s<i.digits.length-1;++s,++o)i.digits[s]=i.digits[s]>>>r|(i.digits[o]&lowBitMasks[r])<<a;return i.digits[i.digits.length-1]>>>=r,i.isNeg=e.isNeg,i},RSAUtils.biMultiplyByRadixPower=function(e,t){var n=new BigInt;return RSAUtils.arrayCopy(e.digits,0,n.digits,t,n.digits.length-t),n},RSAUtils.biDivideByRadixPower=function(e,t){var n=new BigInt;return RSAUtils.arrayCopy(e.digits,t,n.digits,0,n.digits.length-t),n},RSAUtils.biModuloByRadixPower=function(e,t){var n=new BigInt;return RSAUtils.arrayCopy(e.digits,0,n.digits,0,t),n},RSAUtils.biCompare=function(e,t){if(e.isNeg!=t.isNeg)return 1-2*Number(e.isNeg);for(var n=e.digits.length-1;n>=0;--n)if(e.digits[n]!=t.digits[n])return e.isNeg?1-2*Number(e.digits[n]>t.digits[n]):1-2*Number(e.digits[n]<t.digits[n]);return 0},RSAUtils.biDivideModulo=function(e,t){var n,i,r=RSAUtils.biNumBits(e),a=RSAUtils.biNumBits(t),s=t.isNeg;if(a>r)return e.isNeg?(n=RSAUtils.biCopy(bigOne),n.isNeg=!t.isNeg,e.isNeg=!1,t.isNeg=!1,i=biSubtract(t,e),e.isNeg=!0,t.isNeg=s):(n=new BigInt,i=RSAUtils.biCopy(e)),[n,i];n=new BigInt,i=e;for(var o=Math.ceil(a/bitsPerDigit)-1,u=0;t.digits[o]<biHalfRadix;)t=RSAUtils.biShiftLeft(t,1),++u,++a,o=Math.ceil(a/bitsPerDigit)-1;i=RSAUtils.biShiftLeft(i,u),r+=u;for(var l=Math.ceil(r/bitsPerDigit)-1,d=RSAUtils.biMultiplyByRadixPower(t,l-o);-1!=RSAUtils.biCompare(i,d);)++n.digits[l-o],i=RSAUtils.biSubtract(i,d);for(var c=l;c>o;--c){var f=c>=i.digits.length?0:i.digits[c],p=c-1>=i.digits.length?0:i.digits[c-1],h=c-2>=i.digits.length?0:i.digits[c-2],m=o>=t.digits.length?0:t.digits[o],g=o-1>=t.digits.length?0:t.digits[o-1];f==m?n.digits[c-o-1]=maxDigitVal:n.digits[c-o-1]=Math.floor((f*biRadix+p)/m);for(var v=n.digits[c-o-1]*(m*biRadix+g),b=f*biRadixSquared+(p*biRadix+h);v>b;)--n.digits[c-o-1],v=n.digits[c-o-1]*(m*biRadix|g),b=f*biRadix*biRadix+(p*biRadix+h);d=RSAUtils.biMultiplyByRadixPower(t,c-o-1),i=RSAUtils.biSubtract(i,RSAUtils.biMultiplyDigit(d,n.digits[c-o-1])),i.isNeg&&(i=RSAUtils.biAdd(i,d),--n.digits[c-o-1])}return i=RSAUtils.biShiftRight(i,u),n.isNeg=e.isNeg!=s,e.isNeg&&(n=s?RSAUtils.biAdd(n,bigOne):RSAUtils.biSubtract(n,bigOne),t=RSAUtils.biShiftRight(t,u),i=RSAUtils.biSubtract(t,i)),0==i.digits[0]&&0==RSAUtils.biHighIndex(i)&&(i.isNeg=!1),[n,i]},RSAUtils.biDivide=function(e,t){return RSAUtils.biDivideModulo(e,t)[0]},RSAUtils.biModulo=function(e,t){return RSAUtils.biDivideModulo(e,t)[1]},RSAUtils.biMultiplyMod=function(e,t,n){return RSAUtils.biModulo(RSAUtils.biMultiply(e,t),n)},RSAUtils.biPow=function(e,t){for(var n=bigOne,i=e;;){if(0!=(1&t)&&(n=RSAUtils.biMultiply(n,i)),t>>=1,0==t)break;i=RSAUtils.biMultiply(i,i)}return n},RSAUtils.biPowMod=function(e,t,n){for(var i=bigOne,r=e,a=t;;){if(0!=(1&a.digits[0])&&(i=RSAUtils.biMultiplyMod(i,r,n)),a=RSAUtils.biShiftRight(a,1),0==a.digits[0]&&0==RSAUtils.biHighIndex(a))break;r=RSAUtils.biMultiplyMod(r,r,n)}return i},u.BarrettMu=function(e){this.modulus=RSAUtils.biCopy(e),this.k=RSAUtils.biHighIndex(this.modulus)+1;var t=new BigInt;t.digits[2*this.k]=1,this.mu=RSAUtils.biDivide(t,this.modulus),this.bkplus1=new BigInt,this.bkplus1.digits[this.k+1]=1,this.modulo=BarrettMu_modulo,this.multiplyMod=BarrettMu_multiplyMod,this.powMod=BarrettMu_powMod};var RSAKeyPair=function(e,t,n){var i=RSAUtils;this.e=i.biFromHex(e),this.d=i.biFromHex(t),this.m=i.biFromHex(n),this.chunkSize=2*i.biHighIndex(this.m),this.radix=16,this.barrett=new u.BarrettMu(this.m)};RSAUtils.getKeyPair=function(e,t,n){return new RSAKeyPair(e,t,n)},"undefined"==typeof u.twoDigit&&(u.twoDigit=function(e){return(10>e?"0":"")+String(e)}),RSAUtils._encryptedString=function(e,t){for(var n=[],i=t.length,r=0;i>r;)n[r]=t.charCodeAt(r),r++;for(;n.length%e.chunkSize!=0;)n[r++]=0;var a,s,o,u=n.length,l="";for(r=0;u>r;r+=e.chunkSize){for(o=new BigInt,a=0,s=r;s<r+e.chunkSize;++a,s++)o.digits[a]=n[s],o.digits[a]+=n[s]<<8;var d=e.barrett.powMod(o,e.e),c=16==e.radix?RSAUtils.biToHex(d):RSAUtils.biToString(d,e.radix);l+=c+" "}return l.substring(0,l.length-1)},RSAUtils._decryptedString=function(e,t){var n,i,r,a=t.split(" "),s="";for(n=0;n<a.length;++n){var o;for(o=16==e.radix?RSAUtils.biFromHex(a[n]):RSAUtils.biFromString(a[n],e.radix),r=e.barrett.powMod(o,e.d),i=0;i<=RSAUtils.biHighIndex(r);++i)s+=String.fromCharCode(255&r.digits[i],r.digits[i]>>8)}return 0==s.charCodeAt(s.length-1)&&(s=s.substring(0,s.length-1)),s},RSAUtils.setMaxDigits(130),RSAUtils.encryptedString=function(e){var t=e.text;if(e.exponent&&e.modulus){var n=RSAUtils.getKeyPair(e.exponent,"",e.modulus);t=RSAUtils._encryptedString(n,e.text)}return t},RSAUtils.decryptedString=function(e){var t=e.text;if(e.exponent&&e.modulus){var n=RSAUtils.getKeyPair("",e.exponent,e.modulus);t=RSAUtils._decryptedString(n,e.text)}return t},AbstractMasker.prototype.format=function(e){if(null==e)return null;var t=this.formatArgument(e);return this.innerFormat(t)},AbstractMasker.prototype.formatArgument=function(e){},AbstractMasker.prototype.innerFormat=function(e){},AbstractSplitMasker.prototype=new AbstractMasker,AbstractSplitMasker.prototype.elements=new Array,AbstractSplitMasker.prototype.format=function(e){if(null==e)return null;var t=this.formatArgument(e);return this.innerFormat(t)},AbstractSplitMasker.prototype.formatArgument=function(e){return e},AbstractSplitMasker.prototype.innerFormat=function(e){if(null==e||""==e)return new FormatResult(e);this.doSplit();var t="";return t=this.getElementsValue(this.elements,e),new FormatResult(t)},AbstractSplitMasker.prototype.getElementsValue=function(e,t){var n="";if(e instanceof Array)for(var i=0;i<e.length;i++)n+=this.getElementsValue(e[i],t);else e.getValue&&(n=e.getValue(t));return n},AbstractSplitMasker.prototype.getExpress=function(){},AbstractSplitMasker.prototype.doSplit=function(){var e=this.getExpress();(null==this.elements||0==this.elements.length)&&(this.elements=this.doQuotation(e,this.getSeperators(),this.getReplaceds(),0))},AbstractSplitMasker.prototype.doQuotation=function(e,t,n,i){if(0==e.length)return null;var r,a=new Array,s=new RegExp('".*?"',"g"),o=0;do if(r=s.exec(e),null!=r){var u=r.index,l=s.lastIndex;if(u!=l&&u>o){var d=this.doSeperator(e.substring(o,u),t,n,i);null!=d&&d.length>0&&a.push(d)}a.push(new StringElement(e.substring(u+1,l-1))),o=l}while(null!=r);if(o<e.length){var d=this.doSeperator(e.substring(o,e.length),t,n,i);null!=d&&d.length>0&&a.push(d)}return a},AbstractSplitMasker.prototype.doSeperator=function(e,t,n,i){if(i>=t.length){var r=new Array;return r.push(this.getVarElement(e)),r}if(0==e.length)return null;var a,s=0,r=new Array,o=new RegExp(t[i],"g");do if(a=o.exec(e),null!=a){var u=a.index,l=o.lastIndex;if(u!=l){if(u>s){var d=this.doSeperator(e.substring(s,u),t,n,i+1);null!=d&&d.length>0&&r.push(d)}null!=n[i]?r.push(new StringElement(n[i])):r.push(new StringElement(e.substring(u,l))),s=l}}while(null!=a);if(s<e.length){var d=this.doSeperator(e.substring(s,e.length),t,n,i+1);null!=d&&d.length>0&&r.push(d)}return r},AddressMasker.prototype=new AbstractSplitMasker,AddressMasker.prototype.update=function(e){this.formatMeta=u.extend({},AddressMasker.DefaultFormatMeta,e)},AddressMasker.prototype.getExpress=function(){return this.formatMeta.express},AddressMasker.prototype.getReplaceds=function(){return[this.formatMeta.separator]},AddressMasker.prototype.getSeperators=function(){return["(\\s)+?"]},AddressMasker.prototype.getVarElement=function(e){var t={};return"C"==e&&(t.getValue=function(e){return e.country}),"S"==e&&(t.getValue=function(e){return e.state}),"T"==e&&(t.getValue=function(e){return e.city}),"D"==e&&(t.getValue=function(e){return e.section}),"R"==e&&(t.getValue=function(e){return e.road}),"P"==e&&(t.getValue=function(e){return e.postcode}),void 0==typeof t.getValue?new StringElement(e):t},AddressMasker.prototype.formatArgument=function(e){return e},NumberMasker.prototype=new AbstractMasker,NumberMasker.prototype.formatMeta=null,NumberMasker.prototype.update=function(e){this.formatMeta=u.extend({},NumberMasker.DefaultFormatMeta,e)},NumberMasker.prototype.innerFormat=function(e){var t,n,i,r;t=e.value,t>0?(n=this.formatMeta.positiveFormat,r=t+""):0>t?(n=this.formatMeta.negativeFormat,r=(t+"").substr(1,(t+"").length-1)):(n=this.formatMeta.positiveFormat,r=t+""),i=r.indexOf("."),r=this.setTheSeperator(r,i),r=this.setTheMark(r,i);var a=null;return 0>t&&this.formatMeta.isNegRed&&(a="FF0000"),new FormatResult(n.replaceAll("n",r),a)},NumberMasker.prototype.setTheMark=function(e,t){var n,i,r;if(!this.formatMeta.isMarkEnable)return e;for(0>=t&&(t=e.length),i=e.charCodeAt(0),n=0,45==i&&(n=1),r=t-3;r>n;)e=e.substr(0,r-0)+this.formatMeta.markSymbol+e.substr(r,e.length-r),r-=3;return e},NumberMasker.prototype.setTheSeperator=function(e,t){var n;return t>0&&(n=NumberMasker.toCharArray(e),n[t]=this.formatMeta.pointSymbol,e=n.join("")),e},NumberMasker.toCharArray=function(e){for(var e=e.split(""),t=new Array,n=0;n<e.length;n++)t.push(e[n]);return t},NumberMasker.prototype.formatArgument=function(e){var t={};return t.value=e,t},CurrencyMasker.prototype=new NumberMasker,CurrencyMasker.prototype.formatMeta=null,CurrencyMasker.prototype.update=function(e){this.formatMeta=u.extend({},CurrencyMasker.DefaultFormatMeta,e)},CurrencyMasker.prototype.innerFormat=function(e){if(!e.value)return{value:""};var t=new NumberMasker(this.formatMeta).innerFormat(e);return t.value=this.formatMeta.curSymbol+t.value,t},DateTimeMasker.prototype=new AbstractSplitMasker,DateTimeMasker.prototype.formatMeta=null,DateTimeMasker.prototype.update=function(e){this.formatMeta=u.extend({},DateTimeMasker.DefaultFormatMeta,e)},DateTimeMasker.enShortMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DateTimeMasker.enLongMonth=["January","February","March","April","May","June","July","August","September","October","November","December"],DateTimeMasker.prototype.doOne=function(e){if(0==e.length)return"";var t=new Object;return"yyyy"==e.toLowerCase()&&(t.getValue=function(e){return DateTimeMasker.getyyyy(e);
}),"yy"==e.toLowerCase()&&(t.getValue=function(e){return DateTimeMasker.getyy(e)}),"MMMM"==e&&(t.getValue=function(e){return DateTimeMasker.getMMMM(e)}),"MMM"==e&&(t.getValue=function(e){return DateTimeMasker.getMMM(e)}),"MM"==e&&(t.getValue=function(e){return DateTimeMasker.getMM(e)}),"M"==e&&(t.getValue=function(e){return DateTimeMasker.getM(e)}),"dd"==e.toLowerCase()&&(t.getValue=function(e){return DateTimeMasker.getdd(e)}),"d"==e.toLowerCase()&&(t.getValue=function(e){return DateTimeMasker.getd(e)}),"hh"==e&&(t.getValue=function(e){return DateTimeMasker.gethh(e)}),"h"==e&&(t.getValue=function(e){return DateTimeMasker.geth(e)}),"mm"==e&&(t.getValue=function(e){return DateTimeMasker.getmm(e)}),"m"==e&&(t.getValue=function(e){return DateTimeMasker.getm(e)}),"ss"==e&&(t.getValue=function(e){return DateTimeMasker.getss(e)}),"s"==e&&(t.getValue=function(e){return DateTimeMasker.gets(e)}),"HH"==e&&(t.getValue=function(e){return DateTimeMasker.getHH(e)}),"H"==e&&(t.getValue=function(e){return DateTimeMasker.getH(e)}),"t"==e&&(t.getValue=function(e){return DateTimeMasker.gett(e)}),"st"==e&&(t.getValue=function(e){return DateTimeMasker.gets(e)+DateTimeMasker.gett(e)}),"mt"==e&&(t.getValue=function(e){return DateTimeMasker.getm(e)+DateTimeMasker.gett(e)}),"yyyyMMdd"==e&&(t.getValue=function(e){return DateTimeMasker.getyyyy(e)+DateTimeMasker.getMM(e)+DateTimeMasker.getdd(e)}),"undefined"==typeof t.getValue&&(t.getValue=function(e){return DateTimeMasker.getyyyy(e)+"-"+DateTimeMasker.getMM(e)+"-"+DateTimeMasker.getdd(e)}),t},DateTimeMasker.getyyyy=function(e){return e.getFullYear()},DateTimeMasker.getyy=function(e){return(""+e.getFullYear()).substring(2)},DateTimeMasker.getM=function(e){return""+(e.getMonth()+1)},DateTimeMasker.getMM=function(e){var t=e.getMonth()+1;return 10>t?"0"+t:t},DateTimeMasker.getMMM=function(e){return this.enShortMonth[e.getMonth()]},DateTimeMasker.getMMMM=function(e){return this.enLongMonth[e.getMonth()]},DateTimeMasker.getdd=function(e){var t=e.getDate();return 10>t?"0"+t:e.getDate()+""},DateTimeMasker.getd=function(e){return e.getDate()+""},DateTimeMasker.gethh=function(e){var t=e.getHours();return 10>t?"0"+t:e.getHours()+""},DateTimeMasker.geth=function(e){return e.getHours()+""},DateTimeMasker.getHH=function(e){var t=e.getHours();return t>=12&&(t-=12),10>t?"0"+t:t+""},DateTimeMasker.getH=function(e){var t=e.getHours();return t>=12&&(t-=12),t+""},DateTimeMasker.getmm=function(e){var t=e.getMinutes();return 10>t?"0"+t:e.getMinutes()+""},DateTimeMasker.getm=function(e){return""+e.getMinutes()},DateTimeMasker.getss=function(e){var t=e.getSeconds();return 10>t?"0"+t:t+""},DateTimeMasker.gets=function(e){return e.getSeconds()+""},DateTimeMasker.gett=function(e){var t=e.getHours();return 12>=t?"AM":"PM"},DateTimeMasker.prototype.getExpress=function(){return this.formatMeta.format},DateTimeMasker.prototype.getReplaceds=function(){return[" ",this.formatMeta.speratorSymbol,":"]},DateTimeMasker.prototype.getSeperators=function(){return["(\\s)+?","-",":"]},DateTimeMasker.prototype.getVarElement=function(e){return this.doOne(e)},DateTimeMasker.prototype.formatArgument=function(e){if(0==e)return"";if(null==e||""==e)return e;if("string"==typeof e){var t=e.split(" "),n=new Date;if(t.length>0)if(t[0].indexOf("-")>0){var i=t[0].split("-");if(n.setDate(1),n.setFullYear(parseInt(i[0],10)),n.setMonth(parseInt(i[1],10)-1),n.setDate(parseInt(i[2],10)),2==t.length&&void 0!=t[1]){var r=t[1].split(":");n.setHours(parseInt(r[0],10)),n.setMinutes(parseInt(r[1],10)),n.setSeconds(parseInt(r[2],10)),r.length>3&&n.setMilliseconds(parseInt(r[3],10))}}else{var r=t[0].split(":");n.setHours(parseInt(r[0],10)),n.setMinutes(parseInt(r[1],10)),n.setSeconds(parseInt(r[2],10)),r.length>3&&n.setMilliseconds(parseInt(r[3],10))}return n}return e},DateMasker.prototype=new DateTimeMasker,DateMasker.DefaultFormatMeta=u.extend({},DateTimeMasker.DefaultFormatMeta,{format:"yyyy-MM-dd"}),DateMasker.prototype.update=function(e){this.formatMeta=u.extend({},DateMasker.DefaultFormatMeta,e)},TimeMasker.prototype=new DateTimeMasker,TimeMasker.DefaultFormatMeta=u.extend({},DateTimeMasker.DefaultFormatMeta,{format:"hh:mm:ss"}),TimeMasker.prototype.update=function(e){this.formatMeta=u.extend({},TimeMasker.DefaultFormatMeta,e)},PercentMasker.prototype=new AbstractMasker,PercentMasker.prototype.formatArgument=function(e){return e},PercentMasker.prototype.innerFormat=function(e){var t="";if(""!=e){var n=String(e),i=n.length-n.indexOf(".")-1,r=i-2;0>r&&(r=0),t=100*parseFloat(e),t=(t*Math.pow(10,r)/Math.pow(10,r)).toFixed(r),t+="%"}return{value:t}},StringElement.prototype=new Object,StringElement.prototype.value="",StringElement.prototype.getValue=function(e){return this.value},FormatResult.prototype=new Object,NumberMasker.DefaultFormatMeta={isNegRed:!0,isMarkEnable:!0,markSymbol:",",pointSymbol:".",positiveFormat:"n",negativeFormat:"-n"},CurrencyMasker.DefaultFormatMeta=u.extend({},NumberMasker.DefaultFormatMeta,{positiveFormat:"n",negativeFormat:"-n"}),AddressMasker.defaultFormatMeta={express:"C S T R P",separator:" "},DateTimeMasker.DefaultFormatMeta={format:"yyyy-MM-dd hh:mm:ss",speratorSymbol:"-"},u.AddressMasker=AddressMasker,u.NumberMasker=NumberMasker,u.CurrencyMasker=CurrencyMasker,u.DateTimeMasker=DateTimeMasker,u.DateMasker=DateMasker,u.TimeMasker=TimeMasker,u.PercentMasker=PercentMasker,NumberFormater.prototype.update=function(e){this.precision=e},NumberFormater.prototype.format=function(e){if(!u.isNumber(e))return"";for(;"0"==(e+"").charAt(0)&&e.length>1;)e=e.substring(1);var t=e;if(u.isNumber(this.precision)){if(window.BigNumber)t=new BigNumber(e).toFixed(this.precision);else{var n=parseFloat(e);t=(Math.round(n*Math.pow(10,this.precision))/Math.pow(10,this.precision)).toFixed(this.precision)}if("NaN"==t)return""}return t},DateFormater.prototype.update=function(e){this.pattern=e},DateFormater.prototype.format=function(e){return moment(e).format(this.pattern)},u.NumberFormater=NumberFormater,u.DateFormater=DateFormater,u.date={_dateLocale:{"zh-CN":{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_")},"en-US":{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thurday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"S_M_T_W_T_F_S".split("_")}},_formattingTokens:/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYY|YY|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,leftZeroFill:function(e,t,n){for(var i=""+Math.abs(e),r=e>=0;i.length<t;)i="0"+i;return(r?n?"+":"":"-")+i},_formats:{YY:function(e){return u.date.leftZeroFill(e.getFullYear()%100,2)},YYYY:function(e){return e.getFullYear()},M:function(e){return e.getMonth()+1},MM:function(e){var t=u.date._formats.M(e);return u.date.leftZeroFill(t,2)},MMM:function(e,t){var n=e.getMonth();return u.date._dateLocale[t].monthsShort[n]},MMMM:function(e,t){var n=e.getMonth();return u.date._dateLocale[t].months[n]},D:function(e){return e.getDate()},DD:function(e){var t=u.date._formats.D(e);return u.date.leftZeroFill(t,2)},d:function(e){return e.getDay()},dd:function(e,t){var n=u.date._formats.d(e);return u.date._dateLocale[t].weekdaysMin[n]},ddd:function(e,t){var n=u.date._formats.d(e);return u.date._dateLocale[t].weekdaysShort[n]},dddd:function(e,t){var n=u.date._formats.d(e);return u.date._dateLocale[t].weekdays[n]},a:function(e){return e.getHours()>12?"pm":"am"},h:function(e){var t=e.getHours();return t=t>12?t-12:t},hh:function(e){var t=u.date._formats.h(e);return u.date.leftZeroFill(t,2)},H:function(e){return e.getHours()},HH:function(e){return u.date.leftZeroFill(e.getHours(),2)},m:function(e){return e.getMinutes()},mm:function(e){return u.date.leftZeroFill(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return u.date.leftZeroFill(e.getSeconds(),2)}},format:function(e,t,n){var i,r,a=t.match(u.date._formattingTokens),s="";for(n=n||u.core.getLanguages(),i=0,r=a.length;r>i;i++)s+=u.date._formats[a[i]]?u.date._formats[a[i]](e,n):a[i];return s},_addOrSubtract:function(e,t,n,i){var r=e.getTime(),a=e.getDate(),s=e.getMonth(),o=new Date(e);return"ms"===t?(r+=n*i,o.setTime(r)):"s"==t?(r+=1e3*n*i,o.setTime(r)):"m"==t?(r+=6e4*n*i,o.setTime(r)):"h"==t?(r+=36e5*n*i,o.setTime(r)):"d"==t?(a+=n*i,o.setDate(a)):"w"==t?(a+=7*n*i,o.setDate(a)):"M"==t?(s+=n*i,o.setMonth(a)):"y"==t&&(s+=12*n*i,o.setMonth(a)),o},add:function(e,t,n){return u.date._addOrSubtract(e,t,n,1)},sub:function(e,t,n){return u.date._addOrSubtract(e,t,n,-1)}},u.floatRender=function(e,t){var n=e;if("undefined"==typeof e||null===e)return e;"function"==typeof e&&(n=e());var i=u.Core.getMaskerMeta("float")||{};"number"==typeof t&&(i.precision=t);var r=new $.NumberFormater(i.precision),a=new NumberMasker(i);return a.format(r.format(n)).value},u.integerRender=function(e){var t=e;return"undefined"==typeof e||null===e?e:("function"==typeof e&&(t=e()),t)},u.dateRender=function(e,t){var n=e;if("undefined"==typeof e||null===e)return e;"function"==typeof e&&(n=e());var i=u.Core.getMaskerMeta("date")||{};"undefined"!=typeof t&&(i.format=t);var r=new DateMasker(i);return r.format(n).value},u.dateTimeRender=function(e,t){var n=e;if("undefined"==typeof e||null===e)return e;"function"==typeof e&&(n=e());var i=u.Core.getMaskerMeta("datetime")||{};"undefined"!=typeof t&&(i.format=t);var r=new DateTimeMasker(i);return r.format(n).value},u.timeRender=function(e,t){var n=e;if("undefined"==typeof e||null===e)return e;"function"==typeof e&&(n=e());var i=u.Core.getMaskerMeta("time")||{};"undefined"!=typeof t&&(i.format=t);var r=new TimeMasker(i);return r.format(n).value},u.percentRender=function(e){var t=e;if("undefined"==typeof e||null===e)return e;"function"==typeof e&&(t=e());var n=u.Core.getMaskerMeta("percent")||{},i=new PercentMasker(n);return i.format(t).value},u.dateToUTCString=function(e){if(!e)return"";e.indexOf("-")>-1&&(e=e.replace(/\-/g,"/"));var t=Date.parse(e);return isNaN(t)?"":t};var _hotkeys={};_hotkeys.special_keys={27:"esc",9:"tab",32:"space",13:"enter",8:"backspace",145:"scroll",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"del",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},_hotkeys.shift_nums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},_hotkeys.add=function(e,t,n){u.isFunction(t)&&(n=t,t={});var i={},r={type:"keydown",propagate:!1,disableInInput:!1,target:document.body,checkParent:!0},a=this;i=u.extend(i,r,t||{}),e=e.toLowerCase();var s=function(e){var t=this;if(t=3==t.nodeType?t.parentNode:t,i.disableInInput){var n=t;if("INPUT"==n.tagName||"TEXTAREA"==n.tagName)return}var r=e.which,s=e.type,o=String.fromCharCode(r).toLowerCase(),u=a.special_keys[r],l=e.shiftKey,d=e.ctrlKey,c=e.altKey,f=null;if(i.checkParent)for(;!t["u.hotkeys"]&&t.parentNode;)t=t.parentNode;var p=t["u.hotkeys"].events[s].callbackMap;if(l||d||c){var h="";c&&(h+="alt+"),d&&(h+="ctrl+"),l&&(h+="shift+"),f=p[h+u]||p[h+o]||p[h+a.shift_nums[o]]}else f=p[u]||p[o];return f&&(f.cb(e),!f.propagate)?(e.stopPropagation(),e.preventDefault(),!1):void 0},o=i.target["u.hotkeys"];return o||(i.target["u.hotkeys"]=o={events:{}}),o.events[i.type]||(o.events[i.type]={callbackMap:{}},u.on(i.target,i.type,s)),o.events[i.type].callbackMap[e]={cb:n,propagate:i.propagate},u.hotkeys},_hotkeys.remove=function(e,t){t=t||{},target=t.target||document.body,type=t.type||"keydown",e=e.toLowerCase(),delete target["u.hotkeys"].events[type].callbackMap[e]},_hotkeys.scan=function(e,t){e=e||document.body,e.querySelectorAll("[u-enter]").forEach(function(n){var i=n.getAttribute("u-enter");if(i)if("#"==i.substring(0,1))u.hotkeys.add("enter",{target:this},function(){var t=e.querySelector(i);t&&t.focus()});else{t=t||window;var r=u.getFunction(t,i);u.hotkeys.add("enter",{target:this},function(){r.call(this)})}}),e.querySelectorAll("[u-hotkey]").forEach(function(e){var t=e.getAttribute("u-hotkey");t&&u.hotkeys.add(t,function(){e.click()})})},u.hotkeys=_hotkeys,+function(){var e=!0;!function(t){var n=this||(0,eval)("this"),i=n.document,r=n.navigator,a=n.jQuery,s=n.JSON;!function(e){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var t=module.exports||exports;e(t,require)}else"function"==typeof define&&define.amd?define(["exports","require"],e):e(n.ko={})}(function(o,u){function l(e,t){var n=null===e||typeof e in g;return n?e===t:!1}function d(e,n){var i;return function(){i||(i=setTimeout(function(){i=t,e()},n))}}function c(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function f(e){var t=this;return e&&m.utils.objectForEach(e,function(e,n){var i=m.extenders[e];"function"==typeof i&&(t=i(t,n)||t)}),t}function p(e){m.bindingHandlers[e]={init:function(t,n,i,r,a){var s=function(){var t={};return t[e]=n(),t};return m.bindingHandlers.event.init.call(this,t,s,i,r,a)}}}function h(e,t,n,i){m.bindingHandlers[e]={init:function(e,r,a,s,o){var u,l;return m.computed(function(){var a=m.utils.unwrapObservable(r()),s=!n!=!a,d=!l,c=d||t||s!==u;c&&(d&&m.computedContext.getDependenciesCount()&&(l=m.utils.cloneNodes(m.virtualElements.childNodes(e),!0)),s?(d||m.virtualElements.setDomNodeChildren(e,m.utils.cloneNodes(l)),m.applyBindingsToDescendants(i?i(o,a):o,e)):m.virtualElements.emptyNode(e),u=s)},null,{disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},m.expressionRewriting.bindingRewriteValidators[e]=!1,m.virtualElements.allowedBindings[e]=!0}var m="undefined"!=typeof o?o:{};n.ko=m,m.exportSymbol=function(e,t){for(var n=e.split("."),i=m,r=0;r<n.length-1;r++)i=i[n[r]];i[n[n.length-1]]=t},m.exportProperty=function(e,t,n){e[t]=n},m.version="3.2.0",m.exportSymbol("version",m.version),m.utils=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function o(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function u(e,t){return e.__proto__=t,e}function l(e,t){if("input"!==m.utils.tagNameLower(e)||!e.type)return!1;if("click"!=t.toLowerCase())return!1;var n=e.type;return"checkbox"==n||"radio"==n}var d={__proto__:[]}instanceof Array,c={},f={},p=r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents";c[p]=["keyup","keydown","keypress"],c.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],e(c,function(e,t){if(t.length)for(var n=0,i=t.length;i>n;n++)f[t[n]]=e});var h={propertychange:!0},g=i&&function(){for(var e=3,n=i.createElement("div"),r=n.getElementsByTagName("i");n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",r[0];);return e>4?e:t}(),v=6===g,b=7===g;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(e,t){for(var n=0,i=e.length;i>n;n++)t(e[n],n)},arrayIndexOf:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},arrayFirst:function(e,t,n){for(var i=0,r=e.length;r>i;i++)if(t.call(n,e[i],i))return e[i];return null},arrayRemoveItem:function(e,t){var n=m.utils.arrayIndexOf(e,t);n>0?e.splice(n,1):0===n&&e.shift()},arrayGetDistinctValues:function(e){e=e||[];for(var t=[],n=0,i=e.length;i>n;n++)m.utils.arrayIndexOf(t,e[n])<0&&t.push(e[n]);return t},arrayMap:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)n.push(t(e[i],i));return n},arrayFilter:function(e,t){e=e||[];for(var n=[],i=0,r=e.length;r>i;i++)t(e[i],i)&&n.push(e[i]);return n},arrayPushAll:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,i=t.length;i>n;n++)e.push(t[n]);return e},addOrRemoveItem:function(e,t,n){var i=m.utils.arrayIndexOf(m.utils.peekObservable(e),t);0>i?n&&e.push(t):n||e.splice(i,1)},canSetPrototype:d,extend:o,setPrototypeOf:u,setPrototypeOfOrExtend:d?u:o,objectForEach:e,objectMap:function(e,t){if(!e)return e;var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i],i,e));return n},emptyDomNode:function(e){for(;e.firstChild;)m.removeNode(e.firstChild)},moveCleanedNodesToContainerElement:function(e){for(var t=m.utils.makeArray(e),n=i.createElement("div"),r=0,a=t.length;a>r;r++)n.appendChild(m.cleanNode(t[r]));return n},cloneNodes:function(e,t){for(var n=0,i=e.length,r=[];i>n;n++){var a=e[n].cloneNode(!0);r.push(t?m.cleanNode(a):a)}return r},setDomNodeChildren:function(e,t){if(m.utils.emptyDomNode(e),t)for(var n=0,i=t.length;i>n;n++)e.appendChild(t[n])},replaceDomNodes:function(e,t){var n=e.nodeType?[e]:e;if(n.length>0){for(var i=n[0],r=i.parentNode,a=0,s=t.length;s>a;a++)r.insertBefore(t[a],i);for(var a=0,s=n.length;s>a;a++)m.removeNode(n[a])}},fixUpContinuousNodeArray:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.shift();if(e.length>1){var n=e[0],i=e[e.length-1];for(e.length=0;n!==i;)if(e.push(n),n=n.nextSibling,!n)return;e.push(i)}}return e},setOptionNodeSelectionState:function(e,t){7>g?e.setAttribute("selected",t):e.selected=t},stringTrim:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringStartsWith:function(e,t){return e=e||"",t.length>e.length?!1:e.substring(0,t.length)===t},domNodeIsContainedBy:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},domNodeIsAttachedToDocument:function(e){return m.utils.domNodeIsContainedBy(e,e.ownerDocument.documentElement)},anyDomNodeIsAttachedToDocument:function(e){return!!m.utils.arrayFirst(e,m.utils.domNodeIsAttachedToDocument)},tagNameLower:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},registerEventHandler:function(e,t,n){var i=g&&h[t];if(!i&&a)a(e).bind(t,n);else if(i||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw new Error("Browser doesn't support addEventListener or attachEvent");var r=function(t){n.call(e,t)},s="on"+t;e.attachEvent(s,r),m.utils.domNodeDisposal.addDisposeCallback(e,function(){e.detachEvent(s,r)})}else e.addEventListener(t,n,!1)},triggerEvent:function(e,t){if(!e||!e.nodeType)throw new Error("element must be a DOM node when calling triggerEvent");var r=l(e,t);if(a&&!r)a(e).trigger(t);else if("function"==typeof i.createEvent){if("function"!=typeof e.dispatchEvent)throw new Error("The supplied element doesn't support dispatchEvent");var s=f[t]||"HTMLEvents",o=i.createEvent(s);o.initEvent(t,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(o)}else if(r&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw new Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}},unwrapObservable:function(e){return m.isObservable(e)?e():e},peekObservable:function(e){return m.isObservable(e)?e.peek():e},toggleDomNodeCssClass:function(e,t,n){if(t){var i=/\S+/g,r=e.className.match(i)||[];m.utils.arrayForEach(t.match(i),function(e){m.utils.addOrRemoveItem(r,e,n)}),e.className=r.join(" ")}},setTextContent:function(e,n){var i=m.utils.unwrapObservable(n);(null===i||i===t)&&(i="");var r=m.virtualElements.firstChild(e);!r||3!=r.nodeType||m.virtualElements.nextSibling(r)?m.virtualElements.setDomNodeChildren(e,[e.ownerDocument.createTextNode(i)]):r.data=i,m.utils.forceRefresh(e)},setElementName:function(e,t){if(e.name=t,7>=g)try{e.mergeAttributes(i.createElement("<input name='"+e.name+"'/>"),!1)}catch(n){}},forceRefresh:function(e){if(g>=9){var t=1==e.nodeType?e:e.parentNode;t.style&&(t.style.zoom=t.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(e){if(g){var t=e.style.width;e.style.width=0,e.style.width=t}},range:function(e,t){e=m.utils.unwrapObservable(e),t=m.utils.unwrapObservable(t);for(var n=[],i=e;t>=i;i++)n.push(i);return n},makeArray:function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},isIe6:v,isIe7:b,ieVersion:g,getFormFields:function(e,t){for(var n=m.utils.makeArray(e.getElementsByTagName("input")).concat(m.utils.makeArray(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],a=n.length-1;a>=0;a--)i(n[a])&&r.push(n[a]);return r},parseJson:function(e){return"string"==typeof e&&(e=m.utils.stringTrim(e))?s&&s.parse?s.parse(e):new Function("return "+e)():null},stringifyJson:function(e,t,n){if(!s||!s.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return s.stringify(m.utils.unwrapObservable(e),t,n)},postJson:function(t,n,r){r=r||{};var a=r.params||{},s=r.includeFields||this.fieldsIncludedWithJsonPost,o=t;if("object"==typeof t&&"form"===m.utils.tagNameLower(t)){var u=t;o=u.action;for(var l=s.length-1;l>=0;l--)for(var d=m.utils.getFormFields(u,s[l]),c=d.length-1;c>=0;c--)a[d[c].name]=d[c].value}n=m.utils.unwrapObservable(n);var f=i.createElement("form");f.style.display="none",f.action=o,f.method="post";for(var p in n){var h=i.createElement("input");h.type="hidden",h.name=p,h.value=m.utils.stringifyJson(m.utils.unwrapObservable(n[p])),f.appendChild(h)}e(a,function(e,t){var n=i.createElement("input");n.type="hidden",n.name=e,n.value=t,f.appendChild(n)}),i.body.appendChild(f),r.submitter?r.submitter(f):f.submit(),setTimeout(function(){f.parentNode.removeChild(f)},0)}}}(),m.exportSymbol("utils",m.utils),m.exportSymbol("utils.arrayForEach",m.utils.arrayForEach),m.exportSymbol("utils.arrayFirst",m.utils.arrayFirst),m.exportSymbol("utils.arrayFilter",m.utils.arrayFilter),m.exportSymbol("utils.arrayGetDistinctValues",m.utils.arrayGetDistinctValues),m.exportSymbol("utils.arrayIndexOf",m.utils.arrayIndexOf),m.exportSymbol("utils.arrayMap",m.utils.arrayMap),m.exportSymbol("utils.arrayPushAll",m.utils.arrayPushAll),m.exportSymbol("utils.arrayRemoveItem",m.utils.arrayRemoveItem),m.exportSymbol("utils.extend",m.utils.extend),m.exportSymbol("utils.fieldsIncludedWithJsonPost",m.utils.fieldsIncludedWithJsonPost),m.exportSymbol("utils.getFormFields",m.utils.getFormFields),m.exportSymbol("utils.peekObservable",m.utils.peekObservable),m.exportSymbol("utils.postJson",m.utils.postJson),m.exportSymbol("utils.parseJson",m.utils.parseJson),m.exportSymbol("utils.registerEventHandler",m.utils.registerEventHandler),m.exportSymbol("utils.stringifyJson",m.utils.stringifyJson),m.exportSymbol("utils.range",m.utils.range),m.exportSymbol("utils.toggleDomNodeCssClass",m.utils.toggleDomNodeCssClass),m.exportSymbol("utils.triggerEvent",m.utils.triggerEvent),m.exportSymbol("utils.unwrapObservable",m.utils.unwrapObservable),m.exportSymbol("utils.objectForEach",m.utils.objectForEach),m.exportSymbol("utils.addOrRemoveItem",m.utils.addOrRemoveItem),m.exportSymbol("unwrap",m.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments),e=n.shift();return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),m.utils.domData=new function(){function e(e,a){var s=e[i],o=s&&"null"!==s&&r[s];if(!o){if(!a)return t;s=e[i]="ko"+n++,r[s]={}}return r[s]}var n=0,i="__ko__"+(new Date).getTime(),r={};return{get:function(n,i){var r=e(n,!1);return r===t?t:r[i]},set:function(n,i,r){if(r!==t||e(n,!1)!==t){var a=e(n,!0);a[i]=r}},clear:function(e){var t=e[i];return t?(delete r[t],e[i]=null,!0):!1},nextKey:function(){return n++ +i}}},m.exportSymbol("utils.domData",m.utils.domData),m.exportSymbol("utils.domData.clear",m.utils.domData.clear),m.utils.domNodeDisposal=new function(){function e(e,n){var i=m.utils.domData.get(e,s);return i===t&&n&&(i=[],m.utils.domData.set(e,s,i)),i}function n(e){m.utils.domData.set(e,s,t)}function i(t){var n=e(t,!1);if(n){n=n.slice(0);for(var i=0;i<n.length;i++)n[i](t)}m.utils.domData.clear(t),m.utils.domNodeDisposal.cleanExternalData(t),u[t.nodeType]&&r(t)}function r(e){for(var t,n=e.firstChild;t=n;)n=t.nextSibling,8===t.nodeType&&i(t)}var s=m.utils.domData.nextKey(),o={1:!0,8:!0,9:!0},u={1:!0,9:!0};return{addDisposeCallback:function(t,n){if("function"!=typeof n)throw new Error("Callback must be a function");e(t,!0).push(n)},removeDisposeCallback:function(t,i){var r=e(t,!1);r&&(m.utils.arrayRemoveItem(r,i),0==r.length&&n(t))},cleanNode:function(e){if(o[e.nodeType]&&(i(e),u[e.nodeType])){var t=[];m.utils.arrayPushAll(t,e.getElementsByTagName("*"));for(var n=0,r=t.length;r>n;n++)i(t[n])}return e},removeNode:function(e){m.cleanNode(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){a&&"function"==typeof a.cleanData&&a.cleanData([e])}}},m.cleanNode=m.utils.domNodeDisposal.cleanNode,m.removeNode=m.utils.domNodeDisposal.removeNode,m.exportSymbol("cleanNode",m.cleanNode),m.exportSymbol("removeNode",m.removeNode),m.exportSymbol("utils.domNodeDisposal",m.utils.domNodeDisposal),m.exportSymbol("utils.domNodeDisposal.addDisposeCallback",m.utils.domNodeDisposal.addDisposeCallback),m.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",m.utils.domNodeDisposal.removeDisposeCallback),function(){function e(e){var t=m.utils.stringTrim(e).toLowerCase(),r=i.createElement("div"),a=t.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!t.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!t.indexOf("<td")||!t.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""],s="ignored<div>"+a[1]+e+a[2]+"</div>";for("function"==typeof n.innerShiv?r.appendChild(n.innerShiv(s)):r.innerHTML=s;a[0]--;)r=r.lastChild;return m.utils.makeArray(r.lastChild.childNodes)}function r(e){if(a.parseHTML)return a.parseHTML(e)||[];var t=a.clean([e]);if(t&&t[0]){for(var n=t[0];n.parentNode&&11!==n.parentNode.nodeType;)n=n.parentNode;n.parentNode&&n.parentNode.removeChild(n)}return t}m.utils.parseHtmlFragment=function(t){return a?r(t):e(t)},m.utils.setHtml=function(e,n){if(m.utils.emptyDomNode(e),n=m.utils.unwrapObservable(n),null!==n&&n!==t)if("string"!=typeof n&&(n=n.toString()),a)a(e).html(n);else for(var i=m.utils.parseHtmlFragment(n),r=0;r<i.length;r++)e.appendChild(i[r])}}(),m.exportSymbol("utils.parseHtmlFragment",m.utils.parseHtmlFragment),m.exportSymbol("utils.setHtml",m.utils.setHtml),m.memoization=function(){function e(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function n(){return e()+e()}function i(e,t){if(e)if(8==e.nodeType){var n=m.memoization.parseMemoText(e.nodeValue);null!=n&&t.push({domNode:e,memoId:n})}else if(1==e.nodeType)for(var r=0,a=e.childNodes,s=a.length;s>r;r++)i(a[r],t)}var r={};return{memoize:function(e){if("function"!=typeof e)throw new Error("You can only pass a function to ko.memoization.memoize()");var t=n();return r[t]=e,"<!--[ko_memo:"+t+"]-->"},unmemoize:function(e,n){var i=r[e];if(i===t)throw new Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return i.apply(null,n||[]),!0}finally{delete r[e]}},unmemoizeDomNodeAndDescendants:function(e,t){var n=[];i(e,n);for(var r=0,a=n.length;a>r;r++){var s=n[r].domNode,o=[s];t&&m.utils.arrayPushAll(o,t),m.memoization.unmemoize(n[r].memoId,o),s.nodeValue="",s.parentNode&&s.parentNode.removeChild(s)}},parseMemoText:function(e){var t=e.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),m.exportSymbol("memoization",m.memoization),m.exportSymbol("memoization.memoize",m.memoization.memoize),m.exportSymbol("memoization.unmemoize",m.memoization.unmemoize),m.exportSymbol("memoization.parseMemoText",m.memoization.parseMemoText),m.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",m.memoization.unmemoizeDomNodeAndDescendants),m.extenders={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return m.dependentObservable({read:e,write:function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var n,i,r;"number"==typeof t?n=t:(n=t.timeout,i=t.method),r="notifyWhenChangesStop"==i?c:d,e.limit(function(e){return r(e,n)})},notify:function(e,t){e.equalityComparer="always"==t?null:l}};var g={undefined:1,"boolean":1,number:1,string:1};m.exportSymbol("extenders",m.extenders),m.subscription=function(e,t,n){this.target=e,this.callback=t,this.disposeCallback=n,this.isDisposed=!1,m.exportProperty(this,"dispose",this.dispose)},m.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},m.subscribable=function(){m.utils.setPrototypeOfOrExtend(this,m.subscribable.fn),this._subscriptions={}};var v="change",b={subscribe:function(e,t,n){var i=this;n=n||v;var r=t?e.bind(t):e,a=new m.subscription(i,r,function(){m.utils.arrayRemoveItem(i._subscriptions[n],a),i.afterSubscriptionRemove&&i.afterSubscriptionRemove(n)});return i.beforeSubscriptionAdd&&i.beforeSubscriptionAdd(n),i._subscriptions[n]||(i._subscriptions[n]=[]),i._subscriptions[n].push(a),a},notifySubscribers:function(e,t){if(t=t||v,this.hasSubscriptionsForEvent(t))try{m.dependencyDetection.begin();for(var n,i=this._subscriptions[t].slice(0),r=0;n=i[r];++r)n.isDisposed||n.callback(e)}finally{m.dependencyDetection.end()}},limit:function(e){var t,n,i,r=this,a=m.isObservable(r),s="beforeChange";r._origNotifySubscribers||(r._origNotifySubscribers=r.notifySubscribers,r.notifySubscribers=function(e,t){t&&t!==v?t===s?r._rateLimitedBeforeChange(e):r._origNotifySubscribers(e,t):r._rateLimitedChange(e)});var o=e(function(){a&&i===r&&(i=r()),t=!1,r.isDifferent(n,i)&&r._origNotifySubscribers(n=i)});r._rateLimitedChange=function(e){t=!0,i=e,o()},r._rateLimitedBeforeChange=function(e){t||(n=e,r._origNotifySubscribers(e,s))}},hasSubscriptionsForEvent:function(e){return this._subscriptions[e]&&this._subscriptions[e].length},getSubscriptionsCount:function(){var e=0;return m.utils.objectForEach(this._subscriptions,function(t,n){e+=n.length}),e},isDifferent:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:f};m.exportProperty(b,"subscribe",b.subscribe),m.exportProperty(b,"extend",b.extend),m.exportProperty(b,"getSubscriptionsCount",b.getSubscriptionsCount),m.utils.canSetPrototype&&m.utils.setPrototypeOf(b,Function.prototype),m.subscribable.fn=b,m.isSubscribable=function(e){return null!=e&&"function"==typeof e.subscribe&&"function"==typeof e.notifySubscribers},m.exportSymbol("subscribable",m.subscribable),m.exportSymbol("isSubscribable",m.isSubscribable),m.computedContext=m.dependencyDetection=function(){function e(){return++a}function t(e){r.push(i),i=e}function n(){i=r.pop()}var i,r=[],a=0;return{begin:t,end:n,registerDependency:function(t){if(i){if(!m.isSubscribable(t))throw new Error("Only subscribable things can act as dependencies");i.callback(t,t._id||(t._id=e()))}},ignore:function(e,i,r){try{return t(),e.apply(i,r||[])}finally{n()}},getDependenciesCount:function(){return i?i.computed.getDependenciesCount():void 0},isInitial:function(){return i?i.isInitial:void 0}}}(),m.exportSymbol("computedContext",m.computedContext),m.exportSymbol("computedContext.getDependenciesCount",m.computedContext.getDependenciesCount),m.exportSymbol("computedContext.isInitial",m.computedContext.isInitial),m.exportSymbol("computedContext.isSleeping",m.computedContext.isSleeping),m.observable=function(t){function n(){return arguments.length>0?(n.isDifferent(i,arguments[0])&&(n.valueWillMutate(),i=arguments[0],e&&(n._latestValue=i),n.valueHasMutated()),this):(m.dependencyDetection.registerDependency(n),i)}var i=t;return m.subscribable.call(n),m.utils.setPrototypeOfOrExtend(n,m.observable.fn),e&&(n._latestValue=i),n.peek=function(){return i},n.valueHasMutated=function(){n.notifySubscribers(i)},n.valueWillMutate=function(){
n.notifySubscribers(i,"beforeChange")},m.exportProperty(n,"peek",n.peek),m.exportProperty(n,"valueHasMutated",n.valueHasMutated),m.exportProperty(n,"valueWillMutate",n.valueWillMutate),n},m.observable.fn={equalityComparer:l};var y=m.observable.protoProperty="__ko_proto__";m.observable.fn[y]=m.observable,m.utils.canSetPrototype&&m.utils.setPrototypeOf(m.observable.fn,m.subscribable.fn),m.hasPrototype=function(e,n){return null===e||e===t||e[y]===t?!1:e[y]===n?!0:m.hasPrototype(e[y],n)},m.isObservable=function(e){return m.hasPrototype(e,m.observable)},m.isWriteableObservable=function(e){return"function"==typeof e&&e[y]===m.observable?!0:"function"==typeof e&&e[y]===m.dependentObservable&&e.hasWriteFunction?!0:!1},m.exportSymbol("observable",m.observable),m.exportSymbol("isObservable",m.isObservable),m.exportSymbol("isWriteableObservable",m.isWriteableObservable),m.exportSymbol("isWritableObservable",m.isWriteableObservable),m.observableArray=function(e){if(e=e||[],"object"!=typeof e||!("length"in e))throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var t=m.observable(e);return m.utils.setPrototypeOfOrExtend(t,m.observableArray.fn),t.extend({trackArrayChanges:!0})},m.observableArray.fn={remove:function(e){for(var t=this.peek(),n=[],i="function"!=typeof e||m.isObservable(e)?function(t){return t===e}:e,r=0;r<t.length;r++){var a=t[r];i(a)&&(0===n.length&&this.valueWillMutate(),n.push(a),t.splice(r,1),r--)}return n.length&&this.valueHasMutated(),n},removeAll:function(e){if(e===t){var n=this.peek(),i=n.slice(0);return this.valueWillMutate(),n.splice(0,n.length),this.valueHasMutated(),i}return e?this.remove(function(t){return m.utils.arrayIndexOf(e,t)>=0}):[]},destroy:function(e){var t=this.peek(),n="function"!=typeof e||m.isObservable(e)?function(t){return t===e}:e;this.valueWillMutate();for(var i=t.length-1;i>=0;i--){var r=t[i];n(r)&&(t[i]._destroy=!0)}this.valueHasMutated()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return m.utils.arrayIndexOf(e,t)>=0}):[]},indexOf:function(e){var t=this();return m.utils.arrayIndexOf(t,e)},replace:function(e,t){var n=this.indexOf(e);n>=0&&(this.valueWillMutate(),this.peek()[n]=t,this.valueHasMutated())}},m.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(e){m.observableArray.fn[e]=function(){var t=this.peek();this.valueWillMutate(),this.cacheDiffForKnownOperation(t,e,arguments);var n=t[e].apply(t,arguments);return this.valueHasMutated(),n}}),m.utils.arrayForEach(["slice"],function(e){m.observableArray.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),m.utils.canSetPrototype&&m.utils.setPrototypeOf(m.observableArray.fn,m.observable.fn),m.exportSymbol("observableArray",m.observableArray);var w="arrayChange";m.extenders.trackArrayChanges=function(e){function t(){if(!i){i=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==v||++a,t.apply(this,arguments)};var s=[].concat(e.peek()||[]);r=null,e.subscribe(function(t){if(t=[].concat(t||[]),e.hasSubscriptionsForEvent(w)){var i=n(s,t);i.length&&e.notifySubscribers(i,w)}s=t,r=null,a=0})}}function n(e,t){return(!r||a>1)&&(r=m.utils.compareArrays(e,t,{sparse:!0})),r}if(!e.cacheDiffForKnownOperation){var i=!1,r=null,a=0,s=e.subscribe;e.subscribe=e.subscribe=function(e,n,i){return i===w&&t(),s.apply(this,arguments)},e.cacheDiffForKnownOperation=function(e,t,n){function s(e,t,n){return o[o.length]={status:e,value:t,index:n}}if(i&&!a){var o=[],u=e.length,l=n.length,d=0;switch(t){case"push":d=u;case"unshift":for(var c=0;l>c;c++)s("added",n[c],d+c);break;case"pop":d=u-1;case"shift":u&&s("deleted",e[d],d);break;case"splice":for(var f=Math.min(Math.max(0,n[0]<0?u+n[0]:n[0]),u),p=1===l?u:Math.min(f+(n[1]||0),u),h=f+l-2,g=Math.max(p,h),v=[],b=[],c=f,y=2;g>c;++c,++y)p>c&&b.push(s("deleted",e[c],c)),h>c&&v.push(s("added",n[y],c));m.utils.findMovesInArrayComparison(b,v);break;default:return}r=o}}}},m.computed=m.dependentObservable=function(n,i,r){function a(e,t){A[t]||(A[t]=e.subscribe(u),++C)}function s(){m.utils.objectForEach(A,function(e,t){t.dispose()}),A={}}function o(){s(),C=0,b=!0,h=!1}function u(){var e=d.throttleEvaluation;e&&e>=0?(clearTimeout(R),R=setTimeout(l,e)):d._evalRateLimited?d._evalRateLimited():l()}function l(n){if(g){if(w)throw Error("A 'pure' computed must not be called recursively")}else if(!b){if(D&&D()){if(!v)return void T()}else v=!1;if(g=!0,M)try{var r={};m.dependencyDetection.begin({callback:function(e,t){r[t]||(r[t]=1,++C)},computed:d,isInitial:t}),C=0,p=y.call(i)}finally{m.dependencyDetection.end(),g=!1}else try{var s=A,o=C;m.dependencyDetection.begin({callback:function(e,t){b||(o&&s[t]?(A[t]=s[t],++C,delete s[t],--o):a(e,t))},computed:d,isInitial:w?t:!C}),A={},C=0;try{var u=i?y.call(i):y()}finally{m.dependencyDetection.end(),o&&m.utils.objectForEach(s,function(e,t){t.dispose()}),h=!1}d.isDifferent(p,u)&&(d.notifySubscribers(p,"beforeChange"),p=u,e&&(d._latestValue=p),n!==!0&&d.notifySubscribers(p))}finally{g=!1}C||T()}}function d(){if(arguments.length>0){if("function"!=typeof E)throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return E.apply(i,arguments),this}return m.dependencyDetection.registerDependency(d),h&&l(!0),p}function c(){return h&&!C&&l(!0),p}function f(){return h||C>0}var p,h=!0,g=!1,v=!1,b=!1,y=n,w=!1,M=!1;if(y&&"object"==typeof y?(r=y,y=r.read):(r=r||{},y||(y=r.read)),"function"!=typeof y)throw new Error("Pass a function that returns the value of the ko.computed");var E=r.write,S=r.disposeWhenNodeIsRemoved||r.disposeWhenNodeIsRemoved||null,x=r.disposeWhen||r.disposeWhen,D=x,T=o,A={},C=0,R=null;i||(i=r.owner),m.subscribable.call(d),m.utils.setPrototypeOfOrExtend(d,m.dependentObservable.fn),d.peek=c,d.getDependenciesCount=function(){return C},d.hasWriteFunction="function"==typeof r.write,d.dispose=function(){T()},d.isActive=f;var N=d.limit;return d.limit=function(e){N.call(d,e),d._evalRateLimited=function(){d._rateLimitedBeforeChange(p),h=!0,d._rateLimitedChange(d)}},r.pure?(w=!0,M=!0,d.beforeSubscriptionAdd=function(){M&&(M=!1,l(!0))},d.afterSubscriptionRemove=function(){d.getSubscriptionsCount()||(s(),M=h=!0)}):r.deferEvaluation&&(d.beforeSubscriptionAdd=function(){c(),delete d.beforeSubscriptionAdd}),m.exportProperty(d,"peek",d.peek),m.exportProperty(d,"dispose",d.dispose),m.exportProperty(d,"isActive",d.isActive),m.exportProperty(d,"getDependenciesCount",d.getDependenciesCount),S&&(v=!0,S.nodeType&&(D=function(){return!m.utils.domNodeIsAttachedToDocument(S)||x&&x()})),M||r.deferEvaluation||l(),S&&f()&&S.nodeType&&(T=function(){m.utils.domNodeDisposal.removeDisposeCallback(S,T),o()},m.utils.domNodeDisposal.addDisposeCallback(S,T)),d},m.isComputed=function(e){return m.hasPrototype(e,m.dependentObservable)};var M=m.observable.protoProperty;m.dependentObservable[M]=m.observable,m.dependentObservable.fn={equalityComparer:l},m.dependentObservable.fn[M]=m.dependentObservable,m.utils.canSetPrototype&&m.utils.setPrototypeOf(m.dependentObservable.fn,m.subscribable.fn),m.exportSymbol("dependentObservable",m.dependentObservable),m.exportSymbol("computed",m.dependentObservable),m.exportSymbol("isComputed",m.isComputed),m.pureComputed=function(e,t){return"function"==typeof e?m.computed(e,t,{pure:!0}):(e=m.utils.extend({},e),e.pure=!0,m.computed(e,t))},m.exportSymbol("pureComputed",m.pureComputed),function(){function e(r,a,s){s=s||new i,r=a(r);var o=!("object"!=typeof r||null===r||r===t||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean);if(!o)return r;var u=r instanceof Array?[]:{};return s.save(r,u),n(r,function(n){var i=a(r[n]);switch(typeof i){case"boolean":case"number":case"string":case"function":u[n]=i;break;case"object":case"undefined":var o=s.get(i);u[n]=o!==t?o:e(i,a,s)}}),u}function n(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(var i in e)t(i)}function i(){this.keys=[],this.values=[]}var r=10;m.toJS=function(t){if(0==arguments.length)throw new Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;m.isObservable(e)&&r>t;t++)e=e();return e})},m.toJSON=function(e,t,n){var i=m.toJS(e);return m.utils.stringifyJson(i,t,n)},i.prototype={constructor:i,save:function(e,t){var n=m.utils.arrayIndexOf(this.keys,e);n>=0?this.values[n]=t:(this.keys.push(e),this.values.push(t))},get:function(e){var n=m.utils.arrayIndexOf(this.keys,e);return n>=0?this.values[n]:t}}}(),m.exportSymbol("toJS",m.toJS),m.exportSymbol("toJSON",m.toJSON),function(){var e="__ko__hasDomDataOptionValue__";m.selectExtensions={readValue:function(n){switch(m.utils.tagNameLower(n)){case"option":return n[e]===!0?m.utils.domData.get(n,m.bindingHandlers.options.optionValueDomDataKey):m.utils.ieVersion<=7?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return n.selectedIndex>=0?m.selectExtensions.readValue(n.options[n.selectedIndex]):t;default:return n.value}},writeValue:function(n,i,r){switch(m.utils.tagNameLower(n)){case"option":switch(typeof i){case"string":m.utils.domData.set(n,m.bindingHandlers.options.optionValueDomDataKey,t),e in n&&delete n[e],n.value=i;break;default:m.utils.domData.set(n,m.bindingHandlers.options.optionValueDomDataKey,i),n[e]=!0,n.value="number"==typeof i?i:""}break;case"select":(""===i||null===i)&&(i=t);for(var a,s=-1,o=0,u=n.options.length;u>o;++o)if(a=m.selectExtensions.readValue(n.options[o]),a==i||""==a&&i===t){s=o;break}(r||s>=0||i===t&&n.size>1)&&(n.selectedIndex=s);break;default:(null===i||i===t)&&(i=""),n.value=i}}}}(),m.exportSymbol("selectExtensions",m.selectExtensions),m.exportSymbol("selectExtensions.readValue",m.selectExtensions.readValue),m.exportSymbol("selectExtensions.writeValue",m.selectExtensions.writeValue),m.expressionRewriting=function(){function e(e){if(m.utils.arrayIndexOf(i,e)>=0)return!1;var t=e.match(r);return null===t?!1:t[1]?"Object("+t[1]+")"+t[2]:e}function t(e){var t=m.utils.stringTrim(e);123===t.charCodeAt(0)&&(t=t.slice(1,-1));var n,i,r=[],a=t.match(c),s=0;if(a){a.push(",");for(var o,u=0;o=a[u];++u){var l=o.charCodeAt(0);if(44===l){if(0>=s){n&&r.push(i?{key:n,value:i.join("")}:{unknown:n}),n=i=s=0;continue}}else if(58===l){if(!i)continue}else if(47===l&&u&&o.length>1){var d=a[u-1].match(f);d&&!p[d[0]]&&(t=t.substr(t.indexOf(o)+1),a=t.match(c),a.push(","),u=-1,o="/")}else if(40===l||123===l||91===l)++s;else if(41===l||125===l||93===l)--s;else if(!n&&!i){n=34===l||39===l?o.slice(1,-1):o;continue}i?i.push(o):i=[o]}}return r}function n(n,i){function r(t,n){function i(e){return e&&e.preprocess?n=e.preprocess(n,t,r):!0}var l;if(!u){if(!i(m.getBindingHandler(t)))return;h[t]&&(l=e(n))&&s.push("'"+t+"':function(_z){"+l+"=_z}")}o&&(n="function(){return "+n+" }"),a.push("'"+t+"':"+n)}i=i||{};var a=[],s=[],o=i.valueAccessors,u=i.bindingParams,l="string"==typeof n?t(n):n;return m.utils.arrayForEach(l,function(e){r(e.key||e.unknown,e.value)}),s.length&&r("_ko_property_writers","{"+s.join(",")+" }"),a.join(",")}var i=["true","false","null","undefined"],r=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,a='"(?:[^"\\\\]|\\\\.)*"',s="'(?:[^'\\\\]|\\\\.)*'",o="/(?:[^/\\\\]|\\\\.)*/w*",u=",\"'{}()/:[\\]",l="[^\\s:,/][^"+u+"]*[^\\s"+u+"]",d="[^\\s]",c=RegExp(a+"|"+s+"|"+o+"|"+l+"|"+d,"g"),f=/[\])"'A-Za-z0-9_$]+$/,p={"in":1,"return":1,"typeof":1},h={};return{bindingRewriteValidators:[],twoWayBindings:h,parseObjectLiteral:t,preProcessBindings:n,keyValueArrayContainsKey:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},writeValueToProperty:function(e,t,n,i,r){if(e&&m.isObservable(e))!m.isWriteableObservable(e)||r&&e.peek()===i||e(i);else{var a=t.get("_ko_property_writers");a&&a[n]&&a[n](i)}}}}(),m.exportSymbol("expressionRewriting",m.expressionRewriting),m.exportSymbol("expressionRewriting.bindingRewriteValidators",m.expressionRewriting.bindingRewriteValidators),m.exportSymbol("expressionRewriting.parseObjectLiteral",m.expressionRewriting.parseObjectLiteral),m.exportSymbol("expressionRewriting.preProcessBindings",m.expressionRewriting.preProcessBindings),m.exportSymbol("expressionRewriting._twoWayBindings",m.expressionRewriting.twoWayBindings),m.exportSymbol("jsonExpressionRewriting",m.expressionRewriting),m.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.expressionRewriting.preProcessBindings),function(){function e(e){return 8==e.nodeType&&o.test(s?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&u.test(s?e.text:e.nodeValue)}function n(n,i){for(var r=n,a=1,s=[];r=r.nextSibling;){if(t(r)&&(a--,0===a))return s;s.push(r),e(r)&&a++}if(!i)throw new Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var i=n(e,t);return i?i.length>0?i[i.length-1].nextSibling:e.nextSibling:null}function a(n){var i=n.firstChild,a=null;if(i)do if(a)a.push(i);else if(e(i)){var s=r(i,!0);s?i=s:a=[i]}else t(i)&&(a=[i]);while(i=i.nextSibling);return a}var s=i&&"<!--test-->"===i.createComment("test").text,o=s?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,u=s?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};m.virtualElements={allowedBindings:{},childNodes:function(t){return e(t)?n(t):t.childNodes},emptyNode:function(t){if(e(t))for(var n=m.virtualElements.childNodes(t),i=0,r=n.length;r>i;i++)m.removeNode(n[i]);else m.utils.emptyDomNode(t)},setDomNodeChildren:function(t,n){if(e(t)){m.virtualElements.emptyNode(t);for(var i=t.nextSibling,r=0,a=n.length;a>r;r++)i.parentNode.insertBefore(n[r],i)}else m.utils.setDomNodeChildren(t,n)},prepend:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},insertAfter:function(t,n,i){i?e(t)?t.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?t.insertBefore(n,i.nextSibling):t.appendChild(n):m.virtualElements.prepend(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},hasBindingValue:e,virtualNodeBindingValue:function(e){var t=(s?e.text:e.nodeValue).match(o);return t?t[1]:null},normaliseVirtualElementDomStructure:function(e){if(l[m.utils.tagNameLower(e)]){var t=e.firstChild;if(t)do if(1===t.nodeType){var n=a(t);if(n)for(var i=t.nextSibling,r=0;r<n.length;r++)i?e.insertBefore(n[r],i):e.appendChild(n[r])}while(t=t.nextSibling)}}}}(),m.exportSymbol("virtualElements",m.virtualElements),m.exportSymbol("virtualElements.allowedBindings",m.virtualElements.allowedBindings),m.exportSymbol("virtualElements.emptyNode",m.virtualElements.emptyNode),m.exportSymbol("virtualElements.insertAfter",m.virtualElements.insertAfter),m.exportSymbol("virtualElements.prepend",m.virtualElements.prepend),m.exportSymbol("virtualElements.setDomNodeChildren",m.virtualElements.setDomNodeChildren),function(){function e(e,n,i){var r=e+(i&&i.valueAccessors||"");return n[r]||(n[r]=t(e,i))}function t(e,t){var n=m.expressionRewriting.preProcessBindings(e,t),i="with($context){with($data||{}){return{"+n+"}}}";return new Function("$context","$element",i)}var n="data-bind";m.bindingProvider=function(){this.bindingCache={}},m.utils.extend(m.bindingProvider.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute(n)||m.components.getComponentNameForNode(e);case 8:return m.virtualElements.hasBindingValue(e);default:return!1}},getBindings:function(e,t){var n=this.getBindingsString(e,t),i=n?this.parseBindingsString(n,t,e):null;return m.components.addBindingsForCustomElement(i,e,t,!1)},getBindingAccessors:function(e,t){var n=this.getBindingsString(e,t),i=n?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return m.components.addBindingsForCustomElement(i,e,t,!0)},getBindingsString:function(e,t){switch(e.nodeType){case 1:return e.getAttribute(n);case 8:return m.virtualElements.virtualNodeBindingValue(e);default:return null}},parseBindingsString:function(t,n,i,r){try{var a=e(t,this.bindingCache,r);return a(n,i)}catch(s){throw s.message="Unable to parse bindings.\nBindings value: "+t+"\nMessage: "+s.message,s}}}),m.bindingProvider.instance=new m.bindingProvider}(),m.exportSymbol("bindingProvider",m.bindingProvider),function(){function e(e){return function(){return e}}function i(e){return e()}function r(e){return m.utils.objectMap(m.dependencyDetection.ignore(e),function(t,n){return function(){return e()[n]}})}function s(t,n,i){return"function"==typeof t?r(t.bind(null,n,i)):m.utils.objectMap(t,e)}function o(e,t){return r(this.getBindings.bind(this,e,t))}function u(e){var t=m.virtualElements.allowedBindings[e];if(!t)throw new Error("The binding '"+e+"' cannot be used with virtual elements")}function l(e,t,n){var i,r=m.virtualElements.firstChild(t),a=m.bindingProvider.instance,s=a.preprocessNode;if(s){for(;i=r;)r=m.virtualElements.nextSibling(i),s.call(a,i);r=m.virtualElements.firstChild(t)}for(;i=r;)r=m.virtualElements.nextSibling(i),d(e,i,n)}function d(e,t,n){var i=!0,r=1===t.nodeType;r&&m.virtualElements.normaliseVirtualElementDomStructure(t);var a=r&&n||m.bindingProvider.instance.nodeHasBindings(t);a&&(i=f(t,null,e,n).shouldBindDescendants),i&&!h[m.utils.tagNameLower(t)]&&l(e,t,!r)}function c(e){var t=[],n={},i=[];return m.utils.objectForEach(e,function r(a){if(!n[a]){var s=m.getBindingHandler(a);s&&(s.after&&(i.push(a),m.utils.arrayForEach(s.after,function(t){if(e[t]){if(-1!==m.utils.arrayIndexOf(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));r(t)}}),i.length--),t.push({key:a,handler:s})),n[a]=!0}}),t}function f(e,n,r,a){function s(){return m.utils.objectMap(h?h():d,i)}var l=m.utils.domData.get(e,g);if(!n){if(l)throw Error("You cannot apply bindings multiple times to the same element.");m.utils.domData.set(e,g,!0)}!l&&a&&m.storedBindingContextForNode(e,r);var d;if(n&&"function"!=typeof n)d=n;else{var f=m.bindingProvider.instance,p=f.getBindingAccessors||o,h=m.dependentObservable(function(){return d=n?n(r,e):p.call(f,e,r),d&&r._subscribable&&r._subscribable(),d},null,{disposeWhenNodeIsRemoved:e});d&&h.isActive()||(h=null)}var v;if(d){var b=h?function(e){return function(){return i(h()[e])}}:function(e){return d[e]};s.get=function(e){return d[e]&&i(b(e))},s.has=function(e){return e in d};var y=c(d);m.utils.arrayForEach(y,function(n){var i=n.handler.init,a=n.handler.update,o=n.key;8===e.nodeType&&u(o);try{"function"==typeof i&&m.dependencyDetection.ignore(function(){var n=i(e,b(o),s,r.$data,r);if(n&&n.controlsDescendantBindings){if(v!==t)throw new Error("Multiple bindings ("+v+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");v=o}}),"function"==typeof a&&m.dependentObservable(function(){a(e,b(o),s,r.$data,r)},null,{disposeWhenNodeIsRemoved:e})}catch(l){throw l.message='Unable to process binding "'+o+": "+d[o]+'"\nMessage: '+l.message,l}})}return{shouldBindDescendants:v===t}}function p(e){return e&&e instanceof m.bindingContext?e:new m.bindingContext(e)}m.bindingHandlers={};var h={script:!0};m.getBindingHandler=function(e){return m.bindingHandlers[e]},m.bindingContext=function(e,n,i,r){function a(){var t=l?e():e,a=m.utils.unwrapObservable(t);return n?(n._subscribable&&n._subscribable(),m.utils.extend(u,n),d&&(u._subscribable=d)):(u.$parents=[],u.$root=a,u.ko=m),u.$rawData=t,u.$data=a,i&&(u[i]=a),r&&r(u,n,a),u.$data}function s(){return o&&!m.utils.anyDomNodeIsAttachedToDocument(o)}var o,u=this,l="function"==typeof e&&!m.isObservable(e),d=m.dependentObservable(a,null,{disposeWhen:s,disposeWhenNodeIsRemoved:!0});d.isActive()&&(u._subscribable=d,d.equalityComparer=null,o=[],d._addNode=function(e){o.push(e),m.utils.domNodeDisposal.addDisposeCallback(e,function(e){m.utils.arrayRemoveItem(o,e),o.length||(d.dispose(),u._subscribable=d=t)})})},m.bindingContext.prototype.createChildContext=function(e,t,n){return new m.bindingContext(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},m.bindingContext.prototype.extend=function(e){return new m.bindingContext(this._subscribable||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,m.utils.extend(t,"function"==typeof e?e():e)})};var g=m.utils.domData.nextKey(),v=m.utils.domData.nextKey();m.storedBindingContextForNode=function(e,t){return 2!=arguments.length?m.utils.domData.get(e,v):(m.utils.domData.set(e,v,t),void(t._subscribable&&t._subscribable._addNode(e)))},m.applyBindingAccessorsToNode=function(e,t,n){return 1===e.nodeType&&m.virtualElements.normaliseVirtualElementDomStructure(e),f(e,t,p(n),!0)},m.applyBindingsToNode=function(e,t,n){var i=p(n);return m.applyBindingAccessorsToNode(e,s(t,i,e),i)},m.applyBindingsToDescendants=function(e,t){(1===t.nodeType||8===t.nodeType)&&l(p(e),t,!0)},m.applyBindings=function(e,t){if(!a&&n.jQuery&&(a=n.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body,d(p(e),t,!0)},m.contextFor=function(e){switch(e.nodeType){case 1:case 8:var n=m.storedBindingContextForNode(e);if(n)return n;if(e.parentNode)return m.contextFor(e.parentNode)}return t},m.dataFor=function(e){var n=m.contextFor(e);return n?n.$data:t},m.exportSymbol("bindingHandlers",m.bindingHandlers),m.exportSymbol("applyBindings",m.applyBindings),m.exportSymbol("applyBindingsToDescendants",m.applyBindingsToDescendants),m.exportSymbol("applyBindingAccessorsToNode",m.applyBindingAccessorsToNode),m.exportSymbol("applyBindingsToNode",m.applyBindingsToNode),m.exportSymbol("contextFor",m.contextFor),m.exportSymbol("dataFor",m.dataFor)}(),function(e){function t(t,n){return t.hasOwnProperty(n)?t[n]:e}function n(e,n){var r,o=t(a,e);o||(o=a[e]=new m.subscribable,i(e,function(t){s[e]=t,delete a[e],r?o.notifySubscribers(t):setTimeout(function(){o.notifySubscribers(t)},0)}),r=!0),o.subscribe(n)}function i(e,t){r("getConfig",[e],function(n){n?r("loadComponent",[e,n],function(e){t(e)}):t(null)})}function r(t,n,i,a){a||(a=m.components.loaders.slice(0));var s=a.shift();if(s){var o=s[t];if(o){var u=!1,l=o.apply(s,n.concat(function(e){u?i(null):null!==e?i(e):r(t,n,i,a)}));if(l!==e&&(u=!0,!s.suppressLoaderExceptions))throw new Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(t,n,i,a)}else i(null)}var a={},s={};m.components={get:function(e,i){var r=t(s,e);r?setTimeout(function(){i(r)},0):n(e,i)},clearCachedDefinition:function(e){delete s[e]},_getFirstResultFromLoaders:r},m.components.loaders=[],m.exportSymbol("components",m.components),m.exportSymbol("components.get",m.components.get),m.exportSymbol("components.clearCachedDefinition",m.components.clearCachedDefinition)}(),function(e){function t(e,t,n,i){var r={},a=2,s=function(){0===--a&&i(r)},o=n.template,u=n.viewModel;o?d(t,o,function(t){m.components._getFirstResultFromLoaders("loadTemplate",[e,t],function(e){r.template=e,s()})}):s(),u?d(t,u,function(t){m.components._getFirstResultFromLoaders("loadViewModel",[e,t],function(e){r[p]=e,s()})}):s()}function r(e,t,n){if("string"==typeof t)n(m.utils.parseHtmlFragment(t));else if(t instanceof Array)n(t);else if(l(t))n(m.utils.makeArray(t.childNodes));else if(t.element){var r=t.element;if(o(r))n(s(r));else if("string"==typeof r){var a=i.getElementById(r);a?n(s(a)):e("Cannot find element with ID "+r)}else e("Unknown element type: "+r)}else e("Unknown template value: "+t)}function a(e,t,n){if("function"==typeof t)n(function(e){return new t(e)});else if("function"==typeof t[p])n(t[p]);else if("instance"in t){var i=t.instance;n(function(e,t){return i})}else"viewModel"in t?a(e,t.viewModel,n):e("Unknown viewModel value: "+t)}function s(e){switch(m.utils.tagNameLower(e)){case"script":return m.utils.parseHtmlFragment(e.text);case"textarea":return m.utils.parseHtmlFragment(e.value);case"template":if(l(e.content))return m.utils.cloneNodes(e.content.childNodes)}return m.utils.cloneNodes(e.childNodes)}function o(e){return n.HTMLElement?e instanceof HTMLElement:e&&e.tagName&&1===e.nodeType}function l(e){return n.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function d(e,t,i){"string"==typeof t.require?u||n.require?(u||n.require)([t.require],i):e("Uses require, but no AMD loader is present"):i(t)}function c(e){return function(t){throw new Error("Component '"+e+"': "+t)}}var f={};m.components.register=function(e,t){if(!t)throw new Error("Invalid configuration for "+e);if(m.components.isRegistered(e))throw new Error("Component "+e+" is already registered");f[e]=t},m.components.isRegistered=function(e){return e in f},m.components.unregister=function(e){delete f[e],m.components.clearCachedDefinition(e)},m.components.defaultLoader={getConfig:function(e,t){var n=f.hasOwnProperty(e)?f[e]:null;t(n)},loadComponent:function(e,n,i){var r=c(e);d(r,n,function(n){t(e,r,n,i)})},loadTemplate:function(e,t,n){r(c(e),t,n)},loadViewModel:function(e,t,n){a(c(e),t,n)}};var p="createViewModel";m.exportSymbol("components.register",m.components.register),m.exportSymbol("components.isRegistered",m.components.isRegistered),m.exportSymbol("components.unregister",m.components.unregister),m.exportSymbol("components.defaultLoader",m.components.defaultLoader),m.components.loaders.push(m.components.defaultLoader),m.components._allRegisteredComponents=f}(),function(e){function t(e,t){var i=e.getAttribute("params");if(i){var r=n.parseBindingsString(i,t,e,{valueAccessors:!0,bindingParams:!0}),a=m.utils.objectMap(r,function(t,n){return m.computed(t,null,{disposeWhenNodeIsRemoved:e})}),s=m.utils.objectMap(a,function(t,n){return t.isActive()?m.computed(function(){return m.utils.unwrapObservable(t())},null,{disposeWhenNodeIsRemoved:e}):t.peek()});return s.hasOwnProperty("$raw")||(s.$raw=a),s}return{$raw:{}}}m.components.getComponentNameForNode=function(e){var t=m.utils.tagNameLower(e);return m.components.isRegistered(t)&&t},m.components.addBindingsForCustomElement=function(e,n,i,r){if(1===n.nodeType){var a=m.components.getComponentNameForNode(n);if(a){if(e=e||{},e.component)throw new Error('Cannot use the "component" binding on a custom element matching a component');var s={name:a,params:t(n,i)};e.component=r?function(){return s}:s}}return e};var n=new m.bindingProvider;m.utils.ieVersion<9&&(m.components.register=function(e){return function(t){return i.createElement(t),e.apply(this,arguments)}}(m.components.register),i.createDocumentFragment=function(e){return function(){var t=e(),n=m.components._allRegisteredComponents;for(var i in n)n.hasOwnProperty(i)&&t.createElement(i);return t}}(i.createDocumentFragment))}(),function(e){function t(e,t,n){var i=t.template;if(!i)throw new Error("Component '"+e+"' has no template");var r=m.utils.cloneNodes(i);m.virtualElements.setDomNodeChildren(n,r)}function n(e,t,n){var i=e.createViewModel;return i?i.call(e,n,{element:t}):n}var i=0;m.bindingHandlers.component={init:function(e,r,a,s,o){var u,l,d=function(){var e=u&&u.dispose;"function"==typeof e&&e.call(u),l=null};return m.utils.domNodeDisposal.addDisposeCallback(e,d),m.computed(function(){var a,s,c=m.utils.unwrapObservable(r());if("string"==typeof c?a=c:(a=m.utils.unwrapObservable(c.name),s=m.utils.unwrapObservable(c.params)),!a)throw new Error("No component name specified");var f=l=++i;m.components.get(a,function(i){if(l===f){if(d(),!i)throw new Error("Unknown component '"+a+"'");t(a,i,e);var r=n(i,e,s),c=o.createChildContext(r);u=r,m.applyBindingsToDescendants(c,e)}})},null,{disposeWhenNodeIsRemoved:e}),{controlsDescendantBindings:!0}}},m.virtualElements.allowedBindings.component=!0}();var E={"class":"className","for":"htmlFor"};m.bindingHandlers.attr={update:function(e,n,i){var r=m.utils.unwrapObservable(n())||{};m.utils.objectForEach(r,function(n,i){i=m.utils.unwrapObservable(i);var r=i===!1||null===i||i===t;r&&e.removeAttribute(n),m.utils.ieVersion<=8&&n in E?(n=E[n],r?e.removeAttribute(n):e[n]=i):r||e.setAttribute(n,i.toString()),"name"===n&&m.utils.setElementName(e,r?"":i.toString())})}},function(){m.bindingHandlers.checked={after:["value","attr"],init:function(e,n,i){function r(){var t=e.checked,r=c?s():t;if(!m.computedContext.isInitial()&&(!u||t)){var a=m.dependencyDetection.ignore(n);l?d!==r?(t&&(m.utils.addOrRemoveItem(a,r,!0),m.utils.addOrRemoveItem(a,d,!1)),d=r):m.utils.addOrRemoveItem(a,r,t):m.expressionRewriting.writeValueToProperty(a,i,"checked",r,!0)}}function a(){var t=m.utils.unwrapObservable(n());l?e.checked=m.utils.arrayIndexOf(t,s())>=0:o?e.checked=t:e.checked=s()===t}var s=m.pureComputed(function(){return i.has("checkedValue")?m.utils.unwrapObservable(i.get("checkedValue")):i.has("value")?m.utils.unwrapObservable(i.get("value")):e.value}),o="checkbox"==e.type,u="radio"==e.type;if(o||u){var l=o&&m.utils.unwrapObservable(n())instanceof Array,d=l?s():t,c=u||l;u&&!e.name&&m.bindingHandlers.uniqueName.init(e,function(){return!0}),m.computed(r,null,{disposeWhenNodeIsRemoved:e}),m.utils.registerEventHandler(e,"click",r),m.computed(a,null,{disposeWhenNodeIsRemoved:e})}}},m.expressionRewriting.twoWayBindings.checked=!0,m.bindingHandlers.checkedValue={update:function(e,t){e.value=m.utils.unwrapObservable(t())}}}();var S="__ko__cssValue";m.bindingHandlers.css={update:function(e,t){var n=m.utils.unwrapObservable(t());"object"==typeof n?m.utils.objectForEach(n,function(t,n){n=m.utils.unwrapObservable(n),m.utils.toggleDomNodeCssClass(e,t,n)}):(n=String(n||""),m.utils.toggleDomNodeCssClass(e,e[S],!1),e[S]=n,m.utils.toggleDomNodeCssClass(e,n,!0))}},m.bindingHandlers.enable={update:function(e,t){var n=m.utils.unwrapObservable(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},m.bindingHandlers.disable={update:function(e,t){m.bindingHandlers.enable.update(e,function(){return!m.utils.unwrapObservable(t())})}},m.bindingHandlers.event={init:function(e,t,n,i,r){var a=t()||{};m.utils.objectForEach(a,function(a){"string"==typeof a&&m.utils.registerEventHandler(e,a,function(e){var s,o=t()[a];if(o){try{var u=m.utils.makeArray(arguments);i=r.$data,u.unshift(i),s=o.apply(i,u)}finally{s!==!0&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}var l=n.get(a+"Bubble")!==!1;l||(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},m.bindingHandlers.foreach={makeTemplateValueAccessor:function(e){return function(){var t=e(),n=m.utils.peekObservable(t);return n&&"number"!=typeof n.length?(m.utils.unwrapObservable(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:m.nativeTemplateEngine.instance}):{foreach:t,templateEngine:m.nativeTemplateEngine.instance}}},init:function(e,t,n,i,r){return m.bindingHandlers.template.init(e,m.bindingHandlers.foreach.makeTemplateValueAccessor(t))},update:function(e,t,n,i,r){return m.bindingHandlers.template.update(e,m.bindingHandlers.foreach.makeTemplateValueAccessor(t),n,i,r)}},m.expressionRewriting.bindingRewriteValidators.foreach=!1,m.virtualElements.allowedBindings.foreach=!0;var x="__ko_hasfocusUpdating",D="__ko_hasfocusLastValue";m.bindingHandlers.hasfocus={init:function(e,t,n){var i=function(i){e[x]=!0;var r=e.ownerDocument;if("activeElement"in r){var a;try{a=r.activeElement}catch(s){a=r.body}i=a===e}var o=t();m.expressionRewriting.writeValueToProperty(o,n,"hasfocus",i,!0),e[D]=i,e[x]=!1},r=i.bind(null,!0),a=i.bind(null,!1);m.utils.registerEventHandler(e,"focus",r),m.utils.registerEventHandler(e,"focusin",r),m.utils.registerEventHandler(e,"blur",a),m.utils.registerEventHandler(e,"focusout",a)},update:function(e,t){var n=!!m.utils.unwrapObservable(t());e[x]||e[D]===n||(n?e.focus():e.blur(),
m.dependencyDetection.ignore(m.utils.triggerEvent,null,[e,n?"focusin":"focusout"]))}},m.expressionRewriting.twoWayBindings.hasfocus=!0,m.bindingHandlers.hasFocus=m.bindingHandlers.hasfocus,m.expressionRewriting.twoWayBindings.hasFocus=!0,m.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.utils.setHtml(e,t())}},h("if"),h("ifnot",!1,!0),h("with",!0,!1,function(e,t){return e.createChildContext(t)});var T={};m.bindingHandlers.options={init:function(e){if("select"!==m.utils.tagNameLower(e))throw new Error("options binding applies only to SELECT elements");for(;e.length>0;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,n,i){function r(){return m.utils.arrayFilter(e.options,function(e){return e.selected})}function a(e,t,n){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:n}function s(n,r,s){s.length&&(d=s[0].selected?[m.selectExtensions.readValue(s[0])]:[],v=!0);var o=e.ownerDocument.createElement("option");if(n===T)m.utils.setTextContent(o,i.get("optionsCaption")),m.selectExtensions.writeValue(o,t);else{var u=a(n,i.get("optionsValue"),n);m.selectExtensions.writeValue(o,m.utils.unwrapObservable(u));var l=a(n,i.get("optionsText"),u);m.utils.setTextContent(o,l)}return[o]}function o(t,n){if(d.length){var i=m.utils.arrayIndexOf(d,m.selectExtensions.readValue(n[0]))>=0;m.utils.setOptionNodeSelectionState(n[0],i),v&&!i&&m.dependencyDetection.ignore(m.utils.triggerEvent,null,[e,"change"])}}var u,l,d,c=0==e.length,f=!c&&e.multiple?e.scrollTop:null,p=m.utils.unwrapObservable(n()),h=i.get("optionsIncludeDestroyed"),g={};d=e.multiple?m.utils.arrayMap(r(),m.selectExtensions.readValue):e.selectedIndex>=0?[m.selectExtensions.readValue(e.options[e.selectedIndex])]:[],p&&("undefined"==typeof p.length&&(p=[p]),l=m.utils.arrayFilter(p,function(e){return h||e===t||null===e||!m.utils.unwrapObservable(e._destroy)}),i.has("optionsCaption")&&(u=m.utils.unwrapObservable(i.get("optionsCaption")),null!==u&&u!==t&&l.unshift(T)));var v=!1;g.beforeRemove=function(t){e.removeChild(t)};var b=o;i.has("optionsAfterRender")&&(b=function(e,n){o(e,n),m.dependencyDetection.ignore(i.get("optionsAfterRender"),null,[n[0],e!==T?e:t])}),m.utils.setDomNodeChildrenFromArrayMapping(e,l,s,g,b),m.dependencyDetection.ignore(function(){if(i.get("valueAllowUnset")&&i.has("value"))m.selectExtensions.writeValue(e,m.utils.unwrapObservable(i.get("value")),!0);else{var t;t=e.multiple?d.length&&r().length<d.length:d.length&&e.selectedIndex>=0?m.selectExtensions.readValue(e.options[e.selectedIndex])!==d[0]:d.length||e.selectedIndex>=0,t&&m.utils.triggerEvent(e,"change")}}),m.utils.ensureSelectElementIsRenderedCorrectly(e),f&&Math.abs(f-e.scrollTop)>20&&(e.scrollTop=f)}},m.bindingHandlers.options.optionValueDomDataKey=m.utils.domData.nextKey(),m.bindingHandlers.selectedOptions={after:["options","foreach"],init:function(e,t,n){m.utils.registerEventHandler(e,"change",function(){var i=t(),r=[];m.utils.arrayForEach(e.getElementsByTagName("option"),function(e){e.selected&&r.push(m.selectExtensions.readValue(e))}),m.expressionRewriting.writeValueToProperty(i,n,"selectedOptions",r)})},update:function(e,t){if("select"!=m.utils.tagNameLower(e))throw new Error("values binding applies only to SELECT elements");var n=m.utils.unwrapObservable(t());n&&"number"==typeof n.length&&m.utils.arrayForEach(e.getElementsByTagName("option"),function(e){var t=m.utils.arrayIndexOf(n,m.selectExtensions.readValue(e))>=0;m.utils.setOptionNodeSelectionState(e,t)})}},m.expressionRewriting.twoWayBindings.selectedOptions=!0,m.bindingHandlers.style={update:function(e,n){var i=m.utils.unwrapObservable(n()||{});m.utils.objectForEach(i,function(n,i){i=m.utils.unwrapObservable(i),(null===i||i===t||i===!1)&&(i=""),e.style[n]=i})}},m.bindingHandlers.submit={init:function(e,t,n,i,r){if("function"!=typeof t())throw new Error("The value for a submit binding must be a function");m.utils.registerEventHandler(e,"submit",function(n){var i,a=t();try{i=a.call(r.$data,e)}finally{i!==!0&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},m.bindingHandlers.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){m.utils.setTextContent(e,t())}},m.virtualElements.allowedBindings.text=!0,function(){if(n&&n.navigator)var i=function(e){return e?parseFloat(e[1]):void 0},r=n.opera&&n.opera.version&&parseInt(n.opera.version()),a=n.navigator.userAgent,s=i(a.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=i(a.match(/Firefox\/([^ ]*)/));if(m.utils.ieVersion<10)var u=m.utils.domData.nextKey(),l=m.utils.domData.nextKey(),d=function(e){var t=this.activeElement,n=t&&m.utils.domData.get(t,l);n&&n(e)},c=function(e,t){var n=e.ownerDocument;m.utils.domData.get(n,u)||(m.utils.domData.set(n,u,!0),m.utils.registerEventHandler(n,"selectionchange",d)),m.utils.domData.set(e,l,t)};m.bindingHandlers.textInput={init:function(n,i,a){var u,l,d=n.value,f=function(r){clearTimeout(u),l=u=t;var s=n.value;d!==s&&(e&&r&&(n._ko_textInputProcessedEvent=r.type),d=s,m.expressionRewriting.writeValueToProperty(i(),a,"textInput",s))},p=function(t){if(!u){l=n.value;var i=e?f.bind(n,{type:t.type}):f;u=setTimeout(i,4)}},h=function(){var e=m.utils.unwrapObservable(i());return(null===e||e===t)&&(e=""),l!==t&&e===l?void setTimeout(h,4):void(n.value!==e&&(d=e,n.value=e))},g=function(e,t){m.utils.registerEventHandler(n,e,t)};e&&m.bindingHandlers.textInput._forceUpdateOn?m.utils.arrayForEach(m.bindingHandlers.textInput._forceUpdateOn,function(e){"after"==e.slice(0,5)?g(e.slice(5),p):g(e,f)}):m.utils.ieVersion<10?(g("propertychange",function(e){"value"===e.propertyName&&f(e)}),8==m.utils.ieVersion&&(g("keyup",f),g("keydown",f)),m.utils.ieVersion>=8&&(c(n,f),g("dragend",p))):(g("input",f),5>s&&"textarea"===m.utils.tagNameLower(n)?(g("keydown",p),g("paste",p),g("cut",p)):11>r?g("keydown",p):4>o&&(g("DOMAutoComplete",f),g("dragdrop",f),g("drop",f))),g("change",f),m.computed(h,null,{disposeWhenNodeIsRemoved:n})}},m.expressionRewriting.twoWayBindings.textInput=!0,m.bindingHandlers.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),m.bindingHandlers.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++m.bindingHandlers.uniqueName.currentIndex;m.utils.setElementName(e,n)}}},m.bindingHandlers.uniqueName.currentIndex=0,m.bindingHandlers.value={after:["options","foreach"],init:function(e,t,n){if("input"==e.tagName.toLowerCase()&&("checkbox"==e.type||"radio"==e.type))return void m.applyBindingAccessorsToNode(e,{checkedValue:t});var i=["change"],r=n.get("valueUpdate"),a=!1,s=null;r&&("string"==typeof r&&(r=[r]),m.utils.arrayPushAll(i,r),i=m.utils.arrayGetDistinctValues(i));var o=function(){s=null,a=!1;var i=t(),r=m.selectExtensions.readValue(e);m.expressionRewriting.writeValueToProperty(i,n,"value",r)},u=m.utils.ieVersion&&"input"==e.tagName.toLowerCase()&&"text"==e.type&&"off"!=e.autocomplete&&(!e.form||"off"!=e.form.autocomplete);u&&-1==m.utils.arrayIndexOf(i,"propertychange")&&(m.utils.registerEventHandler(e,"propertychange",function(){a=!0}),m.utils.registerEventHandler(e,"focus",function(){a=!1}),m.utils.registerEventHandler(e,"blur",function(){a&&o()})),m.utils.arrayForEach(i,function(t){var n=o;m.utils.stringStartsWith(t,"after")&&(n=function(){s=m.selectExtensions.readValue(e),setTimeout(o,0)},t=t.substring("after".length)),m.utils.registerEventHandler(e,t,n)});var l=function(){var i=m.utils.unwrapObservable(t()),r=m.selectExtensions.readValue(e);if(null!==s&&i===s)return void setTimeout(l,0);var a=i!==r;if(a)if("select"===m.utils.tagNameLower(e)){var o=n.get("valueAllowUnset"),u=function(){m.selectExtensions.writeValue(e,i,o)};u(),o||i===m.selectExtensions.readValue(e)?setTimeout(u,0):m.dependencyDetection.ignore(m.utils.triggerEvent,null,[e,"change"])}else m.selectExtensions.writeValue(e,i)};m.computed(l,null,{disposeWhenNodeIsRemoved:e})},update:function(){}},m.expressionRewriting.twoWayBindings.value=!0,m.bindingHandlers.visible={update:function(e,t){var n=m.utils.unwrapObservable(t()),i=!("none"==e.style.display);n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},p("click"),m.templateEngine=function(){},m.templateEngine.prototype.renderTemplateSource=function(e,t,n){throw new Error("Override renderTemplateSource")},m.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(e){throw new Error("Override createJavaScriptEvaluatorBlock")},m.templateEngine.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){t=t||i;var n=t.getElementById(e);if(!n)throw new Error("Cannot find template with ID "+e);return new m.templateSources.domElement(n)}if(1==e.nodeType||8==e.nodeType)return new m.templateSources.anonymousTemplate(e);throw new Error("Unknown template type: "+e)},m.templateEngine.prototype.renderTemplate=function(e,t,n,i){var r=this.makeTemplateSource(e,i);return this.renderTemplateSource(r,t,n)},m.templateEngine.prototype.isTemplateRewritten=function(e,t){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(e,t).data("isRewritten")},m.templateEngine.prototype.rewriteTemplate=function(e,t,n){var i=this.makeTemplateSource(e,n),r=t(i.text());i.text(r),i.data("isRewritten",!0)},m.exportSymbol("templateEngine",m.templateEngine),m.templateRewriting=function(){function e(e){for(var t=m.expressionRewriting.bindingRewriteValidators,n=0;n<e.length;n++){var i=e[n].key;if(t.hasOwnProperty(i)){var r=t[i];if("function"==typeof r){var a=r(e[n].value);if(a)throw new Error(a)}else if(!r)throw new Error("This template engine does not support the '"+i+"' binding within its templates")}}}function t(t,n,i,r){var a=m.expressionRewriting.parseObjectLiteral(t);e(a);var s=m.expressionRewriting.preProcessBindings(a,{valueAccessors:!0}),o="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+s+" } })()},'"+i.toLowerCase()+"')";return r.createJavaScriptEvaluatorBlock(o)+n}var n=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return m.templateRewriting.memoizeBindingAttributeSyntax(e,t)},n)},memoizeBindingAttributeSyntax:function(e,r){return e.replace(n,function(){return t(arguments[4],arguments[1],arguments[2],r)}).replace(i,function(){return t(arguments[1],"<!-- ko -->","#comment",r)})},applyMemoizedBindingsToNextSibling:function(e,t){return m.memoization.memoize(function(n,i){var r=n.nextSibling;r&&r.nodeName.toLowerCase()===t&&m.applyBindingAccessorsToNode(r,e,i)})}}}(),m.exportSymbol("__tr_ambtns",m.templateRewriting.applyMemoizedBindingsToNextSibling),function(){m.templateSources={},m.templateSources.domElement=function(e){this.domElement=e},m.templateSources.domElement.prototype.text=function(){var e=m.utils.tagNameLower(this.domElement),t="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.domElement[t];var n=arguments[0];"innerHTML"===t?m.utils.setHtml(this.domElement,n):this.domElement[t]=n};var e=m.utils.domData.nextKey()+"_";m.templateSources.domElement.prototype.data=function(t){return 1===arguments.length?m.utils.domData.get(this.domElement,e+t):void m.utils.domData.set(this.domElement,e+t,arguments[1])};var n=m.utils.domData.nextKey();m.templateSources.anonymousTemplate=function(e){this.domElement=e},m.templateSources.anonymousTemplate.prototype=new m.templateSources.domElement,m.templateSources.anonymousTemplate.prototype.constructor=m.templateSources.anonymousTemplate,m.templateSources.anonymousTemplate.prototype.text=function(){if(0==arguments.length){var e=m.utils.domData.get(this.domElement,n)||{};return e.textData===t&&e.containerData&&(e.textData=e.containerData.innerHTML),e.textData}var i=arguments[0];m.utils.domData.set(this.domElement,n,{textData:i})},m.templateSources.domElement.prototype.nodes=function(){if(0==arguments.length){var e=m.utils.domData.get(this.domElement,n)||{};return e.containerData}var t=arguments[0];m.utils.domData.set(this.domElement,n,{containerData:t})},m.exportSymbol("templateSources",m.templateSources),m.exportSymbol("templateSources.domElement",m.templateSources.domElement),m.exportSymbol("templateSources.anonymousTemplate",m.templateSources.anonymousTemplate)}(),function(){function e(e,t,n){for(var i,r=e,a=m.virtualElements.nextSibling(t);r&&(i=r)!==a;)r=m.virtualElements.nextSibling(i),n(i,r)}function n(t,n){if(t.length){var i=t[0],r=t[t.length-1],a=i.parentNode,s=m.bindingProvider.instance,o=s.preprocessNode;if(o){if(e(i,r,function(e,t){var n=e.previousSibling,a=o.call(s,e);a&&(e===i&&(i=a[0]||t),e===r&&(r=a[a.length-1]||n))}),t.length=0,!i)return;i===r?t.push(i):(t.push(i,r),m.utils.fixUpContinuousNodeArray(t,a))}e(i,r,function(e){(1===e.nodeType||8===e.nodeType)&&m.applyBindings(n,e)}),e(i,r,function(e){(1===e.nodeType||8===e.nodeType)&&m.memoization.unmemoizeDomNodeAndDescendants(e,[n])}),m.utils.fixUpContinuousNodeArray(t,a)}}function i(e){return e.nodeType?e:e.length>0?e[0]:null}function r(e,t,r,a,s){s=s||{};var u=e&&i(e),l=u&&u.ownerDocument,d=s.templateEngine||o;m.templateRewriting.ensureTemplateIsRewritten(r,d,l);var c=d.renderTemplate(r,a,s,l);if("number"!=typeof c.length||c.length>0&&"number"!=typeof c[0].nodeType)throw new Error("Template engine must return an array of DOM nodes");var f=!1;switch(t){case"replaceChildren":m.virtualElements.setDomNodeChildren(e,c),f=!0;break;case"replaceNode":m.utils.replaceDomNodes(e,c),f=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+t)}return f&&(n(c,a),s.afterRender&&m.dependencyDetection.ignore(s.afterRender,null,[c,a.$data])),c}function a(e,t,n){return m.isObservable(e)?e():"function"==typeof e?e(t,n):e}function s(e,n){var i=m.utils.domData.get(e,u);i&&"function"==typeof i.dispose&&i.dispose(),m.utils.domData.set(e,u,n&&n.isActive()?n:t)}var o;m.setTemplateEngine=function(e){if(e!=t&&!(e instanceof m.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");o=e},m.renderTemplate=function(e,n,s,u,l){if(s=s||{},(s.templateEngine||o)==t)throw new Error("Set a template engine before calling renderTemplate");if(l=l||"replaceChildren",u){var d=i(u),c=function(){return!d||!m.utils.domNodeIsAttachedToDocument(d)},f=d&&"replaceNode"==l?d.parentNode:d;return m.dependentObservable(function(){var t=n&&n instanceof m.bindingContext?n:new m.bindingContext(m.utils.unwrapObservable(n)),o=a(e,t.$data,t),c=r(u,l,o,t,s);"replaceNode"==l&&(u=c,d=i(u))},null,{disposeWhen:c,disposeWhenNodeIsRemoved:f})}return m.memoization.memoize(function(t){m.renderTemplate(e,n,s,t,"replaceNode")})},m.renderTemplateForEach=function(e,i,s,o,u){var l,d=function(t,n){l=u.createChildContext(t,s.as,function(e){e.$index=n});var i=a(e,t,l);return r(null,"ignoreTargetNode",i,l,s)},c=function(e,t,i){n(t,l),s.afterRender&&s.afterRender(t,e)};return m.dependentObservable(function(){var e=m.utils.unwrapObservable(i)||[];"undefined"==typeof e.length&&(e=[e]);var n=m.utils.arrayFilter(e,function(e){return s.includeDestroyed||e===t||null===e||!m.utils.unwrapObservable(e._destroy)});m.dependencyDetection.ignore(m.utils.setDomNodeChildrenFromArrayMapping,null,[o,n,d,s,c])},null,{disposeWhenNodeIsRemoved:o})};var u=m.utils.domData.nextKey();m.bindingHandlers.template={init:function(e,t){var n=m.utils.unwrapObservable(t());if("string"==typeof n||n.name)m.virtualElements.emptyNode(e);else{var i=m.virtualElements.childNodes(e),r=m.utils.moveCleanedNodesToContainerElement(i);new m.templateSources.anonymousTemplate(e).nodes(r)}return{controlsDescendantBindings:!0}},update:function(e,t,n,i,r){var a,o,u=t(),l=m.utils.unwrapObservable(u),d=!0,c=null;if("string"==typeof l?(o=u,l={}):(o=l.name,"if"in l&&(d=m.utils.unwrapObservable(l["if"])),d&&"ifnot"in l&&(d=!m.utils.unwrapObservable(l.ifnot)),a=m.utils.unwrapObservable(l.data)),"foreach"in l){var f=d&&l.foreach||[];c=m.renderTemplateForEach(o||e,f,l,e,r)}else if(d){var p="data"in l?r.createChildContext(a,l.as):r;c=m.renderTemplate(o||e,p,l,e)}else m.virtualElements.emptyNode(e);s(e,c)}},m.expressionRewriting.bindingRewriteValidators.template=function(e){var t=m.expressionRewriting.parseObjectLiteral(e);return 1==t.length&&t[0].unknown?null:m.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},m.virtualElements.allowedBindings.template=!0}(),m.exportSymbol("setTemplateEngine",m.setTemplateEngine),m.exportSymbol("renderTemplate",m.renderTemplate),m.utils.findMovesInArrayComparison=function(e,t,n){if(e.length&&t.length){var i,r,a,s,o;for(i=r=0;(!n||n>i)&&(s=e[r]);++r){for(a=0;o=t[a];++a)if(s.value===o.value){s.moved=o.index,o.moved=s.index,t.splice(a,1),i=a=0;break}i+=a}}},m.utils.compareArrays=function(){function e(e,r,a){return a="boolean"==typeof a?{dontLimitMoves:a}:a||{},e=e||[],r=r||[],e.length<=r.length?t(e,r,n,i,a):t(r,e,i,n,a)}function t(e,t,n,i,r){var a,s,o,u,l,d,c=Math.min,f=Math.max,p=[],h=e.length,g=t.length,v=g-h||1,b=h+g+1;for(a=0;h>=a;a++)for(u=o,p.push(o=[]),l=c(g,a+v),d=f(0,a-1),s=d;l>=s;s++)if(s)if(a)if(e[a-1]===t[s-1])o[s]=u[s-1];else{var y=u[s]||b,w=o[s-1]||b;o[s]=c(y,w)+1}else o[s]=s+1;else o[s]=a+1;var M,E=[],S=[],x=[];for(a=h,s=g;a||s;)M=p[a][s]-1,s&&M===p[a][s-1]?S.push(E[E.length]={status:n,value:t[--s],index:s}):a&&M===p[a-1][s]?x.push(E[E.length]={status:i,value:e[--a],index:a}):(--s,--a,r.sparse||E.push({status:"retained",value:t[s]}));return m.utils.findMovesInArrayComparison(S,x,10*h),E.reverse()}var n="added",i="deleted";return e}(),m.exportSymbol("utils.compareArrays",m.utils.compareArrays),function(){function e(e,n,i,r,a){var s=[],o=m.dependentObservable(function(){var t=n(i,a,m.utils.fixUpContinuousNodeArray(s,e))||[];s.length>0&&(m.utils.replaceDomNodes(s,t),r&&m.dependencyDetection.ignore(r,null,[i,t,a])),s.length=0,m.utils.arrayPushAll(s,t)},null,{disposeWhenNodeIsRemoved:e,disposeWhen:function(){return!m.utils.anyDomNodeIsAttachedToDocument(s)}});return{mappedNodes:s,dependentObservable:o.isActive()?o:t}}var n=m.utils.domData.nextKey();m.utils.setDomNodeChildrenFromArrayMapping=function(i,r,a,s,o){function u(e,t){d=h[t],w!==t&&(x[e]=d),d.indexObservable(w++),m.utils.fixUpContinuousNodeArray(d.mappedNodes,i),b.push(d),E.push(d)}function l(e,t){if(e)for(var n=0,i=t.length;i>n;n++)t[n]&&m.utils.arrayForEach(t[n].mappedNodes,function(i){e(i,n,t[n].arrayEntry)})}r=r||[],s=s||{};for(var d,c,f,p=m.utils.domData.get(i,n)===t,h=m.utils.domData.get(i,n)||[],g=m.utils.arrayMap(h,function(e){return e.arrayEntry}),v=m.utils.compareArrays(g,r,s.dontLimitMoves),b=[],y=0,w=0,M=[],E=[],S=[],x=[],D=[],T=0;c=v[T];T++)switch(f=c.moved,c.status){case"deleted":f===t&&(d=h[y],d.dependentObservable&&d.dependentObservable.dispose(),M.push.apply(M,m.utils.fixUpContinuousNodeArray(d.mappedNodes,i)),s.beforeRemove&&(S[T]=d,E.push(d))),y++;break;case"retained":u(T,y++);break;case"added":f!==t?u(T,f):(d={arrayEntry:c.value,indexObservable:m.observable(w++)},b.push(d),E.push(d),p||(D[T]=d))}l(s.beforeMove,x),m.utils.arrayForEach(M,s.beforeRemove?m.cleanNode:m.removeNode);for(var A,C,T=0,R=m.virtualElements.firstChild(i);d=E[T];T++){d.mappedNodes||m.utils.extend(d,e(i,a,d.arrayEntry,o,d.indexObservable));for(var N=0;C=d.mappedNodes[N];R=C.nextSibling,A=C,N++)C!==R&&m.virtualElements.insertAfter(i,C,A);!d.initialized&&o&&(o(d.arrayEntry,d.mappedNodes,d.indexObservable),d.initialized=!0)}l(s.beforeRemove,S),l(s.afterMove,x),l(s.afterAdd,D),m.utils.domData.set(i,n,b)}}(),m.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",m.utils.setDomNodeChildrenFromArrayMapping),m.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},m.nativeTemplateEngine.prototype=new m.templateEngine,m.nativeTemplateEngine.prototype.constructor=m.nativeTemplateEngine,m.nativeTemplateEngine.prototype.renderTemplateSource=function(e,t,n){var i=!(m.utils.ieVersion<9),r=i?e.nodes:null,a=r?e.nodes():null;if(a)return m.utils.makeArray(a.cloneNode(!0).childNodes);var s=e.text();return m.utils.parseHtmlFragment(s)},m.nativeTemplateEngine.instance=new m.nativeTemplateEngine,m.setTemplateEngine(m.nativeTemplateEngine.instance),m.exportSymbol("nativeTemplateEngine",m.nativeTemplateEngine),function(){m.jqueryTmplTemplateEngine=function(){function e(){if(2>n)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}function t(e,t,n){return a.tmpl(e,t,n)}var n=this.jQueryTmplVersion=function(){if(!a||!a.tmpl)return 0;try{if(a.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,r,s){s=s||{},e();var o=n.data("precompiled");if(!o){var u=n.text()||"";u="{{ko_with $item.koBindingContext}}"+u+"{{/ko_with}}",o=a.template(null,u),n.data("precompiled",o)}var l=[r.$data],d=a.extend({koBindingContext:r},s.templateOptions),c=t(o,l,d);return c.appendTo(i.createElement("div")),a.fragments={},c},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){i.write("<script type='text/html' id='"+e+"'>"+t+"</script>")},n>0&&(a.tmpl.tag.ko_code={open:"__.push($1 || '');"},a.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},m.jqueryTmplTemplateEngine.prototype=new m.templateEngine,m.jqueryTmplTemplateEngine.prototype.constructor=m.jqueryTmplTemplateEngine;var e=new m.jqueryTmplTemplateEngine;e.jQueryTmplVersion>0&&m.setTemplateEngine(e),m.exportSymbol("jqueryTmplTemplateEngine",m.jqueryTmplTemplateEngine)}()})}()}();var App=function(){this.dataTables={}};App.fn=App.prototype,App.fn.init=function(e,t,n){var i=this;t=t||document.body,u.isArray(t)||(t=[t]),this.elements=t,u.each(this.elements,function(t,r){"string"==typeof r&&(r=document.querySelector(r)),r.querySelectorAll("[u-meta]").forEach(function(t){if(!t.ucomp){var n=JSON.parse(t.getAttribute("u-meta"));if(n&&n.type){i.adjustFunc&&i.adjustFunc.call(i,n);u.compMgr.createDataAdapter({el:t,options:n,model:e,app:i})}}}),u.hotkeys&&u.hotkeys.scan(r);try{("undefined"==typeof n||1==n)&&ko.applyBindings(e,r)}catch(a){iweb.log.error(a)}}),_getDataTables(this,e)},App.fn.setAdjustMetaFunc=function(e){this.adjustFunc=e},App.fn.addDataTable=function(e){return this.dataTables[e.id]=e,this},App.fn.getDataTable=function(e){return this.dataTables[e]},App.fn.getDataTables=function(){return this.dataTables},App.fn.getComp=function(e){var t=null;return u.each(this.elements,function(n,i){"string"==typeof i&&(i=document.querySelector(i)),i.querySelectorAll("[u-meta]").forEach(function(n){if(n.ucomp){var i=n.ucomp;if(i.id===e)return t=i,!1}})}),t},App.fn.getCompsByDataTable=function(e,t){for(var n=this.getComps(t),i=[],r=0;r<n.length;r++)(n[r].dataModel&&n[r].dataModel.id==e||n[r].dataTable&&n[r].dataTable.id==e)&&i.push(n[r]);return i},App.fn.getComps=function(e){var t=e?e:this.elements,n=[];return u.isArray(t)||(t=[t]),u.each(t,function(e,t){t.querySelectorAll("[u-meta]").each(function(){if(this["u-meta"]){var e=this["u-meta"];e&&n.push(e)}})}),n},App.fn.compsValidate=function(e){for(var t=this.getComps(e),n=!0,i=0;i<t.length;i++)t[i].doValidate&&(n=t[i].doValidate(!0)&&n);return n},App.fn.getCompsByType=function(e,t){var n=t?t:this.elements,i=[];return u.isArray(n)||(n=[n]),u.each(n,function(t,n){n.querySelectorAll("[u-meta]").each(function(){if(this["u-meta"]){var t=this["u-meta"];t&&t.type==e&&i.push(t)}})}),i},App.fn.getEnvironment=function(){return window.iweb.Core.collectEnvironment()},App.fn.setClientAttribute=function(e,t){window.iweb.Core.setClientAttribute(e,t)},App.fn.getClientAttribute=function(e){return window.iweb.Core.getClientAttributes()[e]},App.fn.serverEvent=function(){return new ServerEvent(this)},App.fn.ajax=function(e){e=this._wrapAjax(e),u.ajax(e)},App.fn._wrapAjax=function(e){var t=this,n=e.success,i=e.error,r=e.deferred;return r&&r.resolve||(r={resolve:function(){},reject:function(){}}),e.success=function(e,i,a){processXHRError(t,e,i,a)?(n.call(null,e),t._successFunc(e,r)):r.reject()},e.error=function(e,n,a){processXHRError(t,e,n,a)?(i.call(null,e),t._successFunc(e,r)):r.reject()},e.data?e.data.environment=ko.utils.stringifyJson(window.iweb.Core.collectEnvironment()):e.data={environment:ko.utils.stringifyJson(window.iweb.Core.collectEnvironment())},e},App.fn._successFunc=function(e,t){t.resolve()},window.processXHRError=function(rsl,state,xhr){return"string"==typeof rsl&&(rsl=JSON.parse(rsl)),xhr.getResponseHeader&&xhr.getResponseHeader("X-Error")?(u.showMessageDialog({type:"info",title:"提示",msg:rsl.message,backdrop:!0}),rsl.operate&&eval(rsl.operate),!1):!0},App.fn.setUserCache=function(e,t){var n=this.getEnvironment().usercode;n&&localStorage.setItem(n+e,t)},App.fn.getUserCache=function(e){var t=this.getEnvironment().usercode;if(t)return localStorage.getItem(t+e)},App.fn.removeUserCache=function(e){var t=this.getEnvironment().usercode;t&&localStorage.removeItem(t+e)},App.fn.setCache=function(e,t){localStorage.setItem(e,t)},App.fn.getCache=function(e){return localStorage.getItem(e)},App.fn.removeCache=function(e){localStorage.removeItem(e)},App.fn.setSessionCache=function(e,t){sessionStorage.setItem(e,t)},App.fn.getSessionCache=function(e){return sessionStorage.getItem(e)},App.fn.removeSessionCache=function(e){sessionStorage.removeItem(e)},App.fn.setEnable=function(e){u.each(this.elements,function(t,n){n.querySelectorAll("[u-meta]").each(function(){if(this["u-meta"]){var t=this["u-meta"];t.setEnable&&t.setEnable(e)}})})};var ServerEvent=function(e){this.app=e,this.datas={},this.params={},this.event=null,this.ent=window.iweb.Core.collectEnvironment(),iweb.debugMode||(this.compression=!0)};ServerEvent.DEFAULT={async:!0,singleton:!0,url:(window.$ctx||"/iwebap")+"/evt/dispatch"},ServerEvent.fn=ServerEvent.prototype,ServerEvent.fn.addDataTable=function(e,t){var n=this.app.getDataTable(e);return this.datas[e]=n.getDataByRule(t),this},ServerEvent.fn.setCompression=function(e){iweb.browser.isIE8||window.pako||1!=e?this.compression=e:iweb.log.error("can't compression, please include  pako!")},ServerEvent.fn.addDataTables=function(e){if(2==arguments.length)for(var t=0;t<e.length;t++){var n;"string"==typeof arguments[1]?n=arguments[1]:u.isArray(arguments[1])&&(n=arguments[1][t]),this.addDataTable(e[t],n)}else for(var t=0;t<e.length;t++){var i=e[t];if("string"==typeof i)this.addDataTable(i);else for(key in i)this.addDataTable(key,i[key])}return this},ServerEvent.fn.addAllDataTables=function(e){for(var t=this.app.dataTables,n=0;n<t.length;n++)this.addDataTable(t[n].id,e)},ServerEvent.fn.addParameter=function(e,t){return this.params[e]=t,this},ServerEvent.fn.setEvent=function(e){return this.event=_formatEvent(e),this};var _formatEvent=function(e){return e};ServerEvent.fn.fire=function(e){var t=this,n=this.getData();n.parameters=ko.utils.stringifyJson(this.params);var i={type:e.type||"POST",data:e.params||{},url:e.url||ServerEvent.DEFAULT.url,async:"undefined"==typeof e.async?ServerEvent.DEFAULT.async:e.async,singleton:e.singleton||ServerEvent.DEFAULT.singleton,success:e.success,error:e.error,dataType:"json"};i.data.ctrl=e.ctrl,i.data.method=e.method,this.event&&(i.data.event=ko.utils.stringifyJson(this.event));var r=i.preSuccess||function(){},a=i.success||function(){},s=i.error;this.orignError=s;var o=i.deferred;o&&o.resolve||(o={resolve:function(){},reject:function(){}}),i.success=function(e,n,i){processXHRError(t,e,n,i)?(r.call(null,e),t._successFunc(e,o),a.call(null,e.custom),o.resolve()):o.reject()},i.error=function(e,n,i){processXHRError(t,e,n,i)?s&&s.call(null,e.custom):o.reject()},i.data=u.extend(i.data,n),u.ajax(i)},ServerEvent.fn.getData=function(){var e=ko.utils.stringifyJson(this.app.getEnvironment()),t=ko.utils.stringifyJson(this.datas),n="",i=!1;return window.trimServerEventData&&(t=window.trimServerEventData(t)),this.compression&&!iweb.browser.isIE8&&window.pako&&(e=encodeBase64(window.pako.gzip(e)),t=encodeBase64(window.pako.gzip(t)),i=!0,n="gzip"),{environment:e,dataTables:t,compression:i,compressType:n}},ServerEvent.fn._successFunc=function(e,t){"string"==typeof e&&(e=JSON.parse(e));var n=e.dataTables,i=e.dom;i&&this.updateDom(JSON.parse(i)),n&&this.updateDataTables(n,t)},ServerEvent.fn.updateDataTables=function(e,t){for(var n in e){var i=this.app.getDataTable(n);i&&(i.setData(e[n]),i.updateMeta(e[n].meta))}},ServerEvent.fn.setSuccessFunc=function(e){this._successFunc=e},ServerEvent.fn.updateDom=function(){u.each(dom,function(e,t){var n=t.two,i=t.one;_updateDom(i,n)})};var processXHRError=function(self,rsl,state,xhr){if("string"==typeof rsl&&(rsl=JSON.parse(rsl)),xhr.getResponseHeader&&xhr.getResponseHeader("X-Error")){if(!self.orignError)return u.showMessageDialog?u.showMessageDialog({type:"info",title:"提示",msg:rsl.message,backdrop:!0}):alert(rsl.message),rsl.operate&&eval(rsl.operate),!1;self.orignError.call(self,rsl,state,xhr)}return!0};u.createApp=function(){var e=new App;if(arguments.length>0){var t=arguments[0];e.init(t.model,t.el)}return e};var _getDataTables=function(e,t){for(var n in t)t[n]instanceof u.DataTable&&(t[n].id=n,t[n].parent=t,e.addDataTable(t[n]))},Events=function(){};Events.fn=Events.prototype,Events.fn.on=function(e,t){e=e.toLowerCase(),this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t}),this},Events.fn.trigger=function(e){if(e=e.toLowerCase(),!this._events||!this._events[e])return this;for(var t=Array.prototype.slice.call(arguments,1),n=this._events[e],i=0,r=n.length;r>i;i++)n[i].callback.apply(this,t);return this},Events.fn.getEvent=function(e){return e=e.toLowerCase(),this._events||(this._events={}),this._events[e]};var DataTable=function(e){this.id=e.id,this.meta=DataTable.createMetaItems(e.meta),this.enable=e.enable||DataTable.DEFAULTS.enable,this.pageSize=ko.observable(e.pageSize||DataTable.DEFAULTS.pageSize),this.pageIndex=ko.observable(e.pageIndex||DataTable.DEFAULTS.pageIndex),this.totalPages=ko.observable(e.totalPages||DataTable.DEFAULTS.totalPages),this.totalRow=ko.observable(),this.pageCache=void 0===e.pageCache?DataTable.DEFAULTS.pageCache:e.pageCache,this.rows=ko.observableArray([]),this.selectedIndices=ko.observableArray([]),this._oldCurrentIndex=-1,this.focusIndex=-1,this.cachedPages=[],this.createDefaultEvents(),this.metaChange={},this.valueChange=ko.observable(1),this.enableChange=ko.observable(1),this.params=e.params||{},this.master=e.master||""};DataTable.fn=DataTable.prototype=new Events,DataTable.DEFAULTS={pageSize:20,pageIndex:0,totalPages:20,pageCache:!1,enable:!0},DataTable.META_DEFAULTS={enable:!0,required:!1,descs:{}},DataTable.createMetaItems=function(e){var t={};for(var n in e){var i=e[n];"string"==typeof i&&(i={}),t[n]=u.extend({},DataTable.META_DEFAULTS,i)}return t},DataTable.ON_ROW_SELECT="select",DataTable.ON_ROW_UNSELECT="unSelect",DataTable.ON_ROW_ALLSELECT="allSelect",DataTable.ON_ROW_ALLUNSELECT="allUnselect",DataTable.ON_VALUE_CHANGE="valueChange",DataTable.ON_CURRENT_VALUE_CHANGE="currentValueChange",DataTable.ON_INSERT="insert",DataTable.ON_UPDATE="update",DataTable.ON_CURRENT_UPDATE="currentUpdate",DataTable.ON_DELETE="delete",DataTable.ON_DELETE_ALL="deleteAll",DataTable.ON_ROW_FOCUS="focus",DataTable.ON_ROW_UNFOCUS="unFocus",DataTable.ON_LOAD="load",DataTable.ON_ENABLE_CHANGE="enableChange",DataTable.ON_META_CHANGE="metaChange",DataTable.ON_ROW_META_CHANGE="rowMetaChange",DataTable.ON_CURRENT_META_CHANGE="currentMetaChange",DataTable.ON_CURRENT_ROW_CHANGE="currentRowChange",DataTable.SUBMIT={current:"current",focus:"focus",all:"all",select:"select",change:"change",empty:"empty",allSelect:"allSelect",allPages:"allPages"},DataTable.fn.createDefaultEvents=function(){},DataTable.fn.addParam=function(e,t){this.params[e]=t},DataTable.fn.addParams=function(e){for(var t in e)this.params[t]=e[t]},DataTable.fn.getParam=function(e){return this.params[e]},DataTable.fn.getMeta=function(e,t){return 0==arguments.length?this.meta:this.meta[e][t]},DataTable.fn.setMeta=function(e,t,n){
var i=this.meta[e][t],r=this.getCurrentRow();this.meta[e][t]=n,this.metaChange[e+"."+t]&&this.metaChange[e+"."+t](-this.metaChange[e+"."+t]()),"enable"==t&&this.enableChange(-this.enableChange()),this.trigger(DataTable.ON_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.id,field:e,meta:t,oldValue:i,newValue:n}),r&&!r.getMeta(e,t,!1)&&this.trigger(e+"."+t+"."+DataTable.ON_CURRENT_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.id,oldValue:i,newValue:n})},DataTable.fn.setCurrentPage=function(e,t){e!=this.pageIndex()&&1!=t&&this.cacheCurrentPage(),this.pageIndex(e);var n=this.cachedPages[this.pageIndex()];n&&(this.removeAllRows(),this.setRows(n.rows),this.setRowsSelect(n.selectedIndcies))},DataTable.fn.isChanged=function(){for(var e=this.getAllRows(),t=0;t<e.length;t++)if(e[t].status!=Row.STATUS.NORMAL)return!0;return!1},DataTable.fn.updateMeta=function(e){if(e)for(var t in e)for(var n in e[t]){var i=this.meta[t][n],r=e[t][n];"default"===n?(this.meta[t]["default"]||(this.meta[t]["default"]={}),this.meta[t]["default"].value=e[t][n]):"display"===n?(this.meta[t]["default"]||(this.meta[t]["default"]={}),this.meta[t]["default"].display=e[t][n]):this.meta[t][n]=e[t][n],this.metaChange[t+"."+n]&&this.metaChange[t+"."+n](-this.metaChange[t+"."+n]()),this.trigger(DataTable.ON_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.id,field:t,meta:n,oldValue:i,newValue:r})}},DataTable.fn.setData=function(e){var t,n,i=e.pageIndex,r=e.pageSize||this.pageSize(),a=e.totalPages||this.totalPages(),s=e.totalRow;e.type;if(this.pageCache=e.pageCache||this.pageCache,this.pageCache===!0){if(this.updatePages(e.pages),i!=this.pageIndex())return this.setCurrentPage(i,!0),this.totalPages(a),void this.totalRow(s);t=this.getPage(i).selectedIndices,n=this.getPage(i).focus,this.setRows(this.getPage(i).rows)}else t=e.select,n=e.focus,this.setRows(e.rows);this.pageIndex(i),this.pageSize(r),this.totalPages(a),this.totalRow(s),this.updateSelectedIndices(),t&&t.length>0&&this.rows().length>0&&this.setRowsSelect(t),n&&this.setRowFocus(n)},DataTable.fn.clear=function(){this.removeAllRows(),this.cachedPages=[],this.totalPages(1),this.pageIndex(0),this.focusIndex=-1,this.selectedIndices([])},DataTable.fn.updatePages=function(e){var t,n,i,t,r,a,s,o,u,l,d,i;this.pageSize();for(a=0;a<e.length;a++)if(r=e[a].index,s=e[a].rows,o=e[a].current,u=e[a].select,l=e[a].status,"del"!==l){if(this.cachedPages[r]){r==this.pageIndex()&&this.cacheCurrentPage(),t=this.cachedPages[r];for(var d=0;d<s.length;d++)n=s[d],n.id||(n.id=Row.getRandomRowId()),n.status==Row.STATUS.DELETE?this.removeRowByRowId(n.id):(i=t.getRowByRowId(n.id),i?t.updateRow(i,n):(n.rowId=n.id,delete n.id,t.rows.push(n)))}else{t=new Page({parent:this}),t.rows=s;for(var d=0;d<t.rows.length;d++)t.rows[d].rowId=t.rows[d].id,delete t.rows[d].id;this.cachedPages[r]=t}t.selectedIndices=u,t.focus=o}else this.cachedPages[r]=null},DataTable.fn.setRows=function(e){for(var t,n=[],i=0;i<e.length;i++){var r=e[i];if(t=r.rowId||r.id,t||(t=Row.getRandomRowId()),r.status==Row.STATUS.DELETE)this.removeRowByRowId(t);else{var a=this.getRowByRowId(t);a?(a.updateRow(r),u.isEmptyObject(r.data)||(this.trigger(DataTable.ON_UPDATE,{index:i,rows:[a]}),a==this.getCurrentRow()?(this.valueChange(-this.valueChange()),a.valueChange(-a.valueChange()),this.trigger(DataTable.ON_CURRENT_UPDATE,{index:i,rows:[a]})):a.valueChange(-a.valueChange()))):(a=new Row({parent:this,id:t}),a.setData(e[i]),n.push(a))}}n.length>0&&this.addRows(n)},DataTable.fn.clearCache=function(){this.cachedPages=[]},DataTable.fn.cacheCurrentPage=function(){if(this.pageCache&&this.pageIndex()>-1){var e=new Page({parent:this});e.focus=this.getFocusIndex(),e.selectedIndices=this.selectedIndices().slice();for(var t=this.rows().slice(),n=0;n<t.length;n++){var i=t[n].getData();i.rowId=i.id,delete i.id,e.rows.push(i)}this.cachedPages[this.pageIndex()]=e}},DataTable.fn.setPages=function(e){var t,n=this.pageSize(),i=0;this.cachedPages=[];for(var r=0;r<e.length;r++)i=Math.floor(r/n),this.cachedPages[i]||(t=new Page({parent:this}),this.cachedPages[i]=t),t.rows.push(e[r]);this.pageIndex()>-1&&this.setCurrentPage(this.pageIndex()),this.totalRow(e.length),this.totalPages(i+1)},DataTable.fn.hasPage=function(e){return this.pageCache&&this.cachedPages[e]?!0:!1},DataTable.fn.getPage=function(e){return this.pageCache?this.cachedPages[e]:-1},DataTable.fn.getPages=function(){return this.pageCache?this.cachedPages:[]},DataTable.fn.copyRow=function(e,t){var n=new Row({parent:this});t&&n.setData(t.getData()),this.insertRows(void 0===e?this.rows().length:e,[n])},DataTable.fn.addRow=function(e){this.insertRow(this.rows().length,e)},DataTable.fn.addRows=function(e){this.insertRows(this.rows().length,e)},DataTable.fn.insertRow=function(e,t){t||(t=new Row({parent:this})),this.insertRows(e,[t])},DataTable.fn.insertRows=function(e,t){for(var n=[e,0],i=0;i<t.length;i++)n.push(t[i]);this.rows.splice.apply(this.rows,n),this.updateSelectedIndices(e,"+",t.length),this.updateFocusIndex(e,"+",t.length),this.trigger(DataTable.ON_INSERT,{index:e,rows:t})},DataTable.fn.createEmptyRow=function(){var e=new Row({parent:this});return this.addRow(e),e},DataTable.fn.removeRowByRowId=function(e){var t=this.getIndexByRowId(e);-1!=t&&this.removeRow(t)},DataTable.fn.removeRow=function(e){e instanceof Row&&(e=this.getIndexByRowId(e.rowId)),this.removeRows([e])},DataTable.fn.removeAllRows=function(){this.rows([]),this.selectedIndices([]),this.focusIndex=-1,this.trigger(DataTable.ON_DELETE_ALL),this.updateCurrIndex()},DataTable.fn.removeRows=function(e){e=this._formatToIndicesArray(e),e=e.sort();for(var t=[],n=this.rows(),i=[],r=e.length-1;r>=0;r--){var a=e[r],s=n[a];if(null!=s){t.push(s.rowId);var o=n.splice(a,1);i.push(o[0]),this.updateSelectedIndices(a,"-"),this.updateFocusIndex(a,"-")}}this.rows(n),this.deleteRows=i,this.trigger(DataTable.ON_DELETE,{indices:e,rowIds:t,deleteRows:i}),this.updateCurrIndex()},DataTable.fn.setRowDelete=function(e){e instanceof Row&&(e=this.getIndexByRowId(e.rowId)),this.setRowDelete([e])},DataTable.fn.setAllRowsDelete=function(){for(var e=new Array(this.rows().length),t=0;t<e.length;t++)e[t]=t;this.setRowsDelete(e)},DataTable.fn.setRowsDelete=function(e){e=this._formatToIndicesArray(e);for(var t=0;t<e.length;t++){var n=this.getRow(e[t]);n.status==Row.STATUS.NEW?(this.rows(this.rows().splice(e[t],1)),this.updateSelectedIndices(e[t],"-"),this.updateFocusIndex(index,"-")):n.status=Row.STATUS.FALSE_DELETE}var i=this.getRowIdsByIndices(e);this.trigger(DataTable.ON_ROW_DELETE,{falseDelete:!0,indices:e,rowIds:i})},DataTable.fn.setAllRowsSelect=function(){for(var e=new Array(this.rows().length),t=0;t<e.length;t++)e[t]=t;this.setRowsSelect(e),this.trigger(DataTable.ON_ROW_ALLSELECT,{})},DataTable.fn.setRowSelect=function(e){e instanceof Row&&(e=this.getIndexByRowId(e.rowId)),this.setRowsSelect([e]),this.setRowFocus(this.getSelectedIndex())},DataTable.fn.setRowsSelect=function(e){if(e=e||-1,-1==e)return void this.setAllRowsUnSelect({quiet:!0});e=this._formatToIndicesArray(e);var t=this.selectedIndices();if(!u.isArray(e)||!u.isArray(t)||e.join()!=t.join()){this.setAllRowsUnSelect({quiet:!0}),this.selectedIndices(e);var n=this.getRowIdsByIndices(e);this.valueChange(-this.valueChange()),this.trigger(DataTable.ON_ROW_SELECT,{indices:e,rowIds:n}),this.updateCurrIndex()}},DataTable.fn.addRowsSelect=function(e){e=this._formatToIndicesArray(e);for(var t=this.selectedIndices().slice(),n=0;n<e.length;n++){for(var i=e[n],r=!0,a=0;a<t.length;a++)t[a]==i&&(r=!1);r&&t.push(e[n])}this.selectedIndices(t);var s=this.getRowIdsByIndices(e);this.trigger(DataTable.ON_ROW_SELECT,{indices:e,rowIds:s}),this.updateCurrIndex()},DataTable.fn.getRowIdsByIndices=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.getRow(e[n]).rowId);return t},DataTable.fn.setAllRowsUnSelect=function(e){this.selectedIndices([]),e&&e.quiet||this.trigger(DataTable.ON_ROW_ALLUNSELECT),this.updateCurrIndex()},DataTable.fn.setRowUnSelect=function(e){this.setRowsUnSelect([e])},DataTable.fn.setRowsUnSelect=function(e){e=this._formatToIndicesArray(e);var t=this.selectedIndices().slice();if(-1!=t.indexOf(e[0])){for(var n=0;n<e.length;n++){var i=e[n],r=t.indexOf(i);-1!=r&&t.splice(r,1)}this.selectedIndices(t);var a=this.getRowIdsByIndices(e);this.trigger(DataTable.ON_ROW_UNSELECT,{indices:e,rowIds:a}),this.updateCurrIndex()}},DataTable.fn.updateSelectedIndices=function(e,t,n){u.isNumber(n)||(n=1);var i=this.selectedIndices().slice();if(null!=i&&0!=i.length){for(var r=0,a=i.length;a>r;r++)"+"==t?i[r]>=e&&(i[r]=parseInt(i[r])+n):"-"==t&&(i[r]>=e&&i[r]<=e+n-1?i.splice(r,1):i[r]>e+n-1&&(i[r]=i[r]-n));this.selectedIndices(i)}},DataTable.fn.updateFocusIndex=function(e,t,n){u.isNumber(n)||(n=1),e<=this.focusIndex&&-1!=this.focusIndex&&("+"===t?this.focusIndex+=n:"-"===t&&(this.focusIndex>=e&&this.focusIndex<=e+n-1?this.focusIndex=-1:this.focusIndex>e+n-1&&(this.focusIndex-=n)))},DataTable.fn.getSelectedIndex=function(){var e=this.selectedIndices();return null==e||0==e.length?-1:e[0]},DataTable.fn.getSelectedIndexs=function(){var e=this.selectedIndices();return null==e||0==e.length?[]:e},DataTable.fn.getFocusIndex=function(){return this.focusIndex},DataTable.fn.getIndexByRowId=function(e){for(var t=this.rows(),n=0,i=t.length;i>n;n++)if(t[n].rowId==e)return n;return-1},DataTable.fn.getAllDatas=function(){for(var e=this.getAllRows(),t=[],n=0,i=e.length;i>n;n++)e[n]&&t.push(e[n].getData());return t},DataTable.fn.getData=function(){for(var e=[],t=this.rows(),n=0;n<t.length;n++)e.push(t[n].getData());return e},DataTable.fn.getDataByRule=function(e){var t,n={},i=null;if(n.meta=this.meta,n.params=this.params,e=e||DataTable.SUBMIT.current,e==DataTable.SUBMIT.current){i=[];var r=this.focusIndex;-1==r&&(r=this.getSelectedIndex()),t=this.rows();for(var a=0,s=t.length;s>a;a++)a==r?i.push(t[a].getData()):i.push(t[a].getEmptyData())}else if(e==DataTable.SUBMIT.focus){i=[],t=this.rows();for(var a=0,s=t.length;s>a;a++)a==this.focusIndex?i.push(t[a].getData()):i.push(t[a].getEmptyData())}else e==DataTable.SUBMIT.all?i=this.getData():e==DataTable.SUBMIT.select?i=this.getSelectedDatas(!0):e==DataTable.SUBMIT.change?i=this.getChangedDatas():e===DataTable.SUBMIT.empty&&(i=[]);if(this.pageCache&&null!=i&&(i=[{index:this.pageIndex(),select:this.getSelectedIndexs(),focus:this.focusIndex,rows:i}]),e==DataTable.SUBMIT.allSelect){i=[];for(var o=this.totalPages(),a=0;o>a;a++)if(a==this.pageIndex())i.push({index:this.pageIndex(),select:this.getSelectedIndexs(),focus:this.focusIndex,rows:this.getSelectedDatas()});else{var u=this.cachedPages[a];u&&i.push({index:a,select:u.selectedIndices,focus:u.focus,rows:u.getSelectDatas()})}}else if(e==DataTable.SUBMIT.allPages){i=[];for(var o=this.totalPages(),a=0;o>a;a++)if(a==this.pageIndex())i.push({index:this.pageIndex(),select:this.getSelectedIndexs(),focus:this.focusIndex,rows:this.getData()});else{var u=this.cachedPages[a];u&&i.push({index:a,select:u.selectedIndices,focus:u.focus,rows:u.getData()})}}return this.pageCache?n.pages=i:(n.rows=i,n.select=this.getSelectedIndexs(),n.focus=this.getFocusIndex()),n.pageSize=this.pageSize(),n.pageIndex=this.pageIndex(),n.isChanged=this.isChanged(),n.master=this.master,n.pageCache=this.pageCache,n},DataTable.fn.getSelectedDatas=function(e){for(var t=this.selectedIndices(),n=[],i=[],r=0,a=t.length;a>r;r++)i.push(t[r]);for(var s=this.rows(),r=0,a=s.length;a>r;r++)-1!=i.indexOf(r)?n.push(s[r].getData()):1==e&&n.push(s[r].getEmptyData());return n},DataTable.fn.refSelectedRows=function(){return ko.pureComputed({read:function(){for(var e=this.selectedIndices()||[],t=this.rows(),n=[],i=0;i<e.length;i++)n.push(t[i]);return n},owner:this})},DataTable.fn.ref=function(e){return ko.pureComputed({read:function(){this.valueChange();var t=this.getCurrentRow();return t?t.getValue(e):""},write:function(t){var n=this.getCurrentRow();n&&n.setValue(e,t)},owner:this})},DataTable.fn.refMeta=function(e,t){return this.metaChange[e+"."+t]||(this.metaChange[e+"."+t]=ko.observable(1)),ko.pureComputed({read:function(){return this.metaChange[e+"."+t](),this.getMeta(e,t)},write:function(n){this.setMeta(e,t,n)},owner:this})},DataTable.fn.refRowMeta=function(e,t){return this.metaChange[e+"."+t]||(this.metaChange[e+"."+t]=ko.observable(1)),ko.pureComputed({read:function(){this.metaChange[e+"."+t]();var n=this.getCurrentRow();return n?n.getMeta(e,t):this.getMeta(e,t)},write:function(t){var n=this.getCurrentRow();n&&n.setMeta(e,t)},owner:this})},DataTable.fn.getRowMeta=function(e,t){var n=this.getCurrentRow();return n?n.getMeta(e,t):this.getMeta(e,t)},DataTable.fn.refEnable=function(e){return ko.pureComputed({read:function(){if(this.enableChange(),!e)return this.enable;var t=this.getMeta(e,"enable");return("undefined"==typeof t||null==t)&&(t=!0),t&&this.enable},owner:this})},DataTable.fn.isEnable=function(e){var t=this.getMeta(e,"enable");return("undefined"==typeof t||null==t)&&(t=!0),t&&this.enable},DataTable.fn.getValue=function(e,t){return t=t||this.getCurrentRow(),t?t.getValue(e):""},DataTable.fn.setValue=function(e,t,n,i){n=n?n:this.getCurrentRow(),n&&n.setValue(e,t,i)},DataTable.fn.setEnable=function(e){this.enable!=e&&(this.enable=e,this.enableChange(-this.enableChange()),this.trigger(DataTable.ON_ENABLE_CHANGE,{enable:this.enable}))},DataTable.fn.getCurrentRow=function(){if(-1!=this.focusIndex)return this.getFocusRow();var e=this.getSelectedIndex();return-1==e?null:this.getRow(e)},DataTable.fn.updateCurrIndex=function(){var e=-1!=this.focusIndex?this.focusIndex:this.getSelectedIndex();this._oldCurrentIndex!=e&&(this._oldCurrentIndex=e,this.trigger(DataTable.ON_CURRENT_ROW_CHANGE))},DataTable.fn.getFocusRow=function(){return-1!=this.focusIndex?this.getRow(this.focusIndex):null},DataTable.fn.setRowFocus=function(e,t,n){var i=null;e instanceof Row&&(e=this.getIndexByRowId(e.rowId),i=e.rowId),-1===e||e===this.focusIndex&&!n||(this.focusIndex=e,t||(this.valueChange(-this.valueChange()),i||(i=this.getRow(e).rowId),this.trigger(DataTable.ON_ROW_FOCUS,{index:e,rowId:i}),this.updateCurrIndex()))},DataTable.fn.setRowUnFocus=function(){this.valueChange(-this.valueChange());var e=this.focusIndex,t=null;-1!==e&&(t=this.getRow(e).rowId),this.trigger(DataTable.ON_ROW_UNFOCUS,{index:e,rowId:t}),this.focusIndex=-1,this.updateCurrIndex()},DataTable.fn.getRow=function(e){return this.rows.peek()[e]},DataTable.fn.getAllRows=function(){return this.rows()},DataTable.fn.getAllPageRows=function(){for(var e,t=[],n=0;n<this.totalPages();n++){if(e=[],n==this.pageIndex())e=this.getData();else{var i=this.cachedPages[n];i&&(e=i.getData())}for(var r=0;r<e.length;r++)t.push(e[r])}return t},DataTable.fn.getRowByRowId=function(e){for(var t=this.rows(),n=0,i=t.length;i>n;n++)if(t[n].rowId==e)return t[n];return null},DataTable.fn.getChangedDatas=function(e){for(var t=[],n=this.rows(),i=0,r=n.length;r>i;i++)n[i]&&n[i].status!=Row.STATUS.NORMAL?t.push(n[i].getData()):1==e&&t.push(n[i].getEmptyData());return t},DataTable.fn._formatToIndicesArray=function(e){if("string"==typeof e||"number"==typeof e)e=[e];else if(e instanceof Row)e=this.getIndexByRowId(e.rowId);else if(u.isArray(e)&&e.length>0&&e[0]instanceof Row)for(var t=0;t<e.length;t++)e[t]=this.getIndexByRowId(e[t].rowId);return e};var Page=function(e){this.focus=e.focus||null,this.selectedIndices=e.selectedIndices||null,this.rows=e.rows||[],this.parent=e.parent||null};Page.fn=Page.prototype,Page.fn.getData=function(){var e,t,n=[];t=this.parent.getMeta();for(var i=0;i<this.rows.length;i++)e=this.rows[i],n.push({id:e.rowId,status:e.status,data:e.data});return n},Page.fn.getSelectDatas=function(){for(var e,t=[],n=0;n<this.rows.length;n++)e=this.rows[n],t.push({id:e.rowId,status:e.status,data:e.data});for(var n=0;n<this.selectedIndices.length;n++)e=this.rows[this.selectedIndices[n]],t.push({id:e.rowId,status:e.status,data:e.data});return t},Page.fn.getRowByRowId=function(e){for(var t=0,n=this.rows.length;n>t;t++)if(this.rows.rowId==e)return this.rows[t];return null},Page.fn.removeRowByRowId=function(e){for(var t=0,n=this.rows.length;n>t;t++)this.rows.rowId==e&&this.rows.splice(t,1)},Page.fn.getSelectRows=function(){for(var e=[],t=0;t<this.selectedIndices.length;t++)e.push(this.rows[this.selectedIndices[t]]);return e},Page.fn.getRowByRowId=function(e){for(var t=0,n=this.rows.length;n>t;t++)if(this.rows[t].rowId==e)return this.rows[t];return null},Page.fn.setRowValue=function(e,t,n){var i=this.rows[e];i&&(i.data[t].value=n,i.status!=Row.STATUS.NEW&&(i.status=Row.STATUS.UPDATE))},Page.fn.getRowValue=function(e,t){var n=this.rows[e];return n?n.data[t].value:null},Page.fn.setRowMeta=function(e,t,n,i){var r=this.rows[e];if(r){var a=r[t].meta;a||(a=r[t].meta={}),a[n]=i,r.status!=Row.STATUS.NEW&&(r.status=Row.STATUS.UPDATE)}},Page.fn.getRowMeta=function(e,t,n){var i=this.rows[e];if(i){var r=i[t].meta;return r?r[n]:null}return null},Page.fn.updateRow=function(e,t){if(e.status=e.status,t.data)for(var n in t.data)if(e.data[n]){var i=t.data[n];if("string"==typeof i||"number"==typeof i||null===i)e.data[n].value=i;else if(i.error)u.showMessageDialog({title:"警告",msg:i.error,backdrop:!0});else{e.data[n].value=i.value;for(var r in i.meta)e.data[n].meta=e.data[n].meta||{},e.data[n].meta[r]=i.meta[r]}}};var Row=function(e){this.rowId=e.id||Row.getRandomRowId(),this.status=Row.STATUS.NEW,this.parent=e.parent,this.initValue=null,this.data={},this.metaChange={},this.valueChange=ko.observable(1),this.init()};Row.STATUS={NORMAL:"nrm",UPDATE:"upd",NEW:"new",DELETE:"del",FALSE_DELETE:"fdel"},Row.fn=Row.prototype=new Events,Row.fn.init=function(){var e=this.parent.meta;for(var t in e)if(this.data[t]={},e[t]["default"]){var n=e[t]["default"];for(var i in n)"value"==i?this.data[t].value=n[i]:(this.data[t].meta=this.data[t].meta||{},this.data[t].meta[i]=n[i])}},Row.fn.ref=function(e){return ko.pureComputed({read:function(){return this.valueChange(),this._getField(e).value},write:function(t){this.setValue(e,t)},owner:this})},Row.fn.refMeta=function(e,t){return this.metaChange[e+"."+t]||(this.metaChange[e+"."+t]=ko.observable(1)),ko.pureComputed({read:function(){return this.metaChange[e+"."+t](),this.getMeta(e,t)},write:function(n){this.setMeta(e,t,n)},owner:this})},Row.fn.refCombo=function(e,t){return ko.pureComputed({read:function(){this.valueChange();var n=u.getJSObject(this.parent.parent,t);if(void 0===this._getField(e).value||""===this._getField(e).value)return"";for(var i=this._getField(e).value,r="string"==typeof i?i.split(","):[i],a=[],s=0,o=n.length;o>s;s++)for(var l=0;l<r.length;l++)n[s].pk==r[l]&&a.push(n[s].name);return a.toString()},write:function(t){this.setValue(e,t)},owner:this})},Row.fn.refDate=function(e,t){return ko.pureComputed({read:function(){if(this.valueChange(),!this._getField(e).value)return"";var n=this._getField(e).value;return n?n=moment(n).format(t):""},write:function(t){this.setValue(e,t)},owner:this})},Row.fn.getValue=function(e){return this._getField(e).value};var eq=function(e,t){return null!==e&&void 0!==e&&""!==e||null!==t&&void 0!==t&&""!==t?u.isNumber(e)&&u.isNumber(t)&&parseFloat(e)==parseFloat(t)?!0:e+""==t+""?!0:!1:!0};Row.fn.setValue=function(e,t,n,i){var r=this.getValue(e)||"";if(!eq(r,t)){this._getField(e).value=t,this._getField(e).changed=!0,this.status!=Row.STATUS.NEW&&(this.status=Row.STATUS.UPDATE),this.valueChange(-this.valueChange()),this.parent.getCurrentRow()==this&&this.parent.valueChange(-this.parent.valueChange());var a={eventType:"dataTableEvent",dataTable:this.parent.id,rowId:this.rowId,field:e,oldValue:r,newValue:t,ctx:n||""};this.parent.trigger(DataTable.ON_VALUE_CHANGE,a),this.parent.trigger(e+"."+DataTable.ON_VALUE_CHANGE,a),this==this.parent.getCurrentRow()&&this.parent.trigger(e+"."+DataTable.ON_CURRENT_VALUE_CHANGE,a)}},Row.fn.getMeta=function(e,t,n){if(0==arguments.length){var i={};for(var r in this.data)i[r]=this.data[r].meta?this.data[r].meta:{};return i}var a=this._getField(e).meta;return a&&void 0!==a[t]&&null!==a[t]&&""!==a[t]?a[t]:"undefined"==typeof n||0!=n?this.parent.getMeta(e,t):void 0},Row.fn.setMeta=function(e,t,n){var i=this._getField(e).meta;i||(i=this._getField(e).meta={});var r=i[t];eq(r,n)||(i[t]=n,this.metaChange[e+"."+t]&&this.metaChange[e+"."+t](-this.metaChange[e+"."+t]()),"enable"==t&&this.parent.enableChange(-this.parent.enableChange()),this.parent.getCurrentRow()==this&&(this.parent.metaChange[e+"."+t]&&this.parent.metaChange[e+"."+t](-this.parent.metaChange[e+"."+t]()),this.parent.trigger(e+"."+t+"."+DataTable.ON_CURRENT_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.parent.id,oldValue:r,newValue:n})),this.parent.trigger(DataTable.ON_ROW_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.parent.id,field:e,meta:t,oldValue:r,newValue:n,row:this}),this.parent.trigger(e+"."+t+"."+DataTable.ON_ROW_META_CHANGE,{eventType:"dataTableEvent",dataTable:this.parent.id,field:e,meta:t,oldValue:r,newValue:n,row:this}))},Row.fn.setData=function(e){this.status=e.status;for(var t in e.data)if(this.data[t]){var n=e.data[t];if("string"==typeof n||"number"==typeof n||null===n)this.data[t].value=this.formatValue(t,n);else if(n.error)u.showMessageDialog({title:"警告",msg:n.error,backdrop:!0});else{this.data[t].value=this.formatValue(t,n.value);for(var i in n.meta)this.setMeta(t,i,n.meta[i])}}},Row.fn.formatValue=function(e,t){var n=this.parent.getMeta(e,"type");return n&&("date"==n||"datetime"==n)?_formatDate(t):t},Row.fn.updateRow=function(e){this.setData(e)},Row.fn.getData=function(){var e=ko.toJS(this.data),t=this.parent.getMeta();for(var n in t)t[n]&&t[n].type&&("date"==t[n].type||"datetime"==t[n].type)&&(e[n].value=_dateToUTCString(e[n].value));return{id:this.rowId,status:this.status,data:e}},Row.fn.getEmptyData=function(){return{id:this.rowId,status:this.status,data:{}}},Row.fn._getField=function(e){var t=this.data[e];if(!t)throw new Error("field:"+e+" not exist in dataTable:"+this.parent.id+"!");return t},Row.getRandomRowId=function(){return setTimeout(function(){})+""};var _formatDate=function(e){if(!e)return e;var t=new Date;t.setTime(e);var n=t.getFullYear(),i=t.getMonth()+1;parseInt(i)<10&&(i="0"+i);var r=t.getDate();parseInt(r)<10&&(r="0"+r);var a=t.getHours();parseInt(a)<10&&(a="0"+a);var s=t.getMinutes();parseInt(s)<10&&(s="0"+s);var o=t.getSeconds();parseInt(o)<10&&(o="0"+o);var u=t.getMilliseconds(),l=n+"-"+i+"-"+r+" "+a+":"+s+":"+o+"."+u;return l},_dateToUTCString=function(e){if(!e)return"";e.indexOf("-")>-1&&(e=e.replace(/\-/g,"/"));var t=Date.parse(e);return isNaN(t)?"":t};u.Row=Row,u.DataTable=DataTable,u.BaseAdapter=u.Class.create({initialize:function(e){this.element=e.el,this.options=e.options,this.viewModel=e.model,this.dataModel=null,this.parseDataModel()},parseDataModel:function(){this.options&&this.options.data&&(this.dataModel=u.getJSObject(this.viewModel,this.options.data),this.dataModel instanceof u.DataTable&&(this.field=this.options.field))}}),u.InputAdapter=u.BaseAdapter.extend({initialize:function(e){u.InputAdapter.superclass.initialize.apply(this,arguments),this.element="INPUT"===this.element.nodeName?this.element:this.element.querySelector("input"),this.required=e.required,this.maxLength=null,this.minLength=null,this.max=null,this.min=null,this.regExp=null,this.placement=e.placement},create:function(){var e=this;this.dataModel.on(this.field+"."+u.DataTable.ON_CURRENT_VALUE_CHANGE,function(t){e.modelValueChange(t.newValue)}),this.dataModel.on(u.DataTable.ON_ENABLE_CHANGE,function(t){if(t.enable===!0){var n=e.dataModel.getRowMeta(e.field,"enable");n===!0&&e.setEnable(n)}else e.setEnable(t.enable)}),this.dataModel.on(this.field+".enable."+u.DataTable.ON_CURRENT_META_CHANGE,function(t){e.setEnable(t.newValue)}),this.dataModel.on(this.field+".enable."+u.DataTable.ON_ROW_META_CHANGE,function(t){e.setEnable(t.newValue)}),this.dataModel.on(this.field+".required."+u.DataTable.ON_CURRENT_META_CHANGE,function(t){e.setRequired(t.newValue)}),this.dataModel.on(this.field+".regExp."+u.DataTable.ON_CURRENT_META_CHANGE,function(t){e.regExp=t.newValue}),this.dataModel.on(u.DataTable.ON_CURRENT_ROW_CHANGE,function(){var t=e.dataModel.getCurrentRow();if(t){if(e.modelValueChange(t.getValue(e.field)),this.enable===!0){var n=t.getMeta(e.field,"enable");(n===!0||"true"===n||n===!1||"false"===n)&&e.setEnable(n)}else e.setEnable(this.enable);e.setRequired(t.getMeta(e.field,"required"))}else e.modelValueChange(""),e.setEnable(!1)}),this.dataModel.on(u.DataTable.ON_CURRENT_UPDATE,function(t){var n=t.rows[0];e.modelValueChange(n.getValue(e.field))}),this.setEnable(this.dataModel.isEnable(this.field)),this.setRequired(this.dataModel.getMeta(this.field,"required")),this.regExp=this.dataModel.getMeta(this.field,"regExp"),this.modelValueChange(this.dataModel.getValue(this.field)),"INPUT"!=this.element.nodeName||this.element.getAttribute("type")&&"text"!=this.element.getAttribute("type")||(u.on(this.element,"focus",function(t){e.onFocusin?e.onFocusin(t):e.setShowValue(e.getValue())}),u.on(this.element,"blur",function(t){!e.doValidate()&&e._needClean()?!e.doValidate()&&e._needClean()&&(!e.required||null!==e.element.value&&void 0!==e.element.value&&""!==e.element.value?e.element.value=e.getShowValue():e.setValue("")):e.setValue(e.element.value)}))},modelValueChange:function(e){},setModelValue:function(e){this.dataModel&&this.dataModel.setValue(this.field,e)},setValue:function(e){},getValue:function(){return this.trueValue},setShowValue:function(e){this.showValue=e,this.element.value=e,this.element.title=e},getShowValue:function(){return this.showValue},setEnable:function(e){this.element.getAttribute("id");e===!0||"true"===e?(this.enable=!0,this.element.removeAttribute("readonly")):(e===!1||"false"===e)&&(this.enable=!1,this.element.setAttribute("readonly","readonly"))},setRequired:function(e){e===!0||"true"===e?this.required=!0:(e===!1||"false"===e)&&(this.required=!1)},doValidate:function(e){return this.validate?e?this.validate.check(this.getValue()):this.validate.check():!0},_needClean:function(){return this.validate?this.validate._needClean():!1}}),u.FloatAdapter=u.InputAdapter.extend({initialize:function(e){u.FloatAdapter.superclass.initialize.apply(this,arguments);var t=this;this.maskerMeta=u.core.getMaskerMeta("float")||{},this.maskerMeta.precision=e.precision||this.maskerMeta.precision,this.validType="float",this.max=e.max?e.max:"10000000000000000000",this.min=e.min?e.min:"-10000000000000000000",this.maxLength=e.maxLength?e.maxLength:25,this.minLength=e.mixLength?e.mixLength:0,this.maxNotEq=e.maxNotEq,this.minNotEq=e.minNotEq,this.dataModel&&(this.dataModel.on(this.field+".precision."+u.DataTable.ON_CURRENT_META_CHANGE,function(e){void 0!==e.newValue&&t.setPrecision(e.newValue)}),this.dataModel.on(this.field+".precision."+u.DataTable.ON_ROW_META_CHANGE,function(e){void 0!==e.newValue&&t.setPrecision(e.newValue)}),this.maskerMeta.precision=this.dataModel.getMeta(this.field,"precision")||this.maskerMeta.precision,this.min=u.isNumber(this.dataModel.getMeta(this.field,"min"))?this.dataModel.getMeta(this.field,"min"):this.min,this.max=u.isNumber(this.dataModel.getMeta(this.field,"max"))?this.dataModel.getMeta(this.field,"max"):this.max,this.minLength=u.isNumber(this.dataModel.getMeta(this.field,"minLength"))?this.dataModel.getMeta(this.field,"minLength"):this.minLength,this.maxLength=u.isNumber(this.dataModel.getMeta(this.field,"maxLength"))?this.dataModel.getMeta(this.field,"maxLength"):this.maxLength,this.minNotEq=void 0!==u.isNumber(this.dataModel.getMeta(this.field,"minNotEq"))?this.dataModel.getMeta(this.field,"minNotEq"):this.minNotEq,this.maxNotEq=void 0!==u.isNumber(this.dataModel.getMeta(this.field,"maxNotEq"))?this.dataModel.getMeta(this.field,"maxNotEq"):this.maxNotEq),this.formater=new u.NumberFormater(this.maskerMeta.precision),this.masker=new u.NumberMasker(this.maskerMeta),this.create()},modelValueChange:function(e){(null===e||"undefined"==typeof e)&&(e=e||""),e=parseFloat(e);var t=this.dataModel.getRowMeta(this.field,"precision");this.maskerMeta.precision=void 0===t||null===t||""===t?this.maskerMeta.precision:t,this.formater.precision=this.maskerMeta.precision;var n=this.formater.format(e);this.trueValue=n,this.element.trueValue=this.trueValue,this.showValue=this.masker.format(n).value,this.setShowValue(this.showValue)},setValue:function(e){e=parseFloat(e),this.maskerMeta.precision=this.dataModel.getRowMeta(this.field,"precision")||this.maskerMeta.precision,this.formater.precision=this.maskerMeta.precision;var t=this.dataModel.getCurrentRow().getValue(this.field);e==t?(this.showValue=this.masker.format(this.trueValue).value,this.setShowValue(this.showValue)):(this.trueValue=this.formater.format(e),this.element.trueValue=this.trueValue,this.showValue=this.masker.format(this.trueValue).value,this.setShowValue(this.showValue),this.setModelValue(this.trueValue))},getValue:function(){return this.trueValue},getShowValue:function(){return this.showValue},setPrecision:function(e){if(this.maskerMeta.precision!=e){this.maskerMeta.precision=e,this.formater=new u.NumberFormater(this.maskerMeta.precision),this.masker=new u.NumberMasker(this.maskerMeta);var t=this.dataModel.getCurrentRow();if(t){var n=this.dataModel.getCurrentRow().getValue(this.field);this.showValue=this.masker.format(this.formater.format(n)).value}else this.showValue=this.masker.format(this.formater.format(this.trueValue)).value;this.setShowValue(this.showValue)}},onFocusin:function(e){var t=this.dataModel.getCurrentRow().getValue(this.field),n=t+"",i=t;if(u.isNumber(t)&&u.isNumber(this.maskerMeta.precision))if(n.indexOf(".")>=0){var r=n.substr(n.indexOf(".")+1);(r.length<this.maskerMeta.precision||0==parseInt(r.substr(this.maskerMeta.precision)))&&(i=this.formater.format(t))}else this.maskerMeta.precision>0&&(i=this.formater.format(t));i=parseFloat(i),this.setShowValue(i)},_needClean:function(){return!0},Statics:{compName:"float"}}),u.compMgr.addDataAdapter({adapter:u.FloatAdapter,name:"float"}),u.CurrencyAdapter=u.InputAdapter.extend({initialize:function(e){var t=this;u.CurrencyAdapter.superclass.initialize.apply(this,arguments),this.maskerMeta=iweb.Core.getMaskerMeta("currency")||{},this.maskerMeta.precision=e.precision||this.maskerMeta.precision,this.maskerMeta.curSymbol=e.curSymbol||this.maskerMeta.curSymbol,this.validType="float",this.max=e.max,this.min=e.min,this.maxNotEq=e.maxNotEq,this.minNotEq=e.minNotEq,this.maxLength=e.maxLength?e.maxLength:25,this.minLength=e.mixLength?e.mixLength:0,this.dataModel&&(this.dataModel.on(this.field+".precision."+u.DataTable.ON_CURRENT_META_CHANGE,function(e){t.setPrecision(e.newValue)}),this.maskerMeta.precision=this.dataModel.getMeta(this.field,"precision")||this.maskerMeta.precision,this.dataModel.on(this.field+".curSymbol."+u.DataTable.ON_CURRENT_META_CHANGE,function(e){t.setCurSymbol(e.newValue)}),this.maskerMeta.curSymbol=this.dataModel.getMeta(this.field,"curSymbol")||this.maskerMeta.curSymbol,this.min=void 0!==this.dataModel.getMeta(this.field,"min")?this.dataModel.getMeta(this.field,"min"):this.min,this.max=void 0!==this.dataModel.getMeta(this.field,"max")?this.dataModel.getMeta(this.field,"max"):this.max,this.minNotEq=void 0!==this.dataModel.getMeta(this.field,"minNotEq")?this.dataModel.getMeta(this.field,"minNotEq"):this.minNotEq,this.maxNotEq=void 0!==this.dataModel.getMeta(this.field,"maxNotEq")?this.dataModel.getMeta(this.field,"maxNotEq"):this.maxNotEq,this.minLength=u.isNumber(this.dataModel.getMeta(this.field,"minLength"))?this.dataModel.getMeta(this.field,"minLength"):this.minLength,this.maxLength=u.isNumber(this.dataModel.getMeta(this.field,"maxLength"))?this.dataModel.getMeta(this.field,"maxLength"):this.maxLength),this.formater=new u.NumberFormater(this.maskerMeta.precision),this.masker=new CurrencyMasker(this.maskerMeta),this.create()},modelValueChange:function(e){(null===e||"undefined"==typeof e)&&(e=e||""),this.maskerMeta.precision=this.dataModel.getRowMeta(this.field,"precision")||this.maskerMeta.precision,this.maskerMeta.curSymbol=this.dataModel.getRowMeta(this.field,"curSymbol")||this.maskerMeta.curSymbol,
this.formater.precision=this.maskerMeta.precision,this.masker.formatMeta.curSymbol=this.maskerMeta.curSymbol;var t=this.formater.format(e);this.trueValue=t,this.element.trueValue=this.trueValue,this.showValue=this.masker.format(t).value,this.setShowValue(this.showValue)},setValue:function(e){this.maskerMeta.precision=this.dataModel.getRowMeta(this.field,"precision")||this.maskerMeta.precision,this.formater.precision=this.maskerMeta.precision;var t=this.dataModel.getCurrentRow().getValue(this.field);e==t?(this.showValue=this.masker.format(this.trueValue).value,this.setShowValue(this.showValue)):(this.trueValue=this.formater.format(e),this.element.trueValue=this.trueValue,this.showValue=this.masker.format(this.trueValue).value,this.setShowValue(this.showValue),this.setModelValue(this.trueValue),this.trigger(CurrencyComp.EVENT_VALUE_CHANGE,this.trueValue))},getValue:function(){return this.trueValue},setShowValue:function(e){this.showValue=e,this.element.value=e},getShowValue:function(){return this.showValue},setPrecision:function(e){if(this.maskerMeta.precision!=e){this.maskerMeta.precision=e,this.formater=new u.NumberFormater(this.maskerMeta.precision),this.masker=new u.CurrencyMasker(this.maskerMeta);var t=this.dataModel.getCurrentRow();if(t){var n=this.dataModel.getCurrentRow().getValue(this.field);this.showValue=this.masker.format(this.formater.format(n)).value}else this.showValue=this.masker.format(this.formater.format(this.trueValue)).value;this.setShowValue(this.showValue)}},setCurSymbol:function(e){this.maskerMeta.curSymbol!=e&&(this.maskerMeta.curSymbol=e,this.masker.formatMeta.curSymbol=this.maskerMeta.curSymbol,this.element.trueValue=this.trueValue,this.showValue=this.masker.format(this.trueValue).value,this.setShowValue(this.showValue))},onFocusin:function(e){var t=this.getValue(),n=t+"",i=t;if(u.isNumber(t)&&u.isNumber(this.maskerMeta.precision))if(n.indexOf(".")>=0){var r=n.substr(n.indexOf(".")+1);(r.length<this.maskerMeta.precision||0==parseInt(r.substr(this.maskerMeta.precision)))&&(i=this.formater.format(t))}else this.maskerMeta.precision>0&&(i=this.formater.format(t));this.setShowValue(i)},Statics:{compName:"currency"}}),u.compMgr.addDataAdapter({adapter:u.StringAdapter,name:"currency"}),u.PercentAdapter=u.InputAdapter.extend({initialize:function(e){u.PercentAdapter.superclass.initialize.apply(this,arguments);this.validType="float",this.max=e.max,this.min=e.min,this.maxNotEq=e.maxNotEq,this.minNotEq=e.minNotEq,this.dataModel&&this.hasDataTable&&(this.min=void 0!==this.dataModel.getMeta(this.field,"min")?this.dataModel.getMeta(this.field,"min"):this.min,this.max=void 0!==this.dataModel.getMeta(this.field,"max")?this.dataModel.getMeta(this.field,"max"):this.max,this.minNotEq=void 0!==this.dataModel.getMeta(this.field,"minNotEq")?this.dataModel.getMeta(this.field,"minNotEq"):this.minNotEq,this.maxNotEq=void 0!==this.dataModel.getMeta(this.field,"maxNotEq")?this.dataModel.getMeta(this.field,"maxNotEq"):this.maxNotEq),this.masker=new PercentMasker,this.create()},modelValueChange:function(e){this.slice||(e=e||"",this.trueValue=e,this.showValue=this.masker.format(e).value,this.setShowValue(this.showValue))},setValue:function(e){this.trueValue=e,this.showValue=this.masker.format(e).value,this.setShowValue(this.showValue),this.slice=!0,this.setModelValue(this.trueValue),this.slice=!1},getValue:function(){return this.trueValue},setShowValue:function(e){this.showValue=e,this.element.value=e},getShowValue:function(){return this.showValue}}),u.compMgr.addDataAdapter({adapter:u.PercentAdapter,name:"percent"}),u.StringAdapter=u.InputAdapter.extend({initialize:function(e){u.StringAdapter.superclass.initialize.apply(this,arguments);var t=this;this.validType="string",this.maxLength=e.maxLength,this.minLength=e.minLength,this.dataModel&&this.hasDataTable&&(this.minLength=this.dataModel.getMeta(this.field,"minLength")||this.minLength,this.maxLength=this.dataModel.getMeta(this.field,"maxLength")||this.maxLength),this.create(),"INPUT"==this.element.nodeName&&(u.on(this.element,"focus",function(){t.setShowValue(t.getValue())}),u.on(this.element,"blur",function(){t.setValue(t.element.value)}))},modelValueChange:function(e){this.slice||(e=e||"",this.trueValue=e,this.showValue=e,this.setShowValue(this.showValue))},setValue:function(e){this.trueValue=e,this.showValue=e,this.setShowValue(this.showValue),this.slice=!0,this.setModelValue(this.trueValue),this.slice=!1},getValue:function(){return this.trueValue},getShowValue:function(){return this.showValue},Statics:{compName:"string"}}),u.compMgr.addDataAdapter({adapter:u.StringAdapter,name:"string"}),u.TextAreaAdapter=u.InputAdapter.extend({initialize:function(e){var t=this;u.TextAreaAdapter.superclass.initialize.apply(this,arguments),this.create(),"TEXTAREA"==this.element.nodeName&&(u.on(this.element,"focus",function(){t.setShowValue(t.getValue())}),u.on(this.element,"blur",function(){t.setValue(t.element.value)}))},modelValueChange:function(e){this.slice||(e=e||"",this.trueValue=e,this.showValue=e,this.setShowValue(this.showValue))},setValue:function(e){this.trueValue=e,this.showValue=e,this.setShowValue(this.showValue),this.slice=!0,this.setModelValue(this.trueValue),this.slice=!1,this.trigger(Textarea.EVENT_VALUE_CHANGE,this.trueValue)},getValue:function(){return this.trueValue},setShowValue:function(e){this.showValue=e,this.element.value=e,this.element.title=e},getShowValue:function(){return this.showValue}}),u.compMgr.addDataAdapter({adapter:u.TextAreaAdapter,name:"textarea"}),u.TextFieldAdapter=u.Class.create({initialize:function(e){this.element=e.el,this.options=e.options,this.viewModel=e.model;var t=this.options.dataType;this.comp=new u.Text(this.element),this.element["u.Text"]=this.comp,"float"===t?this.trueAdpt=new u.FloatAdapter(e):"string"===t?this.trueAdpt=new u.StringAdapter(e):"integer"===t&&(this.trueAdpt=new u.IntegerAdapter(e)),this.trueAdpt.comp=this.comp,this.trueAdpt.setShowValue=function(e){this.showValue=e,this.comp.change(e),this.element.title=e}}}),u.compMgr.addDataAdapter({adapter:u.TextFieldAdapter,name:"u-text"}),u.CheckboxAdapter=u.BaseAdapter.extend({initialize:function(e){var t=this;u.CheckboxAdapter.superclass.initialize.apply(this,arguments),this.comp=new u.Checkbox(this.element),this.element["u.Checkbox"]=this.comp,this.eleValue=this.comp._inputElement.value,this.comp.on("change",function(e){if(!t.slice){var n=t.dataModel.getValue(t.field),i=""==n?[]:n.split(",");if(t.comp._inputElement.checked)i.push(t.eleValue);else{var r=i.indexOf(t.eleValue);i.splice(r,1)}t.dataModel.setValue(t.field,i.join(","))}}),this.dataModel.ref(this.field).subscribe(function(e){t.modelValueChange(e)})},modelValueChange:function(e){this.slice||this.comp._inputElement.checked!=(e+",").indexOf(this.eleValue)>-1&&(this.slice=!0,this.comp._inputElement.click(),this.slice=!1)},setEnable:function(e){}}),u.compMgr.addDataAdapter({adapter:u.CheckboxAdapter,name:"u-checkbox"}),u.ComboboxAdapter=u.BaseAdapter.extend({initialize:function(e,t){var n=this;u.ComboboxAdapter.superclass.initialize.apply(this,arguments),this.datasource=u.getJSObject(this.viewModel,this.options.datasource),this.single=this.options.single,this.mutil=this.options.mutil,this.validType="combobox",this.comp=new u.Combo(this.element),this.element["u.Combo"]=this.comp,this.datasource&&this.comp.setComboData(this.datasource),this.mutil,this.comp.on("select",function(e){n.slice=!0,n.dataModel.setValue(n.field,e.value),n.slice=!1}),this.dataModel.ref(this.field).subscribe(function(e){n.modelValueChange(e)})},modelValueChange:function(e){this.slice||this.comp.setValue(e)},setEnable:function(e){}}),u.compMgr.addDataAdapter({adapter:u.ComboboxAdapter,name:"u-combobox"}),u.RadioAdapter=u.BaseAdapter.extend({initialize:function(e){var t=this;u.RadioAdapter.superclass.initialize.apply(this,arguments),this.comp=new u.Radio(this.element),this.element["u.Radio"]=this.comp,this.eleValue=this.comp._btnElement.value,this.comp.on("change",function(e){if(!t.slice){t.dataModel.getValue(t.field);t.comp._btnElement.checked&&t.dataModel.setValue(t.field,t.eleValue)}}),this.dataModel.ref(this.field).subscribe(function(e){t.modelValueChange(e)})},modelValueChange:function(e){this.slice||this.eleValue==e&&(this.slice=!0,this.comp._btnElement.click(),this.slice=!1)},setEnable:function(e){}}),u.compMgr.addDataAdapter({adapter:u.RadioAdapter,name:"u-radio"}),u.PaginationAdapter=u.BaseAdapter.extend({initialize:function(e,t){var n=this;u.ComboboxAdapter.superclass.initialize.apply(this,arguments),!this.dataModel.pageSize()&&this.options.pageSize&&this.dataModel.pageSize(this.options.pageSize),this.options.pageSize=this.dataModel.pageSize()||this.options.pageSize,this.comp.dataModel=this.dataModel,this.pageChange=u.getFunction(this.viewModel,this.options.pageChange),this.sizeChange=u.getFunction(this.viewModel,this.options.sizeChange),this.comp.on("pageChange",function(e,t){"function"==typeof n.pageChange?n.pageChange(t):n.defaultPageChange(t)}),this.comp.on("pageChange",function(e,t,i){"function"==typeof n.sizeChange?n.sizeChange(t,i):u.showMessageDialog("没有注册sizeChange事件")}),this.dataModel.totalPages.subscribe(function(e){n.comp.update({totalPages:e})}),this.dataModel.pageSize.subscribe(function(e){n.comp.update({pageSize:e})}),this.dataModel.pageIndex.subscribe(function(e){n.comp.update({currentPage:e+1})})},defaultPageChange:function(e){this.dataModel.hasPage(e)&&this.dataModel.setCurrentPage(e)},disableChangeSize:function(){this.comp.disableChangeSize()},enableChangeSize:function(){this.comp.enableChangeSize()}}),u.compMgr.addDataAdapter({adapter:u.PaginationAdapter,name:"pagination"}),u.DateTimeAdapter=u.BaseAdapter.extend({initialize:function(e,t){var n=this;u.DateTimeAdapter.superclass.initialize.apply(this,arguments),this.adapterType=t.type||this.dataModel.getMeta(this.field,"type")||"datetime",this.maskerMeta=u.core.getMaskerMeta(this.adapterType)||{},this.maskerMeta.format=this.options.format||this.maskerMeta.format,this.dataModel.on(this.field+".format."+u.DataTable.ON_CURRENT_META_CHANGE,function(e){n.setFormat(e.newValue)}),this.maskerMeta.format=this.dataModel.getMeta(this.field,"format")||this.maskerMeta.format,this.comp=new u.DateTimePicker({el:this.element,format:this.maskerMeta.format}),this.element["u.DateTimePicker"]=this.comp,this.comp.on("select",function(e){n.slice=!0,n.dataModel.setValue(n.field,u.date.format(e.value,"YYYY-MM-DD HH:mm:ss")),n.slice=!1}),this.dataModel.ref(this.field).subscribe(function(e){n.modelValueChange(e)})},modelValueChange:function(e){this.slice||this.comp.setDate(e)},setFormat:function(e){this.maskerMeta.format!=e&&(this.maskerMeta.format=e,this.comp.setFormat(e))}}),u.compMgr.addDataAdapter({adapter:u.DateTimeAdapter,name:"u-date"});